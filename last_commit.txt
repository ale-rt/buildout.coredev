Repository: plone.subrequest


Branch: refs/heads/master
Date: 2017-08-18T18:16:54+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.subrequest/commit/a049a4706a076f07da39138ef1fee30f8c0621f7

Revert "Update __init__.py (remove virtual-url-parts from path) (#13)"

This reverts commit 12abd545e9f165256c83bb048c4e705e288fe752.
It broke subrequest calls in virtual hosted environments.
See: https://github.com/plone/plone.subrequest/issues/14
And: https://github.com/plone/plone.subrequest/pull/13

Files changed:
M plone/subrequest/__init__.py

diff --git a/plone/subrequest/__init__.py b/plone/subrequest/__init__.py
index f95f067..1b46f8f 100644
--- a/plone/subrequest/__init__.py
+++ b/plone/subrequest/__init__.py
@@ -89,7 +89,6 @@ def subrequest(url, root=None, stdout=None, exception_handler=None):
             root_path = normpath(
                 parent_request['PATH_INFO']
             ).rstrip('/')[:-len(path_past_root) or None]
-            path = path.replace(vurl_parts[1], '', 1)
             if root is None:
                 path = root_path + path
             else:


