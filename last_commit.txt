Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2016-03-09T15:36:22-03:00
Author: hvelarde (hvelarde) <hector.velarde@gmail.com>
Commit: https://github.com/plone/plone.app.multilingual/commit/c6232a4cb8646f6221d5e17bfebc8a1d8ed803ea

Fixed compatibility issue with Archetypes

Files changed:
M CHANGES.rst
M src/plone/app/multilingual/browser/add.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 8891f8d..7d1c562 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,9 +14,13 @@ New:
 
 Fixes:
 
+- Fixed compatibility issue with archetypes contents: wrong URL were generated.
+  [keul, hvelarde]
+
 - Really don't show the Google Translate button when no API key set 
   [djowett]
 
+
 3.0.15 (2016-03-01)
 -------------------
 
diff --git a/src/plone/app/multilingual/browser/add.py b/src/plone/app/multilingual/browser/add.py
index 90d1b43..269c54f 100644
--- a/src/plone/app/multilingual/browser/add.py
+++ b/src/plone/app/multilingual/browser/add.py
@@ -71,7 +71,7 @@ def traverse(self, name, ignored):
         if not IDexterityContent.providedBy(source):
             # we are not on DX content, assume AT
             baseUrl = self.context.absolute_url()
-            url = '%s/@@add_at_translation?type=%s' % (baseUrl, name)
+            url = '%s/@@add_at_translation?type=%s' % (baseUrl, source.portal_type)
             return self.request.response.redirect(url)
 
         # set the self.context to the place where it should be stored


Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2016-03-11T10:13:12+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.multilingual/commit/ae7ea6702ad3c2f6dcc75ed320bcac1369fa0d53

Merge pull request #221 from plone/issue_169

Fixed compatibility issue with Archetypes

Files changed:
M CHANGES.rst
M src/plone/app/multilingual/browser/add.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 8891f8d..7d1c562 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,9 +14,13 @@ New:
 
 Fixes:
 
+- Fixed compatibility issue with archetypes contents: wrong URL were generated.
+  [keul, hvelarde]
+
 - Really don't show the Google Translate button when no API key set 
   [djowett]
 
+
 3.0.15 (2016-03-01)
 -------------------
 
diff --git a/src/plone/app/multilingual/browser/add.py b/src/plone/app/multilingual/browser/add.py
index 90d1b43..269c54f 100644
--- a/src/plone/app/multilingual/browser/add.py
+++ b/src/plone/app/multilingual/browser/add.py
@@ -71,7 +71,7 @@ def traverse(self, name, ignored):
         if not IDexterityContent.providedBy(source):
             # we are not on DX content, assume AT
             baseUrl = self.context.absolute_url()
-            url = '%s/@@add_at_translation?type=%s' % (baseUrl, name)
+            url = '%s/@@add_at_translation?type=%s' % (baseUrl, source.portal_type)
             return self.request.response.redirect(url)
 
         # set the self.context to the place where it should be stored


