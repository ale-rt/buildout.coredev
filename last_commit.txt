Repository: plone.app.blob


Branch: refs/heads/master
Date: 2017-02-21T22:14:58+01:00
Author: Gil Forcada (gforcada) <gforcada@gnome.org>
Commit: https://github.com/plone/plone.app.blob/commit/e85355ff7352643d4574412a826632d381f6de5c

Process indexing operations

Part of PLIP: https://github.com/plone/Products.CMFPlone/issues/1343

Files changed:
M CHANGES.rst
M src/plone/app/blob/tests/test_maintenance.py

diff --git a/CHANGES.rst b/CHANGES.rst
index ba237af..fd4a7a6 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,9 @@ Breaking changes:
 
 New features:
 
-- *add item here*
+- Adapt tests to the new indexing operations queueing.
+  Part of PLIP 1343: https://github.com/plone/Products.CMFPlone/issues/1343
+  [gforcada]
 
 Bug fixes:
 
diff --git a/src/plone/app/blob/tests/test_maintenance.py b/src/plone/app/blob/tests/test_maintenance.py
index a8c502d..6178de0 100644
--- a/src/plone/app/blob/tests/test_maintenance.py
+++ b/src/plone/app/blob/tests/test_maintenance.py
@@ -4,6 +4,12 @@
 from Products.ATContentTypes.interface import file as atfile
 from Products.ATContentTypes.interface import image as atimage
 
+try:
+    from Products.CMFCore.indexing import processQueue
+except ImportError:
+    def processQueue():
+        pass
+
 
 class MaintenanceViewTests(ReplacementTestCase):
 
@@ -38,6 +44,7 @@ def testUpdateTypeIndex(self):
         info = self.portal.portal_types.getTypeInfo('File')
         info.title = 'Foo'
         foo = self.folder[self.folder.invokeFactory('File', id='foo')]
+        processQueue()
         info.title = 'File'
         # make sure it's actually wrong...
         catalog = self.portal.portal_catalog


Repository: plone.app.blob


Branch: refs/heads/master
Date: 2017-02-21T22:15:55+01:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.app.blob/commit/efcbd7bfd69ab4072bd53c368945681492db2ef9

Merge pull request #27 from plone/merge-collective-indexing

Merge collective indexing

Files changed:
M CHANGES.rst
M src/plone/app/blob/tests/test_maintenance.py

diff --git a/CHANGES.rst b/CHANGES.rst
index ba237af..fd4a7a6 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,9 @@ Breaking changes:
 
 New features:
 
-- *add item here*
+- Adapt tests to the new indexing operations queueing.
+  Part of PLIP 1343: https://github.com/plone/Products.CMFPlone/issues/1343
+  [gforcada]
 
 Bug fixes:
 
diff --git a/src/plone/app/blob/tests/test_maintenance.py b/src/plone/app/blob/tests/test_maintenance.py
index a8c502d..6178de0 100644
--- a/src/plone/app/blob/tests/test_maintenance.py
+++ b/src/plone/app/blob/tests/test_maintenance.py
@@ -4,6 +4,12 @@
 from Products.ATContentTypes.interface import file as atfile
 from Products.ATContentTypes.interface import image as atimage
 
+try:
+    from Products.CMFCore.indexing import processQueue
+except ImportError:
+    def processQueue():
+        pass
+
 
 class MaintenanceViewTests(ReplacementTestCase):
 
@@ -38,6 +44,7 @@ def testUpdateTypeIndex(self):
         info = self.portal.portal_types.getTypeInfo('File')
         info.title = 'Foo'
         foo = self.folder[self.folder.invokeFactory('File', id='foo')]
+        processQueue()
         info.title = 'File'
         # make sure it's actually wrong...
         catalog = self.portal.portal_catalog


