Repository: plone.app.linkintegrity


Branch: refs/heads/master
Date: 2016-06-20T20:03:41+02:00
Author: Diederik Veeze (didrix) <d.veeze@zestsoftware.nl>
Commit: https://github.com/plone/plone.app.linkintegrity/commit/8ae118564babe3d90ff049ad14f4944e66fd4ce3

Use plone.namedfile for testing

Files changed:
M plone/app/linkintegrity/testing.py

diff --git a/plone/app/linkintegrity/testing.py b/plone/app/linkintegrity/testing.py
index 75506a8..18f04f5 100644
--- a/plone/app/linkintegrity/testing.py
+++ b/plone/app/linkintegrity/testing.py
@@ -15,6 +15,7 @@
 from plone.app.testing import login
 from plone.app.testing import ploneSite
 from plone.app.testing import setRoles
+from plone.namedfile.file import NamedImage
 from plone.testing import z2
 from zope.configuration import xmlconfig
 
@@ -73,7 +74,9 @@ def setUpContent(self):
                 create(portal, **type_data)
 
             create(portal, 'File', id='file1', title='File 1', file=GIF)
-            create(portal, 'Image', id='image1', title='Image 1', image=GIF)
+            portal.invokeFactory('Image', 'image1')
+            portal['image1'].image = NamedImage(
+                GIF, 'image/gif', u'sample.gif')
             create(portal, 'Folder', id='folder1', title='Folder 1')
             subfolder = portal['folder1']
             create(subfolder, 'Document', id='doc4', title='Test Page 4')


