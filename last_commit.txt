Repository: mockup


Branch: refs/heads/master
Date: 2016-03-17T09:25:08+01:00
Author: Eric BREHAULT (ebrehault) <ebrehault@gmail.com>
Commit: https://github.com/plone/mockup/commit/5527c9b2a4d5eee7629bed9099eeaa2b64a75e6a

Fix Build CSS button in thememapper with file system-based

Files changed:
M CHANGES.rst
M mockup/patterns/thememapper/pattern.js

diff --git a/CHANGES.rst b/CHANGES.rst
index 026e031..9ba96c6 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -58,6 +58,9 @@ Fixes:
   the data to aid in view rendering.
   [metatoaster]
 
+- Fix Build CSS button in thememapper with file system-based themes to display
+  the generated CSS in the editor.
+  [ebrehault]
 
 2.1.3 (2016-02-27)
 New:
diff --git a/mockup/patterns/thememapper/pattern.js b/mockup/patterns/thememapper/pattern.js
index 59e6ada..e7ea8f6 100644
--- a/mockup/patterns/thememapper/pattern.js
+++ b/mockup/patterns/thememapper/pattern.js
@@ -448,11 +448,19 @@ define([
           _authenticator: utils.getAuthenticator()
         },
         success: function(data) {
-          self.fileManager.refreshTree(function() {
-            //We need to make sure we open the newest version
-            delete self.fileManager.fileData['/' + self.lessPaths['save']]
-            self.fileManager.selectItem(self.lessPaths['save'])
-          });
+          if(data.success == 'tmp') {
+            self.fileManager.fileData['_generated_.css'] = {
+              contents: data.value,
+              ext: 'css'
+            }
+            self.fileManager.openEditor('_generated_.css');
+          } else {
+            self.fileManager.refreshTree(function() {
+              //We need to make sure we open the newest version
+              delete self.fileManager.fileData['/' + self.lessPaths['save']]
+              self.fileManager.selectItem(self.lessPaths['save'])
+            });
+          }
           self.lessbuilderView.end();
         }
       });


Repository: mockup


Branch: refs/heads/master
Date: 2016-03-17T07:51:50-05:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/mockup/commit/56e22b045adc2ffb13bfa4e96b9d3a619b716276

Merge pull request #648 from plone/fix-build-css-for-fs-themes

Fix Build CSS button in thememapper with file system-based

Files changed:
M CHANGES.rst
M mockup/patterns/thememapper/pattern.js

diff --git a/CHANGES.rst b/CHANGES.rst
index 026e031..9ba96c6 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -58,6 +58,9 @@ Fixes:
   the data to aid in view rendering.
   [metatoaster]
 
+- Fix Build CSS button in thememapper with file system-based themes to display
+  the generated CSS in the editor.
+  [ebrehault]
 
 2.1.3 (2016-02-27)
 New:
diff --git a/mockup/patterns/thememapper/pattern.js b/mockup/patterns/thememapper/pattern.js
index 59e6ada..e7ea8f6 100644
--- a/mockup/patterns/thememapper/pattern.js
+++ b/mockup/patterns/thememapper/pattern.js
@@ -448,11 +448,19 @@ define([
           _authenticator: utils.getAuthenticator()
         },
         success: function(data) {
-          self.fileManager.refreshTree(function() {
-            //We need to make sure we open the newest version
-            delete self.fileManager.fileData['/' + self.lessPaths['save']]
-            self.fileManager.selectItem(self.lessPaths['save'])
-          });
+          if(data.success == 'tmp') {
+            self.fileManager.fileData['_generated_.css'] = {
+              contents: data.value,
+              ext: 'css'
+            }
+            self.fileManager.openEditor('_generated_.css');
+          } else {
+            self.fileManager.refreshTree(function() {
+              //We need to make sure we open the newest version
+              delete self.fileManager.fileData['/' + self.lessPaths['save']]
+              self.fileManager.selectItem(self.lessPaths['save'])
+            });
+          }
           self.lessbuilderView.end();
         }
       });


