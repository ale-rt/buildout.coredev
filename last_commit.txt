Repository: plone.app.blob


Branch: refs/heads/master
Date: 2017-10-28T09:45:07+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.blob/commit/600e0060852efd0ceacb46b330b5be8c9ebac9df

Adapt test to added charset in Zope4 (ZPublisher.HTTPResponse.setHeader)

Files changed:
M CHANGES.rst
M src/plone/app/blob/tests/test_replacements.py

diff --git a/CHANGES.rst b/CHANGES.rst
index f05a113..b3ad77e 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Adapt test to changes in ZPublisher.HTTPResponse.setHeader
+  [pbauer]
 
 
 1.7.2 (2017-06-03)
diff --git a/src/plone/app/blob/tests/test_replacements.py b/src/plone/app/blob/tests/test_replacements.py
index 304bbe8..912668a 100644
--- a/src/plone/app/blob/tests/test_replacements.py
+++ b/src/plone/app/blob/tests/test_replacements.py
@@ -57,11 +57,12 @@ def testCreateFileBlob(self):
         self.assertEqual(foo.get_size(), 10)
         request = foo.REQUEST
         response = request.RESPONSE
-        self.assertEqual(foo.index_html(
-            request, response).next(), 'plain text')
+        index = foo.index_html(request, response)
+        self.assertEqual(index.next(), 'plain text')
         self.assertEqual(response.getStatus(), 200)
         self.assertEqual(response.headers['content-length'], '10')
-        self.assertEqual(response.headers['content-type'], 'text/plain')
+        self.assertTrue(
+            response.headers['content-type'].startswith('text/plain'))
 
     def testFileBlobInterfaces(self):
         foo = self.folder[self.folder.invokeFactory('File', 'foo')]


Repository: plone.app.blob


Branch: refs/heads/master
Date: 2017-10-28T10:37:51+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.blob/commit/ad6de84c071a450844815524047242ed76fc0a20

Merge pull request #44 from plone/fix_header

Adapt test to added charset in Zope4 (ZPublisher.HTTPResponse.setHeader)

Files changed:
M CHANGES.rst
M src/plone/app/blob/tests/test_replacements.py

diff --git a/CHANGES.rst b/CHANGES.rst
index f05a113..b3ad77e 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Adapt test to changes in ZPublisher.HTTPResponse.setHeader
+  [pbauer]
 
 
 1.7.2 (2017-06-03)
diff --git a/src/plone/app/blob/tests/test_replacements.py b/src/plone/app/blob/tests/test_replacements.py
index 304bbe8..912668a 100644
--- a/src/plone/app/blob/tests/test_replacements.py
+++ b/src/plone/app/blob/tests/test_replacements.py
@@ -57,11 +57,12 @@ def testCreateFileBlob(self):
         self.assertEqual(foo.get_size(), 10)
         request = foo.REQUEST
         response = request.RESPONSE
-        self.assertEqual(foo.index_html(
-            request, response).next(), 'plain text')
+        index = foo.index_html(request, response)
+        self.assertEqual(index.next(), 'plain text')
         self.assertEqual(response.getStatus(), 200)
         self.assertEqual(response.headers['content-length'], '10')
-        self.assertEqual(response.headers['content-type'], 'text/plain')
+        self.assertTrue(
+            response.headers['content-type'].startswith('text/plain'))
 
     def testFileBlobInterfaces(self):
         foo = self.folder[self.folder.invokeFactory('File', 'foo')]


