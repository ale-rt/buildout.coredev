Repository: plone.app.blob


Branch: refs/heads/master
Date: 2017-11-05T18:52:02-05:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/plone.app.blob/commit/277cec79f209db6e9ecaadeb01d7ddab3cca7b02

don't set icons which don't exist

Files changed:
M CHANGES.rst
M src/plone/app/blob/profiles/file-replacement/types/ATFile.xml
M src/plone/app/blob/profiles/lingua/types/BlobelFish.xml
M src/plone/app/blob/profiles/sample/types/Blob.xml
M src/plone/app/blob/tests/test_integration.py

diff --git a/CHANGES.rst b/CHANGES.rst
index b3ad77e..39ae5fd 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -17,6 +17,9 @@ Bug fixes:
 - Adapt test to changes in ZPublisher.HTTPResponse.setHeader
   [pbauer]
 
+- Remove no longer existing icons from type definitions.
+  [davisagli]
+
 
 1.7.2 (2017-06-03)
 ------------------
diff --git a/src/plone/app/blob/profiles/file-replacement/types/ATFile.xml b/src/plone/app/blob/profiles/file-replacement/types/ATFile.xml
index 4f4c45c..a9b240d 100644
--- a/src/plone/app/blob/profiles/file-replacement/types/ATFile.xml
+++ b/src/plone/app/blob/profiles/file-replacement/types/ATFile.xml
@@ -5,7 +5,7 @@
  <property name="title" i18n:translate="">File (w/o blobs)</property>
  <property name="description"
       i18n:translate="">An old-style file not based on ZODB blobs.</property>
- <property name="content_icon">file_icon.gif</property>
+ <property name="icon_expr"></property>
  <property name="content_meta_type">ATFile</property>
  <property name="product">ATContentTypes</property>
  <property name="factory">addATFile</property>
diff --git a/src/plone/app/blob/profiles/lingua/types/BlobelFish.xml b/src/plone/app/blob/profiles/lingua/types/BlobelFish.xml
index 3948186..eaed427 100644
--- a/src/plone/app/blob/profiles/lingua/types/BlobelFish.xml
+++ b/src/plone/app/blob/profiles/lingua/types/BlobelFish.xml
@@ -3,7 +3,7 @@
    xmlns:i18n="http://xml.zope.org/namespaces/i18n">
  <property name="title">Blobel Fish</property>
  <property name="description">A multilingual fish</property>
- <property name="content_icon">file_icon.gif</property>
+ <property name="icon_expr"></property>
  <property name="content_meta_type">BlobelFish</property>
  <property name="product">plone.app.blob</property>
  <property name="factory">addBlobelFish</property>
diff --git a/src/plone/app/blob/profiles/sample/types/Blob.xml b/src/plone/app/blob/profiles/sample/types/Blob.xml
index 9d3c498..5845f4c 100644
--- a/src/plone/app/blob/profiles/sample/types/Blob.xml
+++ b/src/plone/app/blob/profiles/sample/types/Blob.xml
@@ -5,7 +5,7 @@
  <property name="title" i18n:translate="">Blob</property>
  <property name="description"
       i18n:translate="">An binary blob of data, much like a file.</property>
- <property name="content_icon">file_icon.gif</property>
+ <property name="icon_expr"></property>
  <property name="content_meta_type">ATBlob</property>
  <property name="product">plone.app.blob</property>
  <property name="factory">addATBlob</property>
diff --git a/src/plone/app/blob/tests/test_integration.py b/src/plone/app/blob/tests/test_integration.py
index 2dca3dd..70342a5 100644
--- a/src/plone/app/blob/tests/test_integration.py
+++ b/src/plone/app/blob/tests/test_integration.py
@@ -180,7 +180,7 @@ def testIcon(self):
     def testIconLookupForUnknownMimeType(self):
         """ test for http://plone.org/products/plone.app.blob/issues/1 """
         self.folder.blob.getFile().setContentType('application/foo')
-        self.assertTrue(self.folder.blob.getIcon().endswith('file_icon.gif'))
+        self.assertFalse(self.folder.blob.getIcon())
 
     def testVersioning(self):
         blob = self.folder.blob


