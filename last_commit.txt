Repository: diazo


Branch: refs/heads/master
Date: 2017-02-11T13:07:20-08:00
Author: David Glick (davisagli) <david@glicksoftware.com>
Commit: https://github.com/plone/diazo/commit/e28ae64e80bb5e60fafd0a79adf63c7019ed4c7b

fix test with webob 1.7, which doesn't keep the Content-Type on responses with no body

Files changed:
M CHANGES.rst
M lib/diazo/tests/test_wsgi.py

diff --git a/CHANGES.rst b/CHANGES.rst
index dd6f3c5..88b1e94 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Fix test with webob 1.7
+  [davisagli]
 
 
 1.2.4 (2016-11-17)
diff --git a/lib/diazo/tests/test_wsgi.py b/lib/diazo/tests/test_wsgi.py
index 18b622a..83dd773 100644
--- a/lib/diazo/tests/test_wsgi.py
+++ b/lib/diazo/tests/test_wsgi.py
@@ -14,6 +14,7 @@ def testfile(filename):
     return '/'.join(('file://',) + os.path.split(os.path.abspath(
         os.path.dirname(__file__))) + ('test_wsgi_files', filename,))
 
+
 HTML = b"""\
 <html>
     <body>
@@ -221,8 +222,6 @@ def application(environ, start_response):
         response = request.get_response(app)
 
         # Response headers for HEAD request must be updated.
-        self.assertEqual(response.headers['Content-Type'],
-                         'text/html; charset=UTF-8')
         self.assertEqual(response.headers.get('Content-Length'), None)
         self.assertFalse(response.body)
 


Repository: diazo


Branch: refs/heads/master
Date: 2017-02-11T13:15:40-08:00
Author: David Glick (davisagli) <david.glick@plone.org>
Commit: https://github.com/plone/diazo/commit/7b9bd02fae40a6baedfcd6eddb986453902fab8b

Merge pull request #68 from plone/davisagli-fix

fix test with webob 1.7, which doesn't keep the Content-Type on responses with no body

Files changed:
M CHANGES.rst
M lib/diazo/tests/test_wsgi.py

diff --git a/CHANGES.rst b/CHANGES.rst
index dd6f3c5..88b1e94 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Fix test with webob 1.7
+  [davisagli]
 
 
 1.2.4 (2016-11-17)
diff --git a/lib/diazo/tests/test_wsgi.py b/lib/diazo/tests/test_wsgi.py
index 18b622a..83dd773 100644
--- a/lib/diazo/tests/test_wsgi.py
+++ b/lib/diazo/tests/test_wsgi.py
@@ -14,6 +14,7 @@ def testfile(filename):
     return '/'.join(('file://',) + os.path.split(os.path.abspath(
         os.path.dirname(__file__))) + ('test_wsgi_files', filename,))
 
+
 HTML = b"""\
 <html>
     <body>
@@ -221,8 +222,6 @@ def application(environ, start_response):
         response = request.get_response(app)
 
         # Response headers for HEAD request must be updated.
-        self.assertEqual(response.headers['Content-Type'],
-                         'text/html; charset=UTF-8')
         self.assertEqual(response.headers.get('Content-Length'), None)
         self.assertFalse(response.body)
 


