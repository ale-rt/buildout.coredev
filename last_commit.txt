Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2016-11-02T11:00:51+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.multilingual/commit/9c31718a900aeee260e2b1a1f233a4591da120ce

Made robot tests more robust, I hope.

Before using 'Wait until element is visible',
first call   'Wait until page contains element'.

The first one only works reliably when the element was already on the page initially.
If the element was created dynamically, you need to use the 'page contains' call first,
otherwise you sometimes get an error:

'Element not found in the cache - perhaps the page has changed since it was looked up.'

Files changed:
M CHANGES.rst
M src/plone/app/multilingual/tests/robot/test_add_translation.robot

diff --git a/CHANGES.rst b/CHANGES.rst
index 53d90d3..4221762 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -22,7 +22,14 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Made robot tests more robust, I hope.
+  Before using 'Wait until element is visible',
+  first call   'Wait until page contains element'.
+  The first one only works reliably when the element was already on the page initially.
+  If the element was created dynamically, you need to use the 'page contains' call first,
+  otherwise you sometimes get an error:
+  'Element not found in the cache - perhaps the page has changed since it was looked up.'
+  [maurits]
 
 
 4.0.4 (2016-09-16)
diff --git a/src/plone/app/multilingual/tests/robot/test_add_translation.robot b/src/plone/app/multilingual/tests/robot/test_add_translation.robot
index 08401c5..74deed7 100644
--- a/src/plone/app/multilingual/tests/robot/test_add_translation.robot
+++ b/src/plone/app/multilingual/tests/robot/test_add_translation.robot
@@ -49,6 +49,7 @@ I view the Catalan document
 
 I link the document in English as a translation
   Click Element  css=#plone-contentmenu-multilingual a
+  Wait until page contains element  css=#_modify_translations
   Wait until element is visible  css=#_modify_translations
 
   Click Element  css=#_modify_translations
@@ -57,8 +58,10 @@ I link the document in English as a translation
   ...  css=#translations-overview .connectTranslationAction
 
   Click Element  css=#translations-overview .connectTranslationAction
+  Wait until page contains element  css=.select2-choices
   Wait until element is visible  css=.select2-choices
   Click Element  css=#formfield-form-widgets-content .select2-choices
+  Wait until page contains element  xpath=(//span[contains(., 'An English Document')])
   Wait until element is visible  xpath=(//span[contains(., 'An English Document')])
   Click Element  xpath=(//span[contains(., 'An English Document')])
   Wait until page contains  An English Document


Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2016-11-02T13:16:38+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.multilingual/commit/085b11b3907e4f72a83d645d855c62ba2fec21bb

Sleep 5 seconds

Files changed:
M src/plone/app/multilingual/tests/robot/test_add_translation.robot

diff --git a/src/plone/app/multilingual/tests/robot/test_add_translation.robot b/src/plone/app/multilingual/tests/robot/test_add_translation.robot
index 74deed7..d2b7d49 100644
--- a/src/plone/app/multilingual/tests/robot/test_add_translation.robot
+++ b/src/plone/app/multilingual/tests/robot/test_add_translation.robot
@@ -68,6 +68,7 @@ I link the document in English as a translation
 
   Click Element  xpath=(//*[contains(@class, 'plone-modal-footer')]//input[@id='form-buttons-connect_translation'])
   Wait until page contains element  xpath=(//h3[@class="translationTitle"])
+  Sleep  5
   Wait until element is visible  xpath=(//h3[@class="translationTitle"])
   Focus  xpath=(//*[@class="odd"]//a[contains(@href,"a-catalan-document")])
   Click Element  xpath=(//*[@class="odd"]//a[contains(@href,"a-catalan-document")])


Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2016-11-02T18:18:02+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.multilingual/commit/92cc652a42d050662faa51b1a64046d72ae1268b

Merge pull request #250 from plone/more-robust-robot-tests

Made robot tests more robust, I hope.

Files changed:
M CHANGES.rst
M src/plone/app/multilingual/tests/robot/test_add_translation.robot

diff --git a/CHANGES.rst b/CHANGES.rst
index 53d90d3..4221762 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -22,7 +22,14 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Made robot tests more robust, I hope.
+  Before using 'Wait until element is visible',
+  first call   'Wait until page contains element'.
+  The first one only works reliably when the element was already on the page initially.
+  If the element was created dynamically, you need to use the 'page contains' call first,
+  otherwise you sometimes get an error:
+  'Element not found in the cache - perhaps the page has changed since it was looked up.'
+  [maurits]
 
 
 4.0.4 (2016-09-16)
diff --git a/src/plone/app/multilingual/tests/robot/test_add_translation.robot b/src/plone/app/multilingual/tests/robot/test_add_translation.robot
index 08401c5..d2b7d49 100644
--- a/src/plone/app/multilingual/tests/robot/test_add_translation.robot
+++ b/src/plone/app/multilingual/tests/robot/test_add_translation.robot
@@ -49,6 +49,7 @@ I view the Catalan document
 
 I link the document in English as a translation
   Click Element  css=#plone-contentmenu-multilingual a
+  Wait until page contains element  css=#_modify_translations
   Wait until element is visible  css=#_modify_translations
 
   Click Element  css=#_modify_translations
@@ -57,14 +58,17 @@ I link the document in English as a translation
   ...  css=#translations-overview .connectTranslationAction
 
   Click Element  css=#translations-overview .connectTranslationAction
+  Wait until page contains element  css=.select2-choices
   Wait until element is visible  css=.select2-choices
   Click Element  css=#formfield-form-widgets-content .select2-choices
+  Wait until page contains element  xpath=(//span[contains(., 'An English Document')])
   Wait until element is visible  xpath=(//span[contains(., 'An English Document')])
   Click Element  xpath=(//span[contains(., 'An English Document')])
   Wait until page contains  An English Document
 
   Click Element  xpath=(//*[contains(@class, 'plone-modal-footer')]//input[@id='form-buttons-connect_translation'])
   Wait until page contains element  xpath=(//h3[@class="translationTitle"])
+  Sleep  5
   Wait until element is visible  xpath=(//h3[@class="translationTitle"])
   Focus  xpath=(//*[@class="odd"]//a[contains(@href,"a-catalan-document")])
   Click Element  xpath=(//*[@class="odd"]//a[contains(@href,"a-catalan-document")])


