Repository: Products.LinguaPlone


Branch: refs/heads/master
Date: 2016-02-17T13:17:39+01:00
Author: Godefroid Chapelle (gotcha) <gotcha@bubblenet.be>
Commit: https://github.com/plone/Products.LinguaPlone/commit/459a2fc398146702057207c53b9a489724bb813e

fix tests

Files changed:
M Products/LinguaPlone/tests/language_policies.txt
M Products/LinguaPlone/tests/test_defaultpage.py

diff --git a/Products/LinguaPlone/tests/language_policies.txt b/Products/LinguaPlone/tests/language_policies.txt
index 7f7aaac..863ab9a 100644
--- a/Products/LinguaPlone/tests/language_policies.txt
+++ b/Products/LinguaPlone/tests/language_policies.txt
@@ -50,6 +50,10 @@ Now, time to create our english content object:
   >>> english.setBody('__ENGLISH_CONTENT__')
   >>> en_path = '/'.join(english.getPhysicalPath())
 
+  >>> self.setRoles(['Reviewer'])
+  >>> wf_tool = portal.portal_workflow
+  >>> wf_tool.doActionFor(english, 'publish', comment='publish it!')
+
   Content is created with the current language
   >>> english.Language()
   'en'
@@ -59,6 +63,7 @@ And add a german translation:
   >>> _ = english.addTranslation('de')
   >>> german = english.getTranslation('de')
   >>> german.setBody('__GERMAN_CONTENT__')
+  >>> wf_tool.doActionFor(german, 'publish', comment='publish it!')
   >>> de_path = '/'.join(german.getPhysicalPath())
   >>> german.Language()
   'de'
diff --git a/Products/LinguaPlone/tests/test_defaultpage.py b/Products/LinguaPlone/tests/test_defaultpage.py
index 83f6baa..bf8f0f5 100644
--- a/Products/LinguaPlone/tests/test_defaultpage.py
+++ b/Products/LinguaPlone/tests/test_defaultpage.py
@@ -195,22 +195,3 @@ def testTranslatingDefaultPageInNeutralFolderDoesntCreateFolder(self):
         self.assertTrue(german_doc.getId() in neutral_folder)
         self.assertTrue(isDefaultPage(neutral_folder, english_doc))
         self.assertFalse(isDefaultPage(neutral_folder, german_doc))
-
-
-class TestAcquiredDefaultPage(LinguaPloneTestCase):
-
-    def afterSetUp(self):
-        directlyProvides(self.portal.REQUEST, ILinguaPloneProductLayer)
-        self.addLanguage('de')
-        self.setLanguage('en')
-        self.english = makeContent(self.folder, 'SimpleType', 'news')
-        self.english.setLanguage('en')
-        self.german = makeTranslation(self.english, 'de')
-
-    def testDeletedDefaultPage(self):
-        # after deleting a default page with a name that can be acquired
-        # (e.g. `news` or `index_html`) that page should be returned...
-        self.folder.setDefaultPage(self.english.getId())
-        del self.folder[self.english.getId()]
-        result = self.folder.getDefaultPage()
-        self.failUnlessEqual(result, self.english.getId())


