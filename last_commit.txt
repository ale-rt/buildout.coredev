Repository: plone.protect


Branch: refs/heads/master
Date: 2016-10-23T14:01:06-04:00
Author: tschorr (tschorr) <t_schorr@gmx.de>
Commit: https://github.com/plone/plone.protect/commit/5a08dbebedf447bab28573890c90db9bfad85d43

use self.request instead of z.globalrequest

Files changed:
M plone/protect/auto.py

diff --git a/plone/protect/auto.py b/plone/protect/auto.py
index 0b91855..7455153 100644
--- a/plone/protect/auto.py
+++ b/plone/protect/auto.py
@@ -33,7 +33,6 @@
 from zope.component import adapts
 from zope.component import getUtility
 from zope.interface import implementer, Interface
-from zope.globalrequest import getRequest
 
 try:
     from zope.component.hooks import getSite
@@ -86,7 +85,8 @@ def __init__(self, published, request):
 
     def parseTree(self, result, encoding):
         # if it's a redirect, the result shall not be transformed
-        request = getRequest()
+        request = self.request
+
         if request.response.status in (301, 302):
             return None
 


Repository: plone.protect


Branch: refs/heads/master
Date: 2016-10-23T14:06:17-04:00
Author: tschorr (tschorr) <t_schorr@gmx.de>
Commit: https://github.com/plone/plone.protect/commit/2ad6b5fb9dc48fd05f3973580c76e0a792d588b1

update changelog

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 2427e69..d34b748 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,9 @@ New features:
 
 Bug fixes:
 
+- avoid zope.globalrequest.getRequest()
+  [tschorr]
+
 - *add item here*
 
 


Repository: plone.protect


Branch: refs/heads/master
Date: 2016-10-23T18:19:05-04:00
Author: Nathan Van Gheem (vangheem) <vangheem@gmail.com>
Commit: https://github.com/plone/plone.protect/commit/629b75c956a3fa19ad326305b3c069504b3e0b25

Merge pull request #56 from plone/self_request_pr

use self.request instead of z.globalrequest

Files changed:
M CHANGES.rst
M plone/protect/auto.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 2427e69..d34b748 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,9 @@ New features:
 
 Bug fixes:
 
+- avoid zope.globalrequest.getRequest()
+  [tschorr]
+
 - *add item here*
 
 
diff --git a/plone/protect/auto.py b/plone/protect/auto.py
index 0b91855..7455153 100644
--- a/plone/protect/auto.py
+++ b/plone/protect/auto.py
@@ -33,7 +33,6 @@
 from zope.component import adapts
 from zope.component import getUtility
 from zope.interface import implementer, Interface
-from zope.globalrequest import getRequest
 
 try:
     from zope.component.hooks import getSite
@@ -86,7 +85,8 @@ def __init__(self, published, request):
 
     def parseTree(self, result, encoding):
         # if it's a redirect, the result shall not be transformed
-        request = getRequest()
+        request = self.request
+
         if request.response.status in (301, 302):
             return None
 


