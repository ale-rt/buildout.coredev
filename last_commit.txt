Repository: plone.app.jquerytools


Branch: refs/heads/master
Date: 2017-01-30T09:51:54+01:00
Author: Marc Sommerhalder (msom) <marc.sommerhalder@seantis.ch>
Commit: https://github.com/plone/plone.app.jquerytools/commit/d1327d331cc0cb6bc0aad4fedd3a3033ca3d17e7

Use latest versions of jquery.form and jquery.tools

Files changed:
M CHANGES.rst
M plone/app/jquerytools/browser/jquery.form.js
M plone/app/jquerytools/browser/jquery.form.min.js
M plone/app/jquerytools/browser/jquery.tools.dateinput.js
M plone/app/jquerytools/browser/jquery.tools.dateinput.min.js
M plone/app/jquerytools/browser/jquery.tools.min.js
M plone/app/jquerytools/browser/jquery.tools.plugins.min.js
M plone/app/jquerytools/browser/jquery.tools.rangeinput.min.js
M plone/app/jquerytools/browser/jquery.tools.tooltip.min.js
M plone/app/jquerytools/browser/jquery.tools.tooltip.plugins.min.js
M plone/app/jquerytools/browser/jquery.tools.validator.min.js

diff --git a/CHANGES.rst b/CHANGES.rst
index 8c8c1ad..715b094 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,17 +4,13 @@ Changelog
 1.9.1 (unreleased)
 ------------------
 
-Breaking changes:
-
-- *add item here*
-
-New features:
-
-- *add item here*
-
 Bug fixes:
 
-- *add item here*
+- Fix for dotted path form ids.
+  [malsup]
+
+- Fix initaliziation of minimum and maximum dates in dateinput.
+  [msom]
 
 
 1.9.0 (2016-12-02)
@@ -27,7 +23,6 @@ New features:
   [petri]
 
 
-
 1.8.0 (2016-08-12)
 ------------------
 
diff --git a/plone/app/jquerytools/browser/jquery.form.js b/plone/app/jquerytools/browser/jquery.form.js
index 0a606c0..591ad6f 100644
--- a/plone/app/jquerytools/browser/jquery.form.js
+++ b/plone/app/jquerytools/browser/jquery.form.js
@@ -10,6 +10,21 @@
  */
 /*global ActiveXObject */
 
+// AMD support
+(function (factory) {
+    "use strict";
+    if (typeof define === 'function' && define.amd) {
+        // using AMD; register as anon module
+        define(['jquery'], factory);
+    } else {
+        // no AMD; invoke directly
+        factory( (typeof(jQuery) != 'undefined') ? jQuery : window.Zepto );
+    }
+}
+
+(function($) {
+"use strict";
+
 /*
     Usage Note:
     -----------
@@ -47,8 +62,6 @@
     at the appropriate time.
 */
 
-(function($) {
-
 /**
  * Feature detection
  */
@@ -1261,4 +1274,4 @@ function log() {
     }
 }
 
-}(jQuery));
+}));
diff --git a/plone/app/jquerytools/browser/jquery.form.min.js b/plone/app/jquerytools/browser/jquery.form.min.js
index c2e9cae..0b2bab8 100644
--- a/plone/app/jquerytools/browser/jquery.form.min.js
+++ b/plone/app/jquerytools/browser/jquery.form.min.js
@@ -1 +1 @@
-!function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):factory("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function($){"use strict";function doAjaxSubmit(e){var options=e.data;e.isDefaultPrevented()||(e.preventDefault(),$(e.target).ajaxSubmit(options))}function captureSubmittingElement(e){var target=e.target,$el=$(target);if(!$el.is("[type=submit],[type=image]")){var t=$el.closest("[type=submit]");if(0===t.length)return;target=t[0]}var form=this;if(form.clk=target,"image"==target.type)if(void 0!==e.offsetX)form.clk_x=e.offsetX,form.clk_y=e.offsetY;else if("function"==typeof $.fn.offset){var offset=$el.offset();form.clk_x=e.pageX-offset.left,form.clk_y=e.pageY-offset.top}else form.clk_x=e.pageX-target.offsetLeft,form.clk_y=e.pageY-target.offsetTop;setTimeout(function(){form.clk=form.clk_x=form.clk_y=null},100)}function log(){if($.fn.ajaxSubmit.debug){var msg="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(msg):window.opera&&window.opera.postError&&window.opera.postError(msg)}}var feature={};feature.fileapi=void 0!==$("<input type='file'/>").get(0).files,feature.formdata=void 0!==window.FormData;var hasProp=!!$.fn.prop;$.fn.attr2=function(){if(!hasProp)return this.attr.apply(this,arguments);var val=this.prop.apply(this,arguments);return val&&val.jquery||"string"==typeof val?val:this.attr.apply(this,arguments)},$.fn.ajaxSubmit=function(options){function deepSerialize(extraData){var i,part,serialized=$.param(extraData,options.traditional).split("&"),len=serialized.length,result=[];for(i=0;len>i;i++)serialized[i]=serialized[i].replace(/\+/g," "),part=serialized[i].split("="),result.push([decodeURIComponent(part[0]),decodeURIComponent(part[1])]);return result}function fileUploadXhr(a){for(var formdata=new FormData,i=0;i<a.length;i++)formdata.append(a[i].name,a[i].value);if(options.extraData){var serializedData=deepSerialize(options.extraData);for(i=0;i<serializedData.length;i++)serializedData[i]&&formdata.append(serializedData[i][0],serializedData[i][1])}options.data=null;var s=$.extend(!0,{},$.ajaxSettings,options,{contentType:!1,processData:!1,cache:!1,type:method||"POST"});options.uploadProgress&&(s.xhr=function(){var xhr=$.ajaxSettings.xhr();return xhr.upload&&xhr.upload.addEventListener("progress",function(event){var percent=0,position=event.loaded||event.position,total=event.total;event.lengthComputable&&(percent=Math.ceil(position/total*100)),options.uploadProgress(event,position,total,percent)},!1),xhr}),s.data=null;var beforeSend=s.beforeSend;return s.beforeSend=function(xhr,o){o.data=options.formData?options.formData:formdata,beforeSend&&beforeSend.call(this,xhr,o)},$.ajax(s)}function fileUploadIframe(a){function getDoc(frame){var doc=null;try{frame.contentWindow&&(doc=frame.contentWindow.document)}catch(err){log("cannot get iframe.contentWindow document: "+err)}if(doc)return doc;try{doc=frame.contentDocument?frame.contentDocument:frame.document}catch(err){log("cannot get iframe.contentDocument: "+err),doc=frame.document}return doc}function doSubmit(){function checkState(){try{var state=getDoc(io).readyState;log("state = "+state),state&&"uninitialized"==state.toLowerCase()&&setTimeout(checkState,50)}catch(e){log("Server abort: ",e," (",e.name,")"),cb(SERVER_ABORT),timeoutHandle&&clearTimeout(timeoutHandle),timeoutHandle=void 0}}var t=$form.attr2("target"),a=$form.attr2("action"),mp="multipart/form-data",et=$form.attr("enctype")||$form.attr("encoding")||mp;form.setAttribute("target",id),(!method||/post/i.test(method))&&form.setAttribute("method","POST"),a!=s.url&&form.setAttribute("action",s.url),s.skipEncodingOverride||method&&!/post/i.test(method)||$form.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),s.timeout&&(timeoutHandle=setTimeout(function(){timedOut=!0,cb(CLIENT_TIMEOUT_ABORT)},s.timeout));var extraInputs=[];try{if(s.extraData)for(var n in s.extraData)s.extraData.hasOwnProperty(n)&&extraInputs.push($.isPlainObject(s.extraData[n])&&s.extraData[n].hasOwnProperty("name")&&s.extraData[n].hasOwnProperty("value")?$('<input type="hidden" name="'+s.extraData[n].name+'">').val(s.extraData[n].value).appendTo(form)[0]:$('<input type="hidden" name="'+n+'">').val(s.extraData[n]).appendTo(form)[0]);s.iframeTarget||$io.appendTo("body"),io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,!1),setTimeout(checkState,15);try{form.submit()}catch(err){var submitFn=document.createElement("form").submit;submitFn.apply(form)}}finally{form.setAttribute("action",a),form.setAttribute("enctype",et),t?form.setAttribute("target",t):$form.removeAttr("target"),$(extraInputs).remove()}}function cb(e){if(!xhr.aborted&&!callbackProcessed){if(doc=getDoc(io),doc||(log("cannot access response document"),e=SERVER_ABORT),e===CLIENT_TIMEOUT_ABORT&&xhr)return xhr.abort("timeout"),void deferred.reject(xhr,"timeout");if(e==SERVER_ABORT&&xhr)return xhr.abort("server abort"),void deferred.reject(xhr,"error","server abort");if(doc&&doc.location.href!=s.iframeSrc||timedOut){io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",cb,!1);var errMsg,status="success";try{if(timedOut)throw"timeout";var isXml="xml"==s.dataType||doc.XMLDocument||$.isXMLDoc(doc);if(log("isXml="+isXml),!isXml&&window.opera&&(null===doc.body||!doc.body.innerHTML)&&--domCheckCount)return log("requeing onLoad callback, DOM not available"),void setTimeout(cb,250);var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null,xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc,isXml&&(s.dataType="xml"),xhr.getResponseHeader=function(header){var headers={"content-type":s.dataType};return headers[header.toLowerCase()]},docRoot&&(xhr.status=Number(docRoot.getAttribute("status"))||xhr.status,xhr.statusText=docRoot.getAttribute("statusText")||xhr.statusText);var dt=(s.dataType||"").toLowerCase(),scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName("textarea")[0];if(ta)xhr.responseText=ta.value,xhr.status=Number(ta.getAttribute("status"))||xhr.status,xhr.statusText=ta.getAttribute("statusText")||xhr.statusText;else if(scr){var pre=doc.getElementsByTagName("pre")[0],b=doc.getElementsByTagName("body")[0];pre?xhr.responseText=pre.textContent?pre.textContent:pre.innerText:b&&(xhr.responseText=b.textContent?b.textContent:b.innerText)}}else"xml"==dt&&!xhr.responseXML&&xhr.responseText&&(xhr.responseXML=toXml(xhr.responseText));try{data=httpData(xhr,dt,s)}catch(err){status="parsererror",xhr.error=errMsg=err||status}}catch(err){log("error caught: ",err),status="error",xhr.error=errMsg=err||status}xhr.aborted&&(log("upload aborted"),status=null),xhr.status&&(status=xhr.status>=200&&xhr.status<300||304===xhr.status?"success":"error"),"success"===status?(s.success&&s.success.call(s.context,data,"success",xhr),deferred.resolve(xhr.responseText,"success",xhr),g&&$.event.trigger("ajaxSuccess",[xhr,s])):status&&(void 0===errMsg&&(errMsg=xhr.statusText),s.error&&s.error.call(s.context,xhr,status,errMsg),deferred.reject(xhr,"error",errMsg),g&&$.event.trigger("ajaxError",[xhr,s,errMsg])),g&&$.event.trigger("ajaxComplete",[xhr,s]),g&&!--$.active&&$.event.trigger("ajaxStop"),s.complete&&s.complete.call(s.context,xhr,status),callbackProcessed=!0,s.timeout&&clearTimeout(timeoutHandle),setTimeout(function(){s.iframeTarget?$io.attr("src",s.iframeSrc):$io.remove(),xhr.responseXML=null},100)}}}var el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle,form=$form[0],deferred=$.Deferred();if(deferred.abort=function(status){xhr.abort(status)},a)for(i=0;i<elements.length;i++)el=$(elements[i]),hasProp?el.prop("disabled",!1):el.removeAttr("disabled");if(s=$.extend(!0,{},$.ajaxSettings,options),s.context=s.context||s,id="jqFormIO"+(new Date).getTime(),s.iframeTarget?($io=$(s.iframeTarget),n=$io.attr2("name"),n?id=n:$io.attr2("name",id)):($io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />'),$io.css({position:"absolute",top:"-1000px",left:"-1000px"})),io=$io[0],xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e="timeout"===status?"timeout":"aborted";log("aborting upload... "+e),this.aborted=1;try{io.contentWindow.document.execCommand&&io.contentWindow.document.execCommand("Stop")}catch(ignore){}$io.attr("src",s.iframeSrc),xhr.error=e,s.error&&s.error.call(s.context,xhr,e,status),g&&$.event.trigger("ajaxError",[xhr,s,e]),s.complete&&s.complete.call(s.context,xhr,e)}},g=s.global,g&&0===$.active++&&$.event.trigger("ajaxStart"),g&&$.event.trigger("ajaxSend",[xhr,s]),s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===!1)return s.global&&$.active--,deferred.reject(),deferred;if(xhr.aborted)return deferred.reject(),deferred;sub=form.clk,sub&&(n=sub.name,n&&!sub.disabled&&(s.extraData=s.extraData||{},s.extraData[n]=sub.value,"image"==sub.type&&(s.extraData[n+".x"]=form.clk_x,s.extraData[n+".y"]=form.clk_y)));var CLIENT_TIMEOUT_ABORT=1,SERVER_ABORT=2,csrf_token=$("meta[name=csrf-token]").attr("content"),csrf_param=$("meta[name=csrf-param]").attr("content");csrf_param&&csrf_token&&(s.extraData=s.extraData||{},s.extraData[csrf_param]=csrf_token),s.forceSync?doSubmit():setTimeout(doSubmit,10);var data,doc,callbackProcessed,domCheckCount=50,toXml=$.parseXML||function(s,doc){return window.ActiveXObject?(doc=new ActiveXObject("Microsoft.XMLDOM"),doc.async="false",doc.loadXML(s)):doc=(new DOMParser).parseFromString(s,"text/xml"),doc&&doc.documentElement&&"parsererror"!=doc.documentElement.nodeName?doc:null},parseJSON=$.parseJSON||function(s){return window.eval("("+s+")")},httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type")||"",xml="xml"===type||!type&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;return xml&&"parsererror"===data.documentElement.nodeName&&$.error&&$.error("parsererror"),s&&s.dataFilter&&(data=s.dataFilter(data,type)),"string"==typeof data&&("json"===type||!type&&ct.indexOf("json")>=0?data=parseJSON(data):("script"===type||!type&&ct.indexOf("javascript")>=0)&&$.globalEval(data)),data};return deferred}if(!this.length)return log("ajaxSubmit: skipping submit process - no element selected"),this;var method,action,url,$form=this;"function"==typeof options?options={success:options}:void 0===options&&(options={}),method=options.type||this.attr2("method"),action=options.url||this.attr2("action"),url="string"==typeof action?$.trim(action):"",url=url||window.location.href||"",url&&(url=(url.match(/^([^#]+)/)||[])[1]),options=$.extend(!0,{url:url,success:$.ajaxSettings.success,type:method||$.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},options);var veto={};if(this.trigger("form-pre-serialize",[this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(options.beforeSerialize&&options.beforeSerialize(this,options)===!1)return log("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var traditional=options.traditional;void 0===traditional&&(traditional=$.ajaxSettings.traditional);var qx,elements=[],a=this.formToArray(options.semantic,elements);if(options.data&&(options.extraData=options.data,qx=$.param(options.data,traditional)),options.beforeSubmit&&options.beforeSubmit(a,this,options)===!1)return log("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[a,this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var q=$.param(a,traditional);qx&&(q=q?q+"&"+qx:qx),"GET"==options.type.toUpperCase()?(options.url+=(options.url.indexOf("?")>=0?"&":"?")+q,options.data=null):options.data=q;var callbacks=[];if(options.resetForm&&callbacks.push(function(){$form.resetForm()}),options.clearForm&&callbacks.push(function(){$form.clearForm(options.includeHidden)}),!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?"replaceWith":"html";$(options.target)[fn](data).each(oldSuccess,arguments)})}else options.success&&callbacks.push(options.success);if(options.success=function(data,status,xhr){for(var context=options.context||this,i=0,max=callbacks.length;max>i;i++)callbacks[i].apply(context,[data,status,xhr||$form,$form])},options.error){var oldError=options.error;options.error=function(xhr,status,error){var context=options.context||this;oldError.apply(context,[xhr,status,error,$form])}}if(options.complete){var oldComplete=options.complete;options.complete=function(xhr,status){var context=options.context||this;oldComplete.apply(context,[xhr,status,$form])}}var fileInputs=$("input[type=file]:enabled",this).filter(function(){return""!==$(this).val()}),hasFileInputs=fileInputs.length>0,mp="multipart/form-data",multipart=$form.attr("enctype")==mp||$form.attr("encoding")==mp,fileAPI=feature.fileapi&&feature.formdata;log("fileAPI :"+fileAPI);var jqxhr,shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;options.iframe!==!1&&(options.iframe||shouldUseFrame)?options.closeKeepAlive?$.get(options.closeKeepAlive,function(){jqxhr=fileUploadIframe(a)}):jqxhr=fileUploadIframe(a):jqxhr=(hasFileInputs||multipart)&&fileAPI?fileUploadXhr(a):$.ajax(options),$form.removeData("jqxhr").data("jqxhr",jqxhr);for(var k=0;k<elements.length;k++)elements[k]=null;return this.trigger("form-submit-notify",[this,options]),this},$.fn.ajaxForm=function(options){if(options=options||{},options.delegation=options.delegation&&$.isFunction($.fn.on),!options.delegation&&0===this.length){var o={s:this.selector,c:this.context};return!$.isReady&&o.s?(log("DOM not ready, queuing ajaxForm"),$(function(){$(o.s,o.c).ajaxForm(options)}),this):(log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)")),this)}return options.delegation?($(document).off("submit.form-plugin",this.selector,doAjaxSubmit).off("click.form-plugin",this.selector,captureSubmittingElement).on("submit.form-plugin",this.selector,options,doAjaxSubmit).on("click.form-plugin",this.selector,options,captureSubmittingElement),this):this.ajaxFormUnbind().bind("submit.form-plugin",options,doAjaxSubmit).bind("click.form-plugin",options,captureSubmittingElement)},$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},$.fn.formToArray=function(semantic,elements){var a=[];if(0===this.length)return a;var els2,form=this[0],formId=this.attr("id"),els=semantic?form.getElementsByTagName("*"):form.elements;if(els&&!/MSIE [678]/.test(navigator.userAgent)&&(els=$(els).get()),formId&&(els2=$(':input[form="'+formId+'"]').get(),els2.length&&(els=(els||[]).concat(els2))),!els||!els.length)return a;var i,j,n,v,el,max,jmax;for(i=0,max=els.length;max>i;i++)if(el=els[i],n=el.name,n&&!el.disabled)if(semantic&&form.clk&&"image"==el.type)form.clk==el&&(a.push({name:n,value:$(el).val(),type:el.type}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}));else if(v=$.fieldValue(el,!0),v&&v.constructor==Array)for(elements&&elements.push(el),j=0,jmax=v.length;jmax>j;j++)a.push({name:n,value:v[j]});else if(feature.fileapi&&"file"==el.type){elements&&elements.push(el);var files=el.files;if(files.length)for(j=0;j<files.length;j++)a.push({name:n,value:files[j],type:el.type});else a.push({name:n,value:"",type:el.type})}else null!==v&&"undefined"!=typeof v&&(elements&&elements.push(el),a.push({name:n,value:v,type:el.type,required:el.required}));if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name,n&&!input.disabled&&"image"==input.type&&(a.push({name:n,value:$input.val()}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}))}return a},$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))},$.fn.fieldSerialize=function(successful){var a=[];return this.each(function(){var n=this.name;if(n){var v=$.fieldValue(this,successful);if(v&&v.constructor==Array)for(var i=0,max=v.length;max>i;i++)a.push({name:n,value:v[i]});else null!==v&&"undefined"!=typeof v&&a.push({name:this.name,value:v})}}),$.param(a)},$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;max>i;i++){var el=this[i],v=$.fieldValue(el,successful);null===v||"undefined"==typeof v||v.constructor==Array&&!v.length||(v.constructor==Array?$.merge(val,v):val.push(v))}return val},$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(void 0===successful&&(successful=!0),successful&&(!n||el.disabled||"reset"==t||"button"==t||("checkbox"==t||"radio"==t)&&!el.checked||("submit"==t||"image"==t)&&el.form&&el.form.clk!=el||"select"==tag&&-1==el.selectedIndex))return null;if("select"==tag){var index=el.selectedIndex;if(0>index)return null;for(var a=[],ops=el.options,one="select-one"==t,max=one?index+1:ops.length,i=one?index:0;max>i;i++){var op=ops[i];if(op.selected){var v=op.value;if(v||(v=op.attributes&&op.attributes.value&&!op.attributes.value.specified?op.text:op.value),one)return v;a.push(v)}}return a}return $(el).val()},$.fn.clearForm=function(includeHidden){return this.each(function(){$("input,select,textarea",this).clearFields(includeHidden)})},$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();re.test(t)||"textarea"==tag?this.value="":"checkbox"==t||"radio"==t?this.checked=!1:"select"==tag?this.selectedIndex=-1:"file"==t?/MSIE/.test(navigator.userAgent)?$(this).replaceWith($(this).clone(!0)):$(this).val(""):includeHidden&&(includeHidden===!0&&/hidden/.test(t)||"string"==typeof includeHidden&&$(this).is(includeHidden))&&(this.value="")})},$.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},$.fn.enable=function(b){return void 0===b&&(b=!0),this.each(function(){this.disabled=!b})},$.fn.selected=function(select){return void 0===select&&(select=!0),this.each(function(){var t=this.type;if("checkbox"==t||"radio"==t)this.checked=select;else if("option"==this.tagName.toLowerCase()){var $sel=$(this).parent("select");select&&$sel[0]&&"select-one"==$sel[0].type&&$sel.find("option").selected(!1),this.selected=select}})},$.fn.ajaxSubmit.debug=!1});
\ No newline at end of file
+!function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):factory("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function($){"use strict";function doAjaxSubmit(e){var options=e.data;e.isDefaultPrevented()||(e.preventDefault(),$(e.target).ajaxSubmit(options))}function captureSubmittingElement(e){var target=e.target,$el=$(target);if(!$el.is("[type=submit],[type=image]")){var t=$el.closest("[type=submit]");if(0===t.length)return;target=t[0]}var form=this;if(form.clk=target,"image"==target.type)if(void 0!==e.offsetX)form.clk_x=e.offsetX,form.clk_y=e.offsetY;else if("function"==typeof $.fn.offset){var offset=$el.offset();form.clk_x=e.pageX-offset.left,form.clk_y=e.pageY-offset.top}else form.clk_x=e.pageX-target.offsetLeft,form.clk_y=e.pageY-target.offsetTop;setTimeout(function(){form.clk=form.clk_x=form.clk_y=null},100)}function log(){if($.fn.ajaxSubmit.debug){var msg="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(msg):window.opera&&window.opera.postError&&window.opera.postError(msg)}}var feature={};feature.fileapi=void 0!==$("<input type='file'/>").get(0).files,feature.formdata=void 0!==window.FormData;var hasProp=!!$.fn.prop;$.fn.attr2=function(){if(!hasProp)return this.attr.apply(this,arguments);var val=this.prop.apply(this,arguments);return val&&val.jquery||"string"==typeof val?val:this.attr.apply(this,arguments)},$.fn.ajaxSubmit=function(options){function deepSerialize(extraData){var i,part,serialized=$.param(extraData,options.traditional).split("&"),len=serialized.length,result=[];for(i=0;i<len;i++)serialized[i]=serialized[i].replace(/\+/g," "),part=serialized[i].split("="),result.push([decodeURIComponent(part[0]),decodeURIComponent(part[1])]);return result}function fileUploadXhr(a){for(var formdata=new FormData,i=0;i<a.length;i++)formdata.append(a[i].name,a[i].value);if(options.extraData){var serializedData=deepSerialize(options.extraData);for(i=0;i<serializedData.length;i++)serializedData[i]&&formdata.append(serializedData[i][0],serializedData[i][1])}options.data=null;var s=$.extend(!0,{},$.ajaxSettings,options,{contentType:!1,processData:!1,cache:!1,type:method||"POST"});options.uploadProgress&&(s.xhr=function(){var xhr=$.ajaxSettings.xhr();return xhr.upload&&xhr.upload.addEventListener("progress",function(event){var percent=0,position=event.loaded||event.position,total=event.total;event.lengthComputable&&(percent=Math.ceil(position/total*100)),options.uploadProgress(event,position,total,percent)},!1),xhr}),s.data=null;var beforeSend=s.beforeSend;return s.beforeSend=function(xhr,o){options.formData?o.data=options.formData:o.data=formdata,beforeSend&&beforeSend.call(this,xhr,o)},$.ajax(s)}function fileUploadIframe(a){function getDoc(frame){var doc=null;try{frame.contentWindow&&(doc=frame.contentWindow.document)}catch(err){log("cannot get iframe.contentWindow document: "+err)}if(doc)return doc;try{doc=frame.contentDocument?frame.contentDocument:frame.document}catch(err){log("cannot get iframe.contentDocument: "+err),doc=frame.document}return doc}function doSubmit(){function checkState(){try{var state=getDoc(io).readyState;log("state = "+state),state&&"uninitialized"==state.toLowerCase()&&setTimeout(checkState,50)}catch(e){log("Server abort: ",e," (",e.name,")"),cb(SERVER_ABORT),timeoutHandle&&clearTimeout(timeoutHandle),timeoutHandle=void 0}}var t=$form.attr2("target"),a=$form.attr2("action"),mp="multipart/form-data",et=$form.attr("enctype")||$form.attr("encoding")||mp;form.setAttribute("target",id),method&&!/post/i.test(method)||form.setAttribute("method","POST"),a!=s.url&&form.setAttribute("action",s.url),s.skipEncodingOverride||method&&!/post/i.test(method)||$form.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),s.timeout&&(timeoutHandle=setTimeout(function(){timedOut=!0,cb(CLIENT_TIMEOUT_ABORT)},s.timeout));var extraInputs=[];try{if(s.extraData)for(var n in s.extraData)s.extraData.hasOwnProperty(n)&&($.isPlainObject(s.extraData[n])&&s.extraData[n].hasOwnProperty("name")&&s.extraData[n].hasOwnProperty("value")?extraInputs.push($('<input type="hidden" name="'+s.extraData[n].name+'">').val(s.extraData[n].value).appendTo(form)[0]):extraInputs.push($('<input type="hidden" name="'+n+'">').val(s.extraData[n]).appendTo(form)[0]));s.iframeTarget||$io.appendTo("body"),io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,!1),setTimeout(checkState,15);try{form.submit()}catch(err){var submitFn=document.createElement("form").submit;submitFn.apply(form)}}finally{form.setAttribute("action",a),form.setAttribute("enctype",et),t?form.setAttribute("target",t):$form.removeAttr("target"),$(extraInputs).remove()}}function cb(e){if(!xhr.aborted&&!callbackProcessed){if(doc=getDoc(io),doc||(log("cannot access response document"),e=SERVER_ABORT),e===CLIENT_TIMEOUT_ABORT&&xhr)return xhr.abort("timeout"),void deferred.reject(xhr,"timeout");if(e==SERVER_ABORT&&xhr)return xhr.abort("server abort"),void deferred.reject(xhr,"error","server abort");if(doc&&doc.location.href!=s.iframeSrc||timedOut){io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",cb,!1);var errMsg,status="success";try{if(timedOut)throw"timeout";var isXml="xml"==s.dataType||doc.XMLDocument||$.isXMLDoc(doc);if(log("isXml="+isXml),!isXml&&window.opera&&(null===doc.body||!doc.body.innerHTML)&&--domCheckCount)return log("requeing onLoad callback, DOM not available"),void setTimeout(cb,250);var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null,xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc,isXml&&(s.dataType="xml"),xhr.getResponseHeader=function(header){var headers={"content-type":s.dataType};return headers[header.toLowerCase()]},docRoot&&(xhr.status=Number(docRoot.getAttribute("status"))||xhr.status,xhr.statusText=docRoot.getAttribute("statusText")||xhr.statusText);var dt=(s.dataType||"").toLowerCase(),scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName("textarea")[0];if(ta)xhr.responseText=ta.value,xhr.status=Number(ta.getAttribute("status"))||xhr.status,xhr.statusText=ta.getAttribute("statusText")||xhr.statusText;else if(scr){var pre=doc.getElementsByTagName("pre")[0],b=doc.getElementsByTagName("body")[0];pre?xhr.responseText=pre.textContent?pre.textContent:pre.innerText:b&&(xhr.responseText=b.textContent?b.textContent:b.innerText)}}else"xml"==dt&&!xhr.responseXML&&xhr.responseText&&(xhr.responseXML=toXml(xhr.responseText));try{data=httpData(xhr,dt,s)}catch(err){status="parsererror",xhr.error=errMsg=err||status}}catch(err){log("error caught: ",err),status="error",xhr.error=errMsg=err||status}xhr.aborted&&(log("upload aborted"),status=null),xhr.status&&(status=xhr.status>=200&&xhr.status<300||304===xhr.status?"success":"error"),"success"===status?(s.success&&s.success.call(s.context,data,"success",xhr),deferred.resolve(xhr.responseText,"success",xhr),g&&$.event.trigger("ajaxSuccess",[xhr,s])):status&&(void 0===errMsg&&(errMsg=xhr.statusText),s.error&&s.error.call(s.context,xhr,status,errMsg),deferred.reject(xhr,"error",errMsg),g&&$.event.trigger("ajaxError",[xhr,s,errMsg])),g&&$.event.trigger("ajaxComplete",[xhr,s]),g&&!--$.active&&$.event.trigger("ajaxStop"),s.complete&&s.complete.call(s.context,xhr,status),callbackProcessed=!0,s.timeout&&clearTimeout(timeoutHandle),setTimeout(function(){s.iframeTarget?$io.attr("src",s.iframeSrc):$io.remove(),xhr.responseXML=null},100)}}}var el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle,form=$form[0],deferred=$.Deferred();if(deferred.abort=function(status){xhr.abort(status)},a)for(i=0;i<elements.length;i++)el=$(elements[i]),hasProp?el.prop("disabled",!1):el.removeAttr("disabled");if(s=$.extend(!0,{},$.ajaxSettings,options),s.context=s.context||s,id="jqFormIO"+(new Date).getTime(),s.iframeTarget?($io=$(s.iframeTarget),n=$io.attr2("name"),n?id=n:$io.attr2("name",id)):($io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />'),$io.css({position:"absolute",top:"-1000px",left:"-1000px"})),io=$io[0],xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e="timeout"===status?"timeout":"aborted";log("aborting upload... "+e),this.aborted=1;try{io.contentWindow.document.execCommand&&io.contentWindow.document.execCommand("Stop")}catch(ignore){}$io.attr("src",s.iframeSrc),xhr.error=e,s.error&&s.error.call(s.context,xhr,e,status),g&&$.event.trigger("ajaxError",[xhr,s,e]),s.complete&&s.complete.call(s.context,xhr,e)}},g=s.global,g&&0===$.active++&&$.event.trigger("ajaxStart"),g&&$.event.trigger("ajaxSend",[xhr,s]),s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===!1)return s.global&&$.active--,deferred.reject(),deferred;if(xhr.aborted)return deferred.reject(),deferred;sub=form.clk,sub&&(n=sub.name,n&&!sub.disabled&&(s.extraData=s.extraData||{},s.extraData[n]=sub.value,"image"==sub.type&&(s.extraData[n+".x"]=form.clk_x,s.extraData[n+".y"]=form.clk_y)));var CLIENT_TIMEOUT_ABORT=1,SERVER_ABORT=2,csrf_token=$("meta[name=csrf-token]").attr("content"),csrf_param=$("meta[name=csrf-param]").attr("content");csrf_param&&csrf_token&&(s.extraData=s.extraData||{},s.extraData[csrf_param]=csrf_token),s.forceSync?doSubmit():setTimeout(doSubmit,10);var data,doc,callbackProcessed,domCheckCount=50,toXml=$.parseXML||function(s,doc){return window.ActiveXObject?(doc=new ActiveXObject("Microsoft.XMLDOM"),doc.async="false",doc.loadXML(s)):doc=(new DOMParser).parseFromString(s,"text/xml"),doc&&doc.documentElement&&"parsererror"!=doc.documentElement.nodeName?doc:null},parseJSON=$.parseJSON||function(s){return window.eval("("+s+")")},httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type")||"",xml="xml"===type||!type&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;return xml&&"parsererror"===data.documentElement.nodeName&&$.error&&$.error("parsererror"),s&&s.dataFilter&&(data=s.dataFilter(data,type)),"string"==typeof data&&("json"===type||!type&&ct.indexOf("json")>=0?data=parseJSON(data):("script"===type||!type&&ct.indexOf("javascript")>=0)&&$.globalEval(data)),data};return deferred}if(!this.length)return log("ajaxSubmit: skipping submit process - no element selected"),this;var method,action,url,$form=this;"function"==typeof options?options={success:options}:void 0===options&&(options={}),method=options.type||this.attr2("method"),action=options.url||this.attr2("action"),url="string"==typeof action?$.trim(action):"",url=url||window.location.href||"",url&&(url=(url.match(/^([^#]+)/)||[])[1]),options=$.extend(!0,{url:url,success:$.ajaxSettings.success,type:method||$.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},options);var veto={};if(this.trigger("form-pre-serialize",[this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(options.beforeSerialize&&options.beforeSerialize(this,options)===!1)return log("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var traditional=options.traditional;void 0===traditional&&(traditional=$.ajaxSettings.traditional);var qx,elements=[],a=this.formToArray(options.semantic,elements);if(options.data&&(options.extraData=options.data,qx=$.param(options.data,traditional)),options.beforeSubmit&&options.beforeSubmit(a,this,options)===!1)return log("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[a,this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var q=$.param(a,traditional);qx&&(q=q?q+"&"+qx:qx),"GET"==options.type.toUpperCase()?(options.url+=(options.url.indexOf("?")>=0?"&":"?")+q,options.data=null):options.data=q;var callbacks=[];if(options.resetForm&&callbacks.push(function(){$form.resetForm()}),options.clearForm&&callbacks.push(function(){$form.clearForm(options.includeHidden)}),!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?"replaceWith":"html";$(options.target)[fn](data).each(oldSuccess,arguments)})}else options.success&&callbacks.push(options.success);if(options.success=function(data,status,xhr){for(var context=options.context||this,i=0,max=callbacks.length;i<max;i++)callbacks[i].apply(context,[data,status,xhr||$form,$form])},options.error){var oldError=options.error;options.error=function(xhr,status,error){var context=options.context||this;oldError.apply(context,[xhr,status,error,$form])}}if(options.complete){var oldComplete=options.complete;options.complete=function(xhr,status){var context=options.context||this;oldComplete.apply(context,[xhr,status,$form])}}var fileInputs=$("input[type=file]:enabled",this).filter(function(){return""!==$(this).val()}),hasFileInputs=fileInputs.length>0,mp="multipart/form-data",multipart=$form.attr("enctype")==mp||$form.attr("encoding")==mp,fileAPI=feature.fileapi&&feature.formdata;log("fileAPI :"+fileAPI);var jqxhr,shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;options.iframe!==!1&&(options.iframe||shouldUseFrame)?options.closeKeepAlive?$.get(options.closeKeepAlive,function(){jqxhr=fileUploadIframe(a)}):jqxhr=fileUploadIframe(a):jqxhr=(hasFileInputs||multipart)&&fileAPI?fileUploadXhr(a):$.ajax(options),$form.removeData("jqxhr").data("jqxhr",jqxhr);for(var k=0;k<elements.length;k++)elements[k]=null;return this.trigger("form-submit-notify",[this,options]),this},$.fn.ajaxForm=function(options){if(options=options||{},options.delegation=options.delegation&&$.isFunction($.fn.on),!options.delegation&&0===this.length){var o={s:this.selector,c:this.context};return!$.isReady&&o.s?(log("DOM not ready, queuing ajaxForm"),$(function(){$(o.s,o.c).ajaxForm(options)}),this):(log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)")),this)}return options.delegation?($(document).off("submit.form-plugin",this.selector,doAjaxSubmit).off("click.form-plugin",this.selector,captureSubmittingElement).on("submit.form-plugin",this.selector,options,doAjaxSubmit).on("click.form-plugin",this.selector,options,captureSubmittingElement),this):this.ajaxFormUnbind().bind("submit.form-plugin",options,doAjaxSubmit).bind("click.form-plugin",options,captureSubmittingElement)},$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},$.fn.formToArray=function(semantic,elements){var a=[];if(0===this.length)return a;var els2,form=this[0],formId=this.attr("id"),els=semantic?form.getElementsByTagName("*"):form.elements;if(els&&!/MSIE [678]/.test(navigator.userAgent)&&(els=$(els).get()),formId&&(els2=$(':input[form="'+formId+'"]').get(),els2.length&&(els=(els||[]).concat(els2))),!els||!els.length)return a;var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++)if(el=els[i],n=el.name,n&&!el.disabled)if(semantic&&form.clk&&"image"==el.type)form.clk==el&&(a.push({name:n,value:$(el).val(),type:el.type}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}));else if(v=$.fieldValue(el,!0),v&&v.constructor==Array)for(elements&&elements.push(el),j=0,jmax=v.length;j<jmax;j++)a.push({name:n,value:v[j]});else if(feature.fileapi&&"file"==el.type){elements&&elements.push(el);var files=el.files;if(files.length)for(j=0;j<files.length;j++)a.push({name:n,value:files[j],type:el.type});else a.push({name:n,value:"",type:el.type})}else null!==v&&"undefined"!=typeof v&&(elements&&elements.push(el),a.push({name:n,value:v,type:el.type,required:el.required}));if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name,n&&!input.disabled&&"image"==input.type&&(a.push({name:n,value:$input.val()}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}))}return a},$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))},$.fn.fieldSerialize=function(successful){var a=[];return this.each(function(){var n=this.name;if(n){var v=$.fieldValue(this,successful);if(v&&v.constructor==Array)for(var i=0,max=v.length;i<max;i++)a.push({name:n,value:v[i]});else null!==v&&"undefined"!=typeof v&&a.push({name:this.name,value:v})}}),$.param(a)},$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i],v=$.fieldValue(el,successful);null===v||"undefined"==typeof v||v.constructor==Array&&!v.length||(v.constructor==Array?$.merge(val,v):val.push(v))}return val},$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(void 0===successful&&(successful=!0),successful&&(!n||el.disabled||"reset"==t||"button"==t||("checkbox"==t||"radio"==t)&&!el.checked||("submit"==t||"image"==t)&&el.form&&el.form.clk!=el||"select"==tag&&el.selectedIndex==-1))return null;if("select"==tag){var index=el.selectedIndex;if(index<0)return null;for(var a=[],ops=el.options,one="select-one"==t,max=one?index+1:ops.length,i=one?index:0;i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(v||(v=op.attributes&&op.attributes.value&&!op.attributes.value.specified?op.text:op.value),one)return v;a.push(v)}}return a}return $(el).val()},$.fn.clearForm=function(includeHidden){return this.each(function(){$("input,select,textarea",this).clearFields(includeHidden)})},$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();re.test(t)||"textarea"==tag?this.value="":"checkbox"==t||"radio"==t?this.checked=!1:"select"==tag?this.selectedIndex=-1:"file"==t?/MSIE/.test(navigator.userAgent)?$(this).replaceWith($(this).clone(!0)):$(this).val(""):includeHidden&&(includeHidden===!0&&/hidden/.test(t)||"string"==typeof includeHidden&&$(this).is(includeHidden))&&(this.value="")})},$.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},$.fn.enable=function(b){return void 0===b&&(b=!0),this.each(function(){this.disabled=!b})},$.fn.selected=function(select){return void 0===select&&(select=!0),this.each(function(){var t=this.type;if("checkbox"==t||"radio"==t)this.checked=select;else if("option"==this.tagName.toLowerCase()){var $sel=$(this).parent("select");select&&$sel[0]&&"select-one"==$sel[0].type&&$sel.find("option").selected(!1),this.selected=select}})},$.fn.ajaxSubmit.debug=!1});
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.dateinput.js b/plone/app/jquerytools/browser/jquery.tools.dateinput.js
index a3a0845..5c12d0c 100644
--- a/plone/app/jquerytools/browser/jquery.tools.dateinput.js
+++ b/plone/app/jquerytools/browser/jquery.tools.dateinput.js
@@ -211,9 +211,8 @@
 		
 		// use sane values for value, min & max		
 		value = parseDate(value) || now;  
-		
-		min   = parseDate(min || new Date(yearNow + conf.yearRange[0], 1, 1));
-		max   = parseDate(max || new Date( yearNow + conf.yearRange[1]+ 1, 1, -1));
+		min   = parseDate(min || new Date(yearNow + conf.yearRange[0], 0, 1));
+		max   = parseDate(max || new Date(yearNow + conf.yearRange[1]+ 1, 0, 0));
 		
 		
 		// check that language exists
diff --git a/plone/app/jquerytools/browser/jquery.tools.dateinput.min.js b/plone/app/jquerytools/browser/jquery.tools.dateinput.min.js
index 9fef390..e165f44 100644
--- a/plone/app/jquerytools/browser/jquery.tools.dateinput.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.dateinput.min.js
@@ -1 +1 @@
-!function($,undefined){function dayAm(year,month){return new Date(year,month+1,0).getDate()}function zeropad(val,len){for(val=""+val,len=len||2;val.length<len;)val="0"+val;return val}function format(formatter,date,text,lang){var d=date.getDate(),D=date.getDay(),m=date.getMonth(),y=date.getFullYear(),flags={d:d,dd:zeropad(d),ddd:LABELS[lang].shortDays[D],dddd:LABELS[lang].days[D],m:m+1,mm:zeropad(m+1),mmm:LABELS[lang].shortMonths[m],mmmm:LABELS[lang].months[m],yy:String(y).slice(2),yyyy:y},ret=formatters[formatter](text,date,flags,lang);return tmpTag.html(ret).html()}function integer(val){return parseInt(val,10)}function isSameDay(d1,d2){return d1.getFullYear()===d2.getFullYear()&&d1.getMonth()==d2.getMonth()&&d1.getDate()==d2.getDate()}function parseDate(val){if(val!==undefined){if(val.constructor==Date)return val;if("string"==typeof val){var els=val.split("-");if(3==els.length)return new Date(integer(els[0]),integer(els[1])-1,integer(els[2]));if(!/^-?\d+$/.test(val))return;val=integer(val)}var date=new Date;return date.setDate(date.getDate()+val),date}}function Dateinput(input,conf){function select(date,conf,e){return input.attr("readonly")?void self.hide(e):(value=date,currYear=date.getFullYear(),currMonth=date.getMonth(),currDay=date.getDate(),e||(e=$.Event("api")),"click"!=e.type||/msie/.test(navigator.userAgent.toLowerCase())||input.focus(),e.type="beforeChange",fire.trigger(e,[date]),void(e.isDefaultPrevented()||(input.val(format(conf.formatter,date,conf.format,conf.lang)),e.type="change",e.target=input[0],fire.trigger(e),input.data("date",date),self.hide(e))))}function onShow(ev){ev.type="onShow",fire.trigger(ev),$(document).on("keydown.d",function(e){if(e.ctrlKey)return!0;var key=e.keyCode;if(8==key||46==key)return input.val(""),self.hide(e);if(27==key||9==key)return self.hide(e);if($(KEYS).index(key)>=0){if(!opened)return self.show(e),e.preventDefault();var days=$("#"+css.weeks+" a"),el=$("."+css.focus),index=days.index(el);return el.removeClass(css.focus),74==key||40==key?index+=7:75==key||38==key?index-=7:76==key||39==key?index+=1:(72==key||37==key)&&(index-=1),index>41?(self.addMonth(),el=$("#"+css.weeks+" a:eq("+(index-42)+")")):0>index?(self.addMonth(-1),el=$("#"+css.weeks+" a:eq("+(index+42)+")")):el=days.eq(index),el.addClass(css.focus),e.preventDefault()}return 34==key?self.addMonth():33==key?self.addMonth(-1):36==key?self.today():(13==key&&($(e.target).is("select")||$("."+css.focus).click()),$([16,17,18,9]).index(key)>=0)}),$(document).on("click.d",function(e){var el=e.target;el.id==css.root||$(el).parents("#"+css.root).length||el==input[0]||trigger&&el==trigger[0]||self.hide(e)})}var trigger,pm,nm,currYear,currMonth,currDay,opened,original,self=this,now=new Date,yearNow=now.getFullYear(),css=conf.css,labels=LABELS[conf.lang],root=$("#"+css.root),title=root.find("#"+css.title),value=input.attr("data-value")||conf.value||input.val(),min=input.attr("min")||conf.min,max=input.attr("max")||conf.max;if(0===min&&(min="0"),value=parseDate(value)||now,min=parseDate(min||new Date(yearNow+conf.yearRange[0],1,1)),max=parseDate(max||new Date(yearNow+conf.yearRange[1]+1,1,-1)),!labels)throw"Dateinput: invalid language: "+conf.lang;if("date"==input.attr("type")){var original=input.clone(),def=original.wrap("<div/>").parent().html(),clone=$(def.replace(/type/i,"type=text data-orig-type"));conf.value&&clone.val(conf.value),input.replaceWith(clone),input=clone}input.addClass(css.input);var fire=input.add(self);if(!root.length){if(root=$("<div><div><a/><div/><a/></div><div><div/><div/></div></div>").hide().css({position:"absolute"}).attr("id",css.root),root.children().eq(0).attr("id",css.head).end().eq(1).attr("id",css.body).children().eq(0).attr("id",css.days).end().eq(1).attr("id",css.weeks).end().end().end().find("a").eq(0).attr("id",css.prev).end().eq(1).attr("id",css.next),title=root.find("#"+css.head).find("div").attr("id",css.title),conf.selectors){var monthSelector=$("<select/>").attr("id",css.month),yearSelector=$("<select/>").attr("id",css.year);title.html(monthSelector.add(yearSelector))}for(var days=root.find("#"+css.days),d=0;7>d;d++)days.append($("<span/>").text(labels.shortDays[(d+conf.firstDay)%7]));$("body").append(root)}conf.trigger&&(trigger=$("<a/>").attr("href","#").addClass(css.trigger).click(function(e){return conf.toggle?self.toggle():self.show(),e.preventDefault()}).insertAfter(input));var weeks=root.find("#"+css.weeks);yearSelector=root.find("#"+css.year),monthSelector=root.find("#"+css.month),$.extend(self,{show:function(e){if(!input.attr("disabled")&&!opened&&(e=e||$.Event(),e.type="onBeforeShow",fire.trigger(e),!e.isDefaultPrevented())){$.each(instances,function(){this.hide()}),opened=!0,monthSelector.off("change").change(function(){self.setValue(integer(yearSelector.val()),integer($(this).val()))}),yearSelector.off("change").change(function(){self.setValue(integer($(this).val()),integer(monthSelector.val()))}),pm=root.find("#"+css.prev).off("click").click(function(){return pm.hasClass(css.disabled)||self.addMonth(-1),!1}),nm=root.find("#"+css.next).off("click").click(function(){return nm.hasClass(css.disabled)||self.addMonth(),!1}),self.setValue(value);var pos=input.offset();return/iPad/i.test(navigator.userAgent)&&(pos.top-=$(window).scrollTop()),root.css({top:pos.top+input.outerHeight(!0)+conf.offset[0],left:pos.left+conf.offset[1]}),conf.speed?root.show(conf.speed,function(){onShow(e)}):(root.show(),onShow(e)),self}},setValue:function(year,month,day){var date=integer(month)>=-1?new Date(integer(year),integer(month),integer(day==undefined||isNaN(day)?1:day)):year||value;if(min>date?date=min:date>max&&(date=max),"string"==typeof year&&(date=parseDate(year)),year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),-1==month?(month=11,year--):12==month&&(month=0,year++),!opened)return select(date,conf),self;currMonth=month,currYear=year,currDay=day;var week,tmp=new Date(year,month,1-conf.firstDay),begin=tmp.getDay(),days=dayAm(year,month),prevDays=dayAm(year,month-1);if(conf.selectors){monthSelector.empty(),$.each(labels.months,function(i,m){min<new Date(year,i+1,1)&&max>new Date(year,i,0)&&monthSelector.append($("<option/>").html(m).attr("value",i))}),yearSelector.empty();for(var yearNow=now.getFullYear(),i=yearNow+conf.yearRange[0];i<yearNow+conf.yearRange[1];i++)min<new Date(i+1,0,1)&&max>new Date(i,0,0)&&yearSelector.append($("<option/>").text(i));monthSelector.val(month),yearSelector.val(year)}else title.html(labels.months[month]+" "+year);weeks.empty(),pm.add(nm).removeClass(css.disabled);for(var a,num,j=begin?0:-7;(begin?42:35)>j;j++)a=$("<a/>"),j%7===0&&(week=$("<div/>").addClass(css.week),weeks.append(week)),begin>j?(a.addClass(css.off),num=prevDays-begin+j+1,date=new Date(year,month-1,num)):j>=begin+days?(a.addClass(css.off),num=j-days-begin+1,date=new Date(year,month+1,num)):(num=j-begin+1,date=new Date(year,month,num),isSameDay(value,date)?a.attr("id",css.current).addClass(css.focus):isSameDay(now,date)&&a.attr("id",css.today)),min&&min>date&&a.add(pm).addClass(css.disabled),max&&date>max&&a.add(nm).addClass(css.disabled),a.attr("href","#"+num).text(num).data("date",date),week.append(a);return weeks.find("a").click(function(e){var el=$(this);return el.hasClass(css.disabled)||($("#"+css.current).removeAttr("id"),el.attr("id",css.current),select(el.data("date"),conf,e)),!1}),css.sunday&&weeks.find("."+css.week).each(function(){var beg=conf.firstDay?7-conf.firstDay:0;$(this).children().slice(beg,beg+1).addClass(css.sunday)}),self},setMin:function(val,fit){return min=parseDate(val),fit&&min>value&&self.setValue(min),self},setMax:function(val,fit){return max=parseDate(val),fit&&value>max&&self.setValue(max),self},today:function(){return self.setValue(now)},addDay:function(amount){return this.setValue(currYear,currMonth,currDay+(amount||1))},addMonth:function(amount){var targetMonth=currMonth+(amount||1),daysInTargetMonth=dayAm(currYear,targetMonth),targetDay=daysInTargetMonth>=currDay?currDay:daysInTargetMonth;return this.setValue(currYear,targetMonth,targetDay)},addYear:function(amount){return this.setValue(currYear+(amount||1),currMonth,currDay)},destroy:function(){input.add(document).off("click.d keydown.d"),root.add(trigger).remove(),input.removeData("dateinput").removeClass(css.input),original&&input.replaceWith(original)},hide:function(e){if(opened){if(e=$.Event(),e.type="onHide",fire.trigger(e),e.isDefaultPrevented())return;$(document).off("click.d keydown.d"),root.hide(),opened=!1}return self},toggle:function(){return self.isOpen()?self.hide():self.show()},getConf:function(){return conf},getInput:function(){return input},getCalendar:function(){return root},getValue:function(dateFormat){return dateFormat?format(conf.formatter,value,dateFormat,conf.lang):value},isOpen:function(){return opened}}),$.each(["onBeforeShow","onShow","change","onHide"],function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.editable||input.on("focus.d click.d",self.show).keydown(function(e){var key=e.keyCode;return!opened&&$(KEYS).index(key)>=0?(self.show(e),e.preventDefault()):((8==key||46==key)&&input.val(""),e.shiftKey||e.ctrlKey||e.altKey||9==key?!0:e.preventDefault())}),parseDate(input.val())&&select(value,conf)}$.tools=$.tools||{version:"@VERSION"};var tool,instances=[],formatters={},KEYS=[75,76,38,39,74,72,40,37],LABELS={};tool=$.tools.dateinput={conf:{format:"mm/dd/yy",formatter:"default",selectors:!1,yearRange:[-5,5],lang:"en",offset:[0,0],speed:0,firstDay:0,min:undefined,max:undefined,trigger:0,toggle:0,editable:0,css:{prefix:"cal",input:"date",root:0,head:0,title:0,prev:0,next:0,month:0,year:0,days:0,body:0,weeks:0,today:0,current:0,week:0,off:0,sunday:0,focus:0,disabled:0,trigger:0}},addFormatter:function(name,fn){formatters[name]=fn},localize:function(language,labels){$.each(labels,function(key,val){labels[key]=val.split(",")}),LABELS[language]=labels}},tool.localize("en",{months:"January,February,March,April,May,June,July,August,September,October,November,December",shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",days:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat"});var tmpTag=$("<a/>");tool.addFormatter("default",function(text,date,flags){return text.replace(/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g,function($0){return $0 in flags?flags[$0]:$0})}),tool.addFormatter("prefixed",function(text,date,flags){return text.replace(/%(d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*')/g,function($0,$1){return $1 in flags?flags[$1]:$0})}),$.expr[":"].date=function(el){var type=el.getAttribute("type");return type&&"date"==type||!!$(el).data("dateinput")},$.fn.dateinput=function(conf){if(this.data("dateinput"))return this;conf=$.extend(!0,{},tool.conf,conf),$.each(conf.css,function(key,val){val||"prefix"==key||(conf.css[key]=(conf.css.prefix||"")+(val||key))});var els;return this.each(function(){var el=new Dateinput($(this),conf);instances.push(el);var input=el.getInput().data("dateinput",el);els=els?els.add(input):input}),els?els:this}}(jQuery);
\ No newline at end of file
+!function($,undefined){function dayAm(year,month){return new Date(year,month+1,0).getDate()}function zeropad(val,len){for(val=""+val,len=len||2;val.length<len;)val="0"+val;return val}function format(formatter,date,text,lang){var d=date.getDate(),D=date.getDay(),m=date.getMonth(),y=date.getFullYear(),flags={d:d,dd:zeropad(d),ddd:LABELS[lang].shortDays[D],dddd:LABELS[lang].days[D],m:m+1,mm:zeropad(m+1),mmm:LABELS[lang].shortMonths[m],mmmm:LABELS[lang].months[m],yy:String(y).slice(2),yyyy:y},ret=formatters[formatter](text,date,flags,lang);return tmpTag.html(ret).html()}function integer(val){return parseInt(val,10)}function isSameDay(d1,d2){return d1.getFullYear()===d2.getFullYear()&&d1.getMonth()==d2.getMonth()&&d1.getDate()==d2.getDate()}function parseDate(val){if(val!==undefined){if(val.constructor==Date)return val;if("string"==typeof val){var els=val.split("-");if(3==els.length)return new Date(integer(els[0]),integer(els[1])-1,integer(els[2]));if(!/^-?\d+$/.test(val))return;val=integer(val)}var date=new Date;return date.setDate(date.getDate()+val),date}}function Dateinput(input,conf){function select(date,conf,e){return input.attr("readonly")?void self.hide(e):(value=date,currYear=date.getFullYear(),currMonth=date.getMonth(),currDay=date.getDate(),e||(e=$.Event("api")),"click"!=e.type||/msie/.test(navigator.userAgent.toLowerCase())||input.focus(),e.type="beforeChange",fire.trigger(e,[date]),void(e.isDefaultPrevented()||(input.val(format(conf.formatter,date,conf.format,conf.lang)),e.type="change",e.target=input[0],fire.trigger(e),input.data("date",date),self.hide(e))))}function onShow(ev){ev.type="onShow",fire.trigger(ev),$(document).on("keydown.d",function(e){if(e.ctrlKey)return!0;var key=e.keyCode;if(8==key||46==key)return input.val(""),self.hide(e);if(27==key||9==key)return self.hide(e);if($(KEYS).index(key)>=0){if(!opened)return self.show(e),e.preventDefault();var days=$("#"+css.weeks+" a"),el=$("."+css.focus),index=days.index(el);return el.removeClass(css.focus),74==key||40==key?index+=7:75==key||38==key?index-=7:76==key||39==key?index+=1:72!=key&&37!=key||(index-=1),index>41?(self.addMonth(),el=$("#"+css.weeks+" a:eq("+(index-42)+")")):index<0?(self.addMonth(-1),el=$("#"+css.weeks+" a:eq("+(index+42)+")")):el=days.eq(index),el.addClass(css.focus),e.preventDefault()}return 34==key?self.addMonth():33==key?self.addMonth(-1):36==key?self.today():(13==key&&($(e.target).is("select")||$("."+css.focus).click()),$([16,17,18,9]).index(key)>=0)}),$(document).on("click.d",function(e){var el=e.target;el.id==css.root||$(el).parents("#"+css.root).length||el==input[0]||trigger&&el==trigger[0]||self.hide(e)})}var trigger,pm,nm,currYear,currMonth,currDay,opened,original,self=this,now=new Date,yearNow=now.getFullYear(),css=conf.css,labels=LABELS[conf.lang],root=$("#"+css.root),title=root.find("#"+css.title),value=input.attr("data-value")||conf.value||input.val(),min=input.attr("min")||conf.min,max=input.attr("max")||conf.max;if(0===min&&(min="0"),value=parseDate(value)||now,min=parseDate(min||new Date(yearNow+conf.yearRange[0],0,1)),max=parseDate(max||new Date(yearNow+conf.yearRange[1]+1,0,0)),!labels)throw"Dateinput: invalid language: "+conf.lang;if("date"==input.attr("type")){var original=input.clone(),def=original.wrap("<div/>").parent().html(),clone=$(def.replace(/type/i,"type=text data-orig-type"));conf.value&&clone.val(conf.value),input.replaceWith(clone),input=clone}input.addClass(css.input);var fire=input.add(self);if(!root.length){if(root=$("<div><div><a/><div/><a/></div><div><div/><div/></div></div>").hide().css({position:"absolute"}).attr("id",css.root),root.children().eq(0).attr("id",css.head).end().eq(1).attr("id",css.body).children().eq(0).attr("id",css.days).end().eq(1).attr("id",css.weeks).end().end().end().find("a").eq(0).attr("id",css.prev).end().eq(1).attr("id",css.next),title=root.find("#"+css.head).find("div").attr("id",css.title),conf.selectors){var monthSelector=$("<select/>").attr("id",css.month),yearSelector=$("<select/>").attr("id",css.year);title.html(monthSelector.add(yearSelector))}for(var days=root.find("#"+css.days),d=0;d<7;d++)days.append($("<span/>").text(labels.shortDays[(d+conf.firstDay)%7]));$("body").append(root)}conf.trigger&&(trigger=$("<a/>").attr("href","#").addClass(css.trigger).click(function(e){return conf.toggle?self.toggle():self.show(),e.preventDefault()}).insertAfter(input));var weeks=root.find("#"+css.weeks);yearSelector=root.find("#"+css.year),monthSelector=root.find("#"+css.month),$.extend(self,{show:function(e){if(!input.attr("disabled")&&!opened&&(e=e||$.Event(),e.type="onBeforeShow",fire.trigger(e),!e.isDefaultPrevented())){$.each(instances,function(){this.hide()}),opened=!0,monthSelector.off("change").change(function(){self.setValue(integer(yearSelector.val()),integer($(this).val()))}),yearSelector.off("change").change(function(){self.setValue(integer($(this).val()),integer(monthSelector.val()))}),pm=root.find("#"+css.prev).off("click").click(function(e){return pm.hasClass(css.disabled)||self.addMonth(-1),!1}),nm=root.find("#"+css.next).off("click").click(function(e){return nm.hasClass(css.disabled)||self.addMonth(),!1}),self.setValue(value);var pos=input.offset();return/iPad/i.test(navigator.userAgent)&&(pos.top-=$(window).scrollTop()),root.css({top:pos.top+input.outerHeight(!0)+conf.offset[0],left:pos.left+conf.offset[1]}),conf.speed?root.show(conf.speed,function(){onShow(e)}):(root.show(),onShow(e)),self}},setValue:function(year,month,day){var date=integer(month)>=-1?new Date(integer(year),integer(month),integer(day==undefined||isNaN(day)?1:day)):year||value;if(date<min?date=min:date>max&&(date=max),"string"==typeof year&&(date=parseDate(year)),year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),month==-1?(month=11,year--):12==month&&(month=0,year++),!opened)return select(date,conf),self;currMonth=month,currYear=year,currDay=day;var week,tmp=new Date(year,month,1-conf.firstDay),begin=tmp.getDay(),days=dayAm(year,month),prevDays=dayAm(year,month-1);if(conf.selectors){monthSelector.empty(),$.each(labels.months,function(i,m){min<new Date(year,i+1,1)&&max>new Date(year,i,0)&&monthSelector.append($("<option/>").html(m).attr("value",i))}),yearSelector.empty();for(var yearNow=now.getFullYear(),i=yearNow+conf.yearRange[0];i<yearNow+conf.yearRange[1];i++)min<new Date(i+1,0,1)&&max>new Date(i,0,0)&&yearSelector.append($("<option/>").text(i));monthSelector.val(month),yearSelector.val(year)}else title.html(labels.months[month]+" "+year);weeks.empty(),pm.add(nm).removeClass(css.disabled);for(var a,num,j=begin?0:-7;j<(begin?42:35);j++)a=$("<a/>"),j%7===0&&(week=$("<div/>").addClass(css.week),weeks.append(week)),j<begin?(a.addClass(css.off),num=prevDays-begin+j+1,date=new Date(year,month-1,num)):j>=begin+days?(a.addClass(css.off),num=j-days-begin+1,date=new Date(year,month+1,num)):(num=j-begin+1,date=new Date(year,month,num),isSameDay(value,date)?a.attr("id",css.current).addClass(css.focus):isSameDay(now,date)&&a.attr("id",css.today)),min&&date<min&&a.add(pm).addClass(css.disabled),max&&date>max&&a.add(nm).addClass(css.disabled),a.attr("href","#"+num).text(num).data("date",date),week.append(a);return weeks.find("a").click(function(e){var el=$(this);return el.hasClass(css.disabled)||($("#"+css.current).removeAttr("id"),el.attr("id",css.current),select(el.data("date"),conf,e)),!1}),css.sunday&&weeks.find("."+css.week).each(function(){var beg=conf.firstDay?7-conf.firstDay:0;$(this).children().slice(beg,beg+1).addClass(css.sunday)}),self},setMin:function(val,fit){return min=parseDate(val),fit&&value<min&&self.setValue(min),self},setMax:function(val,fit){return max=parseDate(val),fit&&value>max&&self.setValue(max),self},today:function(){return self.setValue(now)},addDay:function(amount){return this.setValue(currYear,currMonth,currDay+(amount||1))},addMonth:function(amount){var targetMonth=currMonth+(amount||1),daysInTargetMonth=dayAm(currYear,targetMonth),targetDay=currDay<=daysInTargetMonth?currDay:daysInTargetMonth;return this.setValue(currYear,targetMonth,targetDay)},addYear:function(amount){return this.setValue(currYear+(amount||1),currMonth,currDay)},destroy:function(){input.add(document).off("click.d keydown.d"),root.add(trigger).remove(),input.removeData("dateinput").removeClass(css.input),original&&input.replaceWith(original)},hide:function(e){if(opened){if(e=$.Event(),e.type="onHide",fire.trigger(e),e.isDefaultPrevented())return;$(document).off("click.d keydown.d"),root.hide(),opened=!1}return self},toggle:function(){return self.isOpen()?self.hide():self.show()},getConf:function(){return conf},getInput:function(){return input},getCalendar:function(){return root},getValue:function(dateFormat){return dateFormat?format(conf.formatter,value,dateFormat,conf.lang):value},isOpen:function(){return opened}}),$.each(["onBeforeShow","onShow","change","onHide"],function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.editable||input.on("focus.d click.d",self.show).keydown(function(e){var key=e.keyCode;return!opened&&$(KEYS).index(key)>=0?(self.show(e),e.preventDefault()):(8!=key&&46!=key||input.val(""),!!(e.shiftKey||e.ctrlKey||e.altKey||9==key)||e.preventDefault())}),parseDate(input.val())&&select(value,conf)}$.tools=$.tools||{version:"@VERSION"};var tool,instances=[],formatters={},KEYS=[75,76,38,39,74,72,40,37],LABELS={};tool=$.tools.dateinput={conf:{format:"mm/dd/yy",formatter:"default",selectors:!1,yearRange:[-5,5],lang:"en",offset:[0,0],speed:0,firstDay:0,min:undefined,max:undefined,trigger:0,toggle:0,editable:0,css:{prefix:"cal",input:"date",root:0,head:0,title:0,prev:0,next:0,month:0,year:0,days:0,body:0,weeks:0,today:0,current:0,week:0,off:0,sunday:0,focus:0,disabled:0,trigger:0}},addFormatter:function(name,fn){formatters[name]=fn},localize:function(language,labels){$.each(labels,function(key,val){labels[key]=val.split(",")}),LABELS[language]=labels}},tool.localize("en",{months:"January,February,March,April,May,June,July,August,September,October,November,December",shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",days:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat"});var tmpTag=$("<a/>");tool.addFormatter("default",function(text,date,flags,lang){return text.replace(/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g,function($0){return $0 in flags?flags[$0]:$0})}),tool.addFormatter("prefixed",function(text,date,flags,lang){return text.replace(/%(d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*')/g,function($0,$1){return $1 in flags?flags[$1]:$0})}),$.expr[":"].date=function(el){var type=el.getAttribute("type");return type&&"date"==type||!!$(el).data("dateinput")},$.fn.dateinput=function(conf){if(this.data("dateinput"))return this;conf=$.extend(!0,{},tool.conf,conf),$.each(conf.css,function(key,val){val||"prefix"==key||(conf.css[key]=(conf.css.prefix||"")+(val||key))});var els;return this.each(function(){var el=new Dateinput($(this),conf);instances.push(el);var input=el.getInput().data("dateinput",el);els=els?els.add(input):input}),els?els:this}}(jQuery);
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.min.js b/plone/app/jquerytools/browser/jquery.tools.min.js
index b1d3242..7e5d60b 100644
--- a/plone/app/jquerytools/browser/jquery.tools.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.min.js
@@ -1 +1 @@
-!function($){function Overlay(trigger,conf){var closers,overlay,opened,self=this,fire=trigger.add(self),w=$(window),maskConf=$.tools.expose&&(conf.mask||conf.expose),uid=Math.random().toString().slice(10);maskConf&&("string"==typeof maskConf&&(maskConf={color:maskConf}),maskConf.closeOnClick=maskConf.closeOnEsc=!1);var jq=conf.target||trigger.attr("rel");if(overlay=jq?$(jq):null||trigger,!overlay.length)throw"Could not find Overlay: "+jq;trigger&&-1==trigger.index(overlay)&&trigger.click(function(e){return self.load(e),e.preventDefault()}),$.extend(self,{load:function(e){if(self.isOpened())return self;var eff=effects[conf.effect];if(!eff)throw'Overlay: cannot find effect : "'+conf.effect+'"';if(conf.oneInstance&&$.each(instances,function(){this.close(e)}),e=e||$.Event(),e.type="onBeforeLoad",fire.trigger(e),e.isDefaultPrevented())return self;opened=!0,maskConf&&$(overlay).expose(maskConf);var top=conf.top,left=conf.left,oWidth=overlay.outerWidth(!0),oHeight=overlay.outerHeight(!0);return"string"==typeof top&&(top="center"==top?Math.max((w.height()-oHeight)/2,0):parseInt(top,10)/100*w.height()),"center"==left&&(left=Math.max((w.width()-oWidth)/2,0)),eff[0].call(self,{top:top,left:left},function(){opened&&(e.type="onLoad",fire.trigger(e))}),maskConf&&conf.closeOnClick&&$.mask.getMask().one("click",self.close),conf.closeOnClick&&$(document).on("click."+uid,function(e){$(e.target).parents(overlay).length||self.close(e)}),conf.closeOnEsc&&$(document).on("keydown."+uid,function(e){27==e.keyCode&&self.close(e)}),self},close:function(e){return self.isOpened()?(e=e||$.Event(),e.type="onBeforeClose",fire.trigger(e),e.isDefaultPrevented()?void 0:(opened=!1,effects[conf.effect][1].call(self,function(){e.type="onClose",fire.trigger(e)}),$(document).off("click."+uid+" keydown."+uid),maskConf&&$.mask.close(),self)):self},getOverlay:function(){return overlay},getTrigger:function(){return trigger},getClosers:function(){return closers},isOpened:function(){return opened},getConf:function(){return conf}}),$.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),closers=overlay.find(conf.close||".close"),closers.length||conf.close||(closers=$('<a class="close"></a>'),overlay.prepend(closers)),closers.click(function(e){self.close(e)}),conf.load&&self.load()}$.tools=$.tools||{version:"@VERSION"},$.tools.overlay={addEffect:function(name,loadFn,closeFn){effects[name]=[loadFn,closeFn]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!/msie/.test(navigator.userAgent.toLowerCase())||navigator.appVersion>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var instances=[],effects={};$.tools.overlay.addEffect("default",function(pos,onLoad){var conf=this.getConf(),w=$(window);conf.fixed||(pos.top+=w.scrollTop(),pos.left+=w.scrollLeft()),pos.position=conf.fixed?"fixed":"absolute",this.getOverlay().css(pos).fadeIn(conf.speed,onLoad)},function(onClose){this.getOverlay().fadeOut(this.getConf().closeSpeed,onClose)}),$.fn.overlay=function(conf){var el=this.data("overlay");return el?el:($.isFunction(conf)&&(conf={onBeforeLoad:conf}),conf=$.extend(!0,{},$.tools.overlay.conf,conf),this.each(function(){el=new Overlay($(this),conf),instances.push(el),$(this).data("overlay",el)}),conf.api?el:this)}}(jQuery),function($){function find(root,query){var el=$(query);return el.length<2?el:root.parent().find(query)}function Scrollable(root,conf){var self=this,fire=root.add(self),itemWrap=root.children(),index=0,vertical=conf.vertical;if(current||(current=self),itemWrap.length>1&&(itemWrap=$(conf.items,root)),conf.size>1&&(conf.circular=!1),$.extend(self,{getConf:function(){return conf},getIndex:function(){return index},getSize:function(){return self.getItems().size()},getNaviButtons:function(){return prev.add(next)},getRoot:function(){return root},getItemWrap:function(){return itemWrap},getItems:function(){return itemWrap.find(conf.item).not("."+conf.clonedClass)},move:function(offset,time){return self.seekTo(index+offset,time)},next:function(time){return self.move(conf.size,time)},prev:function(time){return self.move(-conf.size,time)},begin:function(time){return self.seekTo(0,time)},end:function(time){return self.seekTo(self.getSize()-1,time)},focus:function(){return current=self,self},addItem:function(item){return item=$(item),conf.circular?(itemWrap.children().last().before(item),itemWrap.children().first().replaceWith(item.clone().addClass(conf.clonedClass))):(itemWrap.append(item),next.removeClass("disabled")),fire.trigger("onAddItem",[item]),self},seekTo:function(i,time,fn){if(i.jquery||(i*=1),conf.circular&&0===i&&-1==index&&0!==time)return self;if(!conf.circular&&0>i||i>self.getSize()||-1>i)return self;var item=i;i.jquery?i=self.getItems().index(i):item=self.getItems().eq(i);var e=$.Event("onBeforeSeek");if(!fn&&(fire.trigger(e,[i,time]),e.isDefaultPrevented()||!item.length))return self;var props=vertical?{top:-item.position().top}:{left:-item.position().left};return index=i,current=self,void 0===time&&(time=conf.speed),itemWrap.animate(props,time,conf.easing,fn||function(){fire.trigger("onSeek",[i])}),self}}),$.each(["onBeforeSeek","onSeek","onAddItem"],function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.circular){var cloned1=self.getItems().slice(-1).clone().prependTo(itemWrap),cloned2=self.getItems().eq(1).clone().appendTo(itemWrap);cloned1.add(cloned2).addClass(conf.clonedClass),self.onBeforeSeek(function(e,i,time){return e.isDefaultPrevented()?void 0:-1==i?(self.seekTo(cloned1,time,function(){self.end(0)}),e.preventDefault()):void(i==self.getSize()&&self.seekTo(cloned2,time,function(){self.begin(0)}))});var hidden_parents=root.parents().add(root).filter(function(){return"none"===$(this).css("display")?!0:void 0});hidden_parents.length?(hidden_parents.show(),self.seekTo(0,0,function(){}),hidden_parents.hide()):self.seekTo(0,0,function(){})}var prev=find(root,conf.prev).click(function(e){e.stopPropagation(),self.prev()}),next=find(root,conf.next).click(function(e){e.stopPropagation(),self.next()});if(conf.circular||(self.onBeforeSeek(function(e,i){setTimeout(function(){e.isDefaultPrevented()||(prev.toggleClass(conf.disabledClass,0>=i),next.toggleClass(conf.disabledClass,i>=self.getSize()-1))},1)}),conf.initialIndex||prev.addClass(conf.disabledClass)),self.getSize()<2&&prev.add(next).addClass(conf.disabledClass),conf.mousewheel&&$.fn.mousewheel&&root.mousewheel(function(e,delta){return conf.mousewheel?(self.move(0>delta?1:-1,conf.wheelSpeed||50),!1):void 0}),conf.touch){var touch={};itemWrap[0].ontouchstart=function(e){var t=e.touches[0];touch.x=t.clientX,touch.y=t.clientY},itemWrap[0].ontouchmove=function(e){if(1==e.touches.length&&!itemWrap.is(":animated")){var t=e.touches[0],deltaX=touch.x-t.clientX,deltaY=touch.y-t.clientY;self[vertical&&deltaY>0||!vertical&&deltaX>0?"next":"prev"](),e.preventDefault()}}}conf.keyboard&&$(document).on("keydown.scrollable",function(evt){if(!(!conf.keyboard||evt.altKey||evt.ctrlKey||evt.metaKey||$(evt.target).is(":input")||"static"!=conf.keyboard&&current!=self)){var key=evt.keyCode;return!vertical||38!=key&&40!=key?vertical||37!=key&&39!=key?void 0:(self.move(37==key?-1:1),evt.preventDefault()):(self.move(38==key?-1:1),evt.preventDefault())}}),conf.initialIndex&&self.seekTo(conf.initialIndex,0,function(){})}$.tools=$.tools||{version:"@VERSION"},$.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}};var current;$.fn.scrollable=function(conf){var el=this.data("scrollable");return el?el:(conf=$.extend({},$.tools.scrollable.conf,conf),this.each(function(){el=new Scrollable($(this),conf),$(this).data("scrollable",el)}),conf.api?el:this)}}(jQuery),function($){function Tabs(root,paneSelector,conf){var current,self=this,trigger=root.add(this),tabs=root.find(conf.tabs),panes=paneSelector.jquery?paneSelector:root.children(paneSelector);tabs.length||(tabs=root.children()),panes.length||(panes=root.parent().find(paneSelector)),panes.length||(panes=$(paneSelector)),$.extend(this,{click:function(i,e){var tab=tabs.eq(i),firstRender=!root.data("tabs");if("string"==typeof i&&i.replace("#","")&&(tab=tabs.filter('[href*="'+i.replace("#","")+'"]'),i=Math.max(tabs.index(tab),0)),conf.rotate){var last=tabs.length-1;if(0>i)return self.click(last,e);if(i>last)return self.click(0,e)}if(!tab.length){if(current>=0)return self;i=conf.initialIndex,tab=tabs.eq(i)}if(i===current)return self;if(e=e||$.Event(),e.type="onBeforeClick",trigger.trigger(e,[i]),!e.isDefaultPrevented()){var effect=firstRender?conf.initialEffect&&conf.effect||"default":conf.effect;return effects[effect].call(self,i,function(){current=i,e.type="onClick",trigger.trigger(e,[i])}),tabs.removeClass(conf.current),tab.addClass(conf.current),self}},getConf:function(){return conf},getTabs:function(){return tabs},getPanes:function(){return panes},getCurrentPane:function(){return panes.eq(current)},getCurrentTab:function(){return tabs.eq(current)},getIndex:function(){return current},next:function(){return self.click(current+1)},prev:function(){return self.click(current-1)},destroy:function(){return tabs.off(conf.event).removeClass(conf.current),panes.find('a[href^="#"]').off("click.T"),self}}),$.each("onBeforeClick,onClick".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.history&&$.fn.history&&($.tools.history.init(tabs),conf.event="history"),tabs.each(function(i){$(this).on(conf.event,function(e){return self.click(i,e),e.preventDefault()})}),panes.find('a[href^="#"]').on("click.T",function(e){self.click($(this).attr("href"),e)}),location.hash&&"a"==conf.tabs&&root.find('[href="'+location.hash+'"]').length?self.click(location.hash):(0===conf.initialIndex||conf.initialIndex>0)&&self.click(conf.initialIndex)}$.tools=$.tools||{version:"@VERSION"},$.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialEffect:!1,initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(name,fn){effects[name]=fn}};var animating,w,effects={"default":function(i,done){this.getPanes().hide().eq(i).show(),done.call()},fade:function(i,done){var conf=this.getConf(),speed=conf.fadeOutSpeed,panes=this.getPanes();speed?panes.fadeOut(speed):panes.hide(),panes.eq(i).fadeIn(conf.fadeInSpeed,done)},slide:function(i,done){var conf=this.getConf();this.getPanes().slideUp(conf.slideUpSpeed),this.getPanes().eq(i).slideDown(conf.slideDownSpeed,done)},ajax:function(i,done){this.getPanes().eq(0).load(this.getTabs().eq(i).attr("href"),done)}};$.tools.tabs.addEffect("horizontal",function(i,done){if(!animating){var nextPane=this.getPanes().eq(i),currentPane=this.getCurrentPane();w||(w=this.getPanes().eq(0).width()),animating=!0,nextPane.show(),currentPane.animate({width:0},{step:function(now){nextPane.css("width",w-now)},complete:function(){$(this).hide(),done.call(),animating=!1}}),currentPane.length||(done.call(),animating=!1)}}),$.fn.tabs=function(paneSelector,conf){var el=this.data("tabs");return el&&(el.destroy(),this.removeData("tabs")),$.isFunction(conf)&&(conf={onBeforeClick:conf}),conf=$.extend({},$.tools.tabs.conf,conf),this.each(function(){el=new Tabs($(this),paneSelector,conf),$(this).data("tabs",el)}),conf.api?el:this}}(jQuery),function($){function setIframeLocation(h){if(h){var doc=iframe.contentWindow.document;doc.open().close(),doc.location.hash=h}}var hash,iframe,links,inited;$.tools=$.tools||{version:"@VERSION"},$.tools.history={init:function(els){inited||($.browser.msie&&$.browser.version<"8"?iframe||(iframe=$("<iframe/>").attr("src","javascript:false;").hide().get(0),$("body").append(iframe),setInterval(function(){var idoc=iframe.contentWindow.document,h=idoc.location.hash;hash!==h&&$(window).trigger("hash",h)},100),setIframeLocation(location.hash||"#")):setInterval(function(){var h=location.hash;h!==hash&&$(window).trigger("hash",h)},100),links=links?links.add(els):els,els.click(function(e){var href=$(this).attr("href");return iframe&&setIframeLocation(href),"#"!=href.slice(0,1)?(location.href="#"+href,e.preventDefault()):void 0}),inited=!0)}},$(window).on("hash",function(e,h){h?links.filter(function(){var href=$(this).attr("href");return href==h||href==h.replace("#","")}).trigger("history",[h]):links.eq(0).trigger("history",[h]),hash=h}),$.fn.history=function(fn){return $.tools.history.init(this),this.on("history",fn)}}(jQuery),function($){function viewport(){if(/msie/.test(navigator.userAgent.toLowerCase())){var d=$(document).height(),w=$(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,20>d-w?w:d]}return[$(document).width(),$(document).height()]}function call(fn){return fn?fn.call($.mask):void 0}$.tools=$.tools||{version:"@VERSION"};var tool;tool=$.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};var mask,exposed,loaded,config,overlayIndex;$.mask={load:function(conf,els){if(loaded)return this;"string"==typeof conf&&(conf={color:conf}),conf=conf||config,config=conf=$.extend($.extend({},tool.conf),conf),mask=$("#"+conf.maskId),mask.length||(mask=$("<div/>").attr("id",conf.maskId),$("body").append(mask));var size=viewport();return mask.css({position:"absolute",top:0,left:0,width:size[0],height:size[1],display:"none",opacity:conf.startOpacity,zIndex:conf.zIndex}),conf.color&&mask.css("backgroundColor",conf.color),call(conf.onBeforeLoad)===!1?this:(conf.closeOnEsc&&$(document).on("keydown.mask",function(e){27==e.keyCode&&$.mask.close(e)}),conf.closeOnClick&&mask.on("click.mask",function(e){$.mask.close(e)}),$(window).on("resize.mask",function(){$.mask.fit()}),els&&els.length&&(overlayIndex=els.eq(0).css("zIndex"),$.each(els,function(){var el=$(this);/relative|absolute|fixed/i.test(el.css("position"))||el.css("position","relative")}),exposed=els.css({zIndex:Math.max(conf.zIndex+1,"auto"==overlayIndex?0:overlayIndex)})),mask.css({display:"block"}).fadeTo(conf.loadSpeed,conf.opacity,function(){$.mask.fit(),call(conf.onLoad),loaded="full"}),loaded=!0,this)},close:function(){if(loaded){if(call(config.onBeforeClose)===!1)return this;mask.fadeOut(config.closeSpeed,function(){exposed&&exposed.css({zIndex:overlayIndex}),loaded=!1,call(config.onClose)}),$(document).off("keydown.mask"),mask.off("click.mask"),$(window).off("resize.mask")}return this},fit:function(){if(loaded){var size=viewport();mask.css({width:size[0],height:size[1]})}},getMask:function(){return mask},isLoaded:function(fully){return fully?"full"==loaded:loaded},getConf:function(){return config},getExposed:function(){return exposed}},$.fn.mask=function(conf){return $.mask.load(conf),this},$.fn.expose=function(conf){return $.mask.load(conf,this),this}}(jQuery);
\ No newline at end of file
+!function($){function Overlay(trigger,conf){var closers,overlay,opened,self=this,fire=trigger.add(self),w=$(window),maskConf=$.tools.expose&&(conf.mask||conf.expose),uid=Math.random().toString().slice(10);maskConf&&("string"==typeof maskConf&&(maskConf={color:maskConf}),maskConf.closeOnClick=maskConf.closeOnEsc=!1);var jq=conf.target||trigger.attr("rel");if(overlay=jq?$(jq):trigger,!overlay.length)throw"Could not find Overlay: "+jq;trigger&&trigger.index(overlay)==-1&&trigger.click(function(e){return self.load(e),e.preventDefault()}),$.extend(self,{load:function(e){if(self.isOpened())return self;var eff=effects[conf.effect];if(!eff)throw'Overlay: cannot find effect : "'+conf.effect+'"';if(conf.oneInstance&&$.each(instances,function(){this.close(e)}),e=e||$.Event(),e.type="onBeforeLoad",fire.trigger(e),e.isDefaultPrevented())return self;opened=!0,maskConf&&$(overlay).expose(maskConf);var top=conf.top,left=conf.left,oWidth=overlay.outerWidth(!0),oHeight=overlay.outerHeight(!0);return"string"==typeof top&&(top="center"==top?Math.max((w.height()-oHeight)/2,0):parseInt(top,10)/100*w.height()),"center"==left&&(left=Math.max((w.width()-oWidth)/2,0)),eff[0].call(self,{top:top,left:left},function(){opened&&(e.type="onLoad",fire.trigger(e))}),maskConf&&conf.closeOnClick&&$.mask.getMask().one("click",self.close),conf.closeOnClick&&$(document).on("click."+uid,function(e){$(e.target).parents(overlay).length||self.close(e)}),conf.closeOnEsc&&$(document).on("keydown."+uid,function(e){27==e.keyCode&&self.close(e)}),self},close:function(e){return self.isOpened()?(e=e||$.Event(),e.type="onBeforeClose",fire.trigger(e),e.isDefaultPrevented()?void 0:(opened=!1,effects[conf.effect][1].call(self,function(){e.type="onClose",fire.trigger(e)}),$(document).off("click."+uid+" keydown."+uid),maskConf&&$.mask.close(),self)):self},getOverlay:function(){return overlay},getTrigger:function(){return trigger},getClosers:function(){return closers},isOpened:function(){return opened},getConf:function(){return conf}}),$.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),closers=overlay.find(conf.close||".close"),closers.length||conf.close||(closers=$('<a class="close"></a>'),overlay.prepend(closers)),closers.click(function(e){self.close(e)}),conf.load&&self.load()}$.tools=$.tools||{version:"@VERSION"},$.tools.overlay={addEffect:function(name,loadFn,closeFn){effects[name]=[loadFn,closeFn]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!/msie/.test(navigator.userAgent.toLowerCase())||navigator.appVersion>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var instances=[],effects={};$.tools.overlay.addEffect("default",function(pos,onLoad){var conf=this.getConf(),w=$(window);conf.fixed||(pos.top+=w.scrollTop(),pos.left+=w.scrollLeft()),pos.position=conf.fixed?"fixed":"absolute",this.getOverlay().css(pos).fadeIn(conf.speed,onLoad)},function(onClose){this.getOverlay().fadeOut(this.getConf().closeSpeed,onClose)}),$.fn.overlay=function(conf){var el=this.data("overlay");return el?el:($.isFunction(conf)&&(conf={onBeforeLoad:conf}),conf=$.extend(!0,{},$.tools.overlay.conf,conf),this.each(function(){el=new Overlay($(this),conf),instances.push(el),$(this).data("overlay",el)}),conf.api?el:this)}}(jQuery),function($){function find(root,query){var el=$(query);return el.length<2?el:root.parent().find(query)}function Scrollable(root,conf){var self=this,fire=root.add(self),itemWrap=root.children(),index=0,vertical=conf.vertical;if(current||(current=self),itemWrap.length>1&&(itemWrap=$(conf.items,root)),conf.size>1&&(conf.circular=!1),$.extend(self,{getConf:function(){return conf},getIndex:function(){return index},getSize:function(){return self.getItems().size()},getNaviButtons:function(){return prev.add(next)},getRoot:function(){return root},getItemWrap:function(){return itemWrap},getItems:function(){return itemWrap.find(conf.item).not("."+conf.clonedClass)},move:function(offset,time){return self.seekTo(index+offset,time)},next:function(time){return self.move(conf.size,time)},prev:function(time){return self.move(-conf.size,time)},begin:function(time){return self.seekTo(0,time)},end:function(time){return self.seekTo(self.getSize()-1,time)},focus:function(){return current=self,self},addItem:function(item){return item=$(item),conf.circular?(itemWrap.children().last().before(item),itemWrap.children().first().replaceWith(item.clone().addClass(conf.clonedClass))):(itemWrap.append(item),next.removeClass("disabled")),fire.trigger("onAddItem",[item]),self},seekTo:function(i,time,fn){if(i.jquery||(i*=1),conf.circular&&0===i&&index==-1&&0!==time)return self;if(!conf.circular&&i<0||i>self.getSize()||i<-1)return self;var item=i;i.jquery?i=self.getItems().index(i):item=self.getItems().eq(i);var e=$.Event("onBeforeSeek");if(!fn&&(fire.trigger(e,[i,time]),e.isDefaultPrevented()||!item.length))return self;var props=vertical?{top:-item.position().top}:{left:-item.position().left};return index=i,current=self,void 0===time&&(time=conf.speed),itemWrap.animate(props,time,conf.easing,fn||function(){fire.trigger("onSeek",[i])}),self}}),$.each(["onBeforeSeek","onSeek","onAddItem"],function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.circular){var cloned1=self.getItems().slice(-1).clone().prependTo(itemWrap),cloned2=self.getItems().eq(1).clone().appendTo(itemWrap);cloned1.add(cloned2).addClass(conf.clonedClass),self.onBeforeSeek(function(e,i,time){if(!e.isDefaultPrevented())return i==-1?(self.seekTo(cloned1,time,function(){self.end(0)}),e.preventDefault()):void(i==self.getSize()&&self.seekTo(cloned2,time,function(){self.begin(0)}))});var hidden_parents=root.parents().add(root).filter(function(){if("none"===$(this).css("display"))return!0});hidden_parents.length?(hidden_parents.show(),self.seekTo(0,0,function(){}),hidden_parents.hide()):self.seekTo(0,0,function(){})}var prev=find(root,conf.prev).click(function(e){e.stopPropagation(),self.prev()}),next=find(root,conf.next).click(function(e){e.stopPropagation(),self.next()});if(conf.circular||(self.onBeforeSeek(function(e,i){setTimeout(function(){e.isDefaultPrevented()||(prev.toggleClass(conf.disabledClass,i<=0),next.toggleClass(conf.disabledClass,i>=self.getSize()-1))},1)}),conf.initialIndex||prev.addClass(conf.disabledClass)),self.getSize()<2&&prev.add(next).addClass(conf.disabledClass),conf.mousewheel&&$.fn.mousewheel&&root.mousewheel(function(e,delta){if(conf.mousewheel)return self.move(delta<0?1:-1,conf.wheelSpeed||50),!1}),conf.touch){var touch={};itemWrap[0].ontouchstart=function(e){var t=e.touches[0];touch.x=t.clientX,touch.y=t.clientY},itemWrap[0].ontouchmove=function(e){if(1==e.touches.length&&!itemWrap.is(":animated")){var t=e.touches[0],deltaX=touch.x-t.clientX,deltaY=touch.y-t.clientY;self[vertical&&deltaY>0||!vertical&&deltaX>0?"next":"prev"](),e.preventDefault()}}}conf.keyboard&&$(document).on("keydown.scrollable",function(evt){if(!(!conf.keyboard||evt.altKey||evt.ctrlKey||evt.metaKey||$(evt.target).is(":input")||"static"!=conf.keyboard&&current!=self)){var key=evt.keyCode;return!vertical||38!=key&&40!=key?vertical||37!=key&&39!=key?void 0:(self.move(37==key?-1:1),evt.preventDefault()):(self.move(38==key?-1:1),evt.preventDefault())}}),conf.initialIndex&&self.seekTo(conf.initialIndex,0,function(){})}$.tools=$.tools||{version:"@VERSION"},$.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}};var current;$.fn.scrollable=function(conf){var el=this.data("scrollable");return el?el:(conf=$.extend({},$.tools.scrollable.conf,conf),this.each(function(){el=new Scrollable($(this),conf),$(this).data("scrollable",el)}),conf.api?el:this)}}(jQuery),function($){function Tabs(root,paneSelector,conf){var current,self=this,trigger=root.add(this),tabs=root.find(conf.tabs),panes=paneSelector.jquery?paneSelector:root.children(paneSelector);tabs.length||(tabs=root.children()),panes.length||(panes=root.parent().find(paneSelector)),panes.length||(panes=$(paneSelector)),$.extend(this,{click:function(i,e){var tab=tabs.eq(i),firstRender=!root.data("tabs");if("string"==typeof i&&i.replace("#","")&&(tab=tabs.filter('[href*="'+i.replace("#","")+'"]'),i=Math.max(tabs.index(tab),0)),conf.rotate){var last=tabs.length-1;if(i<0)return self.click(last,e);if(i>last)return self.click(0,e)}if(!tab.length){if(current>=0)return self;i=conf.initialIndex,tab=tabs.eq(i)}if(i===current)return self;if(e=e||$.Event(),e.type="onBeforeClick",trigger.trigger(e,[i]),!e.isDefaultPrevented()){var effect=firstRender?conf.initialEffect&&conf.effect||"default":conf.effect;return effects[effect].call(self,i,function(){current=i,e.type="onClick",trigger.trigger(e,[i])}),tabs.removeClass(conf.current),tab.addClass(conf.current),self}},getConf:function(){return conf},getTabs:function(){return tabs},getPanes:function(){return panes},getCurrentPane:function(){return panes.eq(current)},getCurrentTab:function(){return tabs.eq(current)},getIndex:function(){return current},next:function(){return self.click(current+1)},prev:function(){return self.click(current-1)},destroy:function(){return tabs.off(conf.event).removeClass(conf.current),panes.find('a[href^="#"]').off("click.T"),self}}),$.each("onBeforeClick,onClick".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.history&&$.fn.history&&($.tools.history.init(tabs),conf.event="history"),tabs.each(function(i){$(this).on(conf.event,function(e){return self.click(i,e),e.preventDefault()})}),panes.find('a[href^="#"]').on("click.T",function(e){self.click($(this).attr("href"),e)}),location.hash&&"a"==conf.tabs&&root.find('[href="'+location.hash+'"]').length?self.click(location.hash):(0===conf.initialIndex||conf.initialIndex>0)&&self.click(conf.initialIndex)}$.tools=$.tools||{version:"@VERSION"},$.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialEffect:!1,initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(name,fn){effects[name]=fn}};var animating,w,effects={default:function(i,done){this.getPanes().hide().eq(i).show(),done.call()},fade:function(i,done){var conf=this.getConf(),speed=conf.fadeOutSpeed,panes=this.getPanes();speed?panes.fadeOut(speed):panes.hide(),panes.eq(i).fadeIn(conf.fadeInSpeed,done)},slide:function(i,done){var conf=this.getConf();this.getPanes().slideUp(conf.slideUpSpeed),this.getPanes().eq(i).slideDown(conf.slideDownSpeed,done)},ajax:function(i,done){this.getPanes().eq(0).load(this.getTabs().eq(i).attr("href"),done)}};$.tools.tabs.addEffect("horizontal",function(i,done){if(!animating){var nextPane=this.getPanes().eq(i),currentPane=this.getCurrentPane();w||(w=this.getPanes().eq(0).width()),animating=!0,nextPane.show(),currentPane.animate({width:0},{step:function(now){nextPane.css("width",w-now)},complete:function(){$(this).hide(),done.call(),animating=!1}}),currentPane.length||(done.call(),animating=!1)}}),$.fn.tabs=function(paneSelector,conf){var el=this.data("tabs");return el&&(el.destroy(),this.removeData("tabs")),$.isFunction(conf)&&(conf={onBeforeClick:conf}),conf=$.extend({},$.tools.tabs.conf,conf),this.each(function(){el=new Tabs($(this),paneSelector,conf),$(this).data("tabs",el)}),conf.api?el:this}}(jQuery),function($){function setIframeLocation(h){if(h){var doc=iframe.contentWindow.document;doc.open().close(),doc.location.hash=h}}var hash,iframe,links,inited;$.tools=$.tools||{version:"@VERSION"},$.tools.history={init:function(els){inited||($.browser.msie&&$.browser.version<"8"?iframe||(iframe=$("<iframe/>").attr("src","javascript:false;").hide().get(0),$("body").append(iframe),setInterval(function(){var idoc=iframe.contentWindow.document,h=idoc.location.hash;hash!==h&&$(window).trigger("hash",h)},100),setIframeLocation(location.hash||"#")):setInterval(function(){var h=location.hash;h!==hash&&$(window).trigger("hash",h)},100),links=links?links.add(els):els,els.click(function(e){var href=$(this).attr("href");if(iframe&&setIframeLocation(href),"#"!=href.slice(0,1))return location.href="#"+href,e.preventDefault()}),inited=!0)}},$(window).on("hash",function(e,h){h?links.filter(function(){var href=$(this).attr("href");return href==h||href==h.replace("#","")}).trigger("history",[h]):links.eq(0).trigger("history",[h]),hash=h}),$.fn.history=function(fn){return $.tools.history.init(this),this.on("history",fn)}}(jQuery),function($){function viewport(){if(/msie/.test(navigator.userAgent.toLowerCase())){var d=$(document).height(),w=$(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d-w<20?w:d]}return[$(document).width(),$(document).height()]}function call(fn){if(fn)return fn.call($.mask)}$.tools=$.tools||{version:"@VERSION"};var tool;tool=$.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};var mask,exposed,loaded,config,overlayIndex;$.mask={load:function(conf,els){if(loaded)return this;"string"==typeof conf&&(conf={color:conf}),conf=conf||config,config=conf=$.extend($.extend({},tool.conf),conf),mask=$("#"+conf.maskId),mask.length||(mask=$("<div/>").attr("id",conf.maskId),$("body").append(mask));var size=viewport();return mask.css({position:"absolute",top:0,left:0,width:size[0],height:size[1],display:"none",opacity:conf.startOpacity,zIndex:conf.zIndex}),conf.color&&mask.css("backgroundColor",conf.color),call(conf.onBeforeLoad)===!1?this:(conf.closeOnEsc&&$(document).on("keydown.mask",function(e){27==e.keyCode&&$.mask.close(e)}),conf.closeOnClick&&mask.on("click.mask",function(e){$.mask.close(e)}),$(window).on("resize.mask",function(){$.mask.fit()}),els&&els.length&&(overlayIndex=els.eq(0).css("zIndex"),$.each(els,function(){var el=$(this);/relative|absolute|fixed/i.test(el.css("position"))||el.css("position","relative")}),exposed=els.css({zIndex:Math.max(conf.zIndex+1,"auto"==overlayIndex?0:overlayIndex)})),mask.css({display:"block"}).fadeTo(conf.loadSpeed,conf.opacity,function(){$.mask.fit(),call(conf.onLoad),loaded="full"}),loaded=!0,this)},close:function(){if(loaded){if(call(config.onBeforeClose)===!1)return this;mask.fadeOut(config.closeSpeed,function(){exposed&&exposed.css({zIndex:overlayIndex}),loaded=!1,call(config.onClose)}),$(document).off("keydown.mask"),mask.off("click.mask"),$(window).off("resize.mask")}return this},fit:function(){if(loaded){var size=viewport();mask.css({width:size[0],height:size[1]})}},getMask:function(){return mask},isLoaded:function(fully){return fully?"full"==loaded:loaded},getConf:function(){return config},getExposed:function(){return exposed}},$.fn.mask=function(conf){return $.mask.load(conf),this},$.fn.expose=function(conf){return $.mask.load(conf,this),this}}(jQuery);
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.plugins.min.js b/plone/app/jquerytools/browser/jquery.tools.plugins.min.js
index fb297fb..6308804 100644
--- a/plone/app/jquerytools/browser/jquery.tools.plugins.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.plugins.min.js
@@ -1 +1 @@
-!function($){function getPosition(el){var p=el.offset();return{top:p.top+el.height()/2,left:p.left+el.width()/2}}var t=$.tools.overlay,w=$(window);$.extend(t.conf,{start:{top:null,left:null},fadeInSpeed:"fast",zIndex:9999});var loadEffect=function(pos,onLoad){var overlay=this.getOverlay(),conf=this.getConf(),trigger=this.getTrigger(),self=this,oWidth=overlay.outerWidth(!0),img=overlay.data("img"),position=conf.fixed?"fixed":"absolute";if(!img){var bg=overlay.css("backgroundImage");if(!bg)throw"background-image CSS property not set for overlay";bg=bg.slice(bg.indexOf("(")+1,bg.indexOf(")")).replace(/\"/g,""),overlay.css("backgroundImage","none"),img=$('<img src="'+bg+'"/>'),img.css({border:0,display:"none"}).width(oWidth),$("body").append(img),overlay.data("img",img)}var itop=conf.start.top||Math.round(w.height()/2),ileft=conf.start.left||Math.round(w.width()/2);if(trigger){var p=getPosition(trigger);itop=p.top,ileft=p.left}conf.fixed?(itop-=w.scrollTop(),ileft-=w.scrollLeft()):(pos.top+=w.scrollTop(),pos.left+=w.scrollLeft()),img.css({position:"absolute",top:itop,left:ileft,width:0,zIndex:conf.zIndex}).show(),pos.position=position,overlay.css(pos),img.animate({top:pos.top,left:pos.left,width:oWidth},conf.speed,function(){overlay.css("zIndex",conf.zIndex+1).fadeIn(conf.fadeInSpeed,function(){self.isOpened()&&!$(this).index(overlay)?onLoad.call():overlay.hide()})}).css("position",position)},closeEffect=function(onClose){var overlay=this.getOverlay().hide(),conf=this.getConf(),trigger=this.getTrigger(),img=overlay.data("img"),css={top:conf.start.top,left:conf.start.left,width:0};trigger&&$.extend(css,getPosition(trigger)),conf.fixed&&img.css({position:"absolute"}).animate({top:"+="+w.scrollTop(),left:"+="+w.scrollLeft()},0),img.animate(css,conf.closeSpeed,onClose)};t.addEffect("apple",loadEffect,closeEffect)}(jQuery),function($){var t=$.tools.scrollable;t.autoscroll={conf:{autoplay:!0,interval:3e3,autopause:!0}},$.fn.autoscroll=function(conf){"number"==typeof conf&&(conf={interval:conf});var ret,opts=$.extend({},t.autoscroll.conf,conf);return this.each(function(){function scroll(){timer&&clearTimeout(timer),timer=setTimeout(function(){api.next()},opts.interval)}var timer,api=$(this).data("scrollable"),root=api.getRoot(),stopped=!1;api&&(ret=api),api.play=function(){timer||(stopped=!1,root.on("onSeek",scroll),scroll())},api.pause=function(){timer=clearTimeout(timer),root.off("onSeek",scroll)},api.resume=function(){stopped||api.play()},api.stop=function(){stopped=!0,api.pause()},opts.autopause&&root.add(api.getNaviButtons()).hover(api.pause,api.resume),opts.autoplay&&api.play()}),opts.api?ret:this}}(jQuery),function($){function find(root,query){var el=$(query);return el.length<2?el:root.parent().find(query)}var t=$.tools.scrollable;t.navigator={conf:{navi:".navi",naviItem:null,activeClass:"active",indexed:!1,idPrefix:null,history:!1}},$.fn.navigator=function(conf){"string"==typeof conf&&(conf={navi:conf}),conf=$.extend({},t.navigator.conf,conf);var ret;return this.each(function(){function doClick(el,i,e){api.seekTo(i),e.preventDefault(),hashed&&history.pushState({i:i},"")}function els(){return navi.find(conf.naviItem||"> *")}function addItem(i){var item=$("<"+(conf.naviItem||"a")+"/>").click(function(e){doClick($(this),i,e)});return 0===i&&item.addClass(cls),conf.indexed&&item.text(i+1),conf.idPrefix&&item.attr("id",conf.idPrefix+i),item.appendTo(navi)}var api=$(this).data("scrollable"),navi=conf.navi.jquery?conf.navi:find(api.getRoot(),conf.navi),buttons=api.getNaviButtons(),cls=conf.activeClass,hashed=conf.history&&!!history.pushState,size=api.getConf().size;api&&(ret=api),api.getNaviButtons=function(){return buttons.add(navi)},hashed&&(history.pushState({i:0},""),$(window).on("popstate",function(evt){var s=evt.originalEvent.state;s&&api.seekTo(s.i)})),els().length?els().each(function(i){$(this).click(function(e){doClick($(this),i,e)})}):$.each(api.getItems(),function(i){i%size==0&&addItem(i)}),api.onBeforeSeek(function(e,index){setTimeout(function(){if(!e.isDefaultPrevented()){var i=index/size,el=els().eq(i);el.length&&els().removeClass(cls).eq(i).addClass(cls)}},1)}),api.onAddItem(function(e,item){var i=api.getItems().index(item);i%size==0&&addItem(i)})}),conf.api?ret:this}}(jQuery),function($){function Slideshow(root,conf){function find(query){var el=$(query);return el.length<2?el:root.parent().find(query)}function next(){timer&&clearTimeout(timer),timer=setTimeout(function(){tabs.next()},conf.interval)}var timer,self=this,fire=root.add(this),tabs=root.data("tabs"),stopped=!0,nextButton=find(conf.next).click(function(){tabs.next()}),prevButton=find(conf.prev).click(function(){tabs.prev()});if($.extend(self,{getTabs:function(){return tabs},getConf:function(){return conf},play:function(){if(timer)return self;var e=$.Event("onBeforePlay");return fire.trigger(e),e.isDefaultPrevented()?self:(stopped=!1,fire.trigger("onPlay"),fire.on("onClick",next),next(),self)},pause:function(){if(!timer)return self;var e=$.Event("onBeforePause");return fire.trigger(e),e.isDefaultPrevented()?self:(timer=clearTimeout(timer),fire.trigger("onPause"),fire.off("onClick",next),self)},resume:function(){stopped||self.play()},stop:function(){self.pause(),stopped=!0}}),$.each("onBeforePlay,onPlay,onBeforePause,onPause".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return $(self).on(name,fn)}}),conf.autopause&&tabs.getTabs().add(nextButton).add(prevButton).add(tabs.getPanes()).hover(self.pause,self.resume),conf.autoplay&&self.play(),conf.clickable&&tabs.getPanes().click(function(){tabs.next()}),!tabs.getConf().rotate){var disabled=conf.disabledClass;tabs.getIndex()||prevButton.addClass(disabled),tabs.onBeforeClick(function(e,i){prevButton.toggleClass(disabled,!i),nextButton.toggleClass(disabled,i==tabs.getTabs().length-1)})}}var tool;tool=$.tools.tabs.slideshow={conf:{next:".forward",prev:".backward",disabledClass:"disabled",autoplay:!1,autopause:!0,interval:3e3,clickable:!0,api:!1}},$.fn.slideshow=function(conf){var el=this.data("slideshow");return el?el:(conf=$.extend({},tool.conf,conf),this.each(function(){el=new Slideshow($(this),conf),$(this).data("slideshow",el)}),conf.api?el:this)}}(jQuery),function(){function extend(to,from){if(from)for(var key in from)from.hasOwnProperty(key)&&(to[key]=from[key]);return to}function map(arr,func){var newArr=[];for(var i in arr)arr.hasOwnProperty(i)&&(newArr[i]=func(arr[i]));return newArr}function Flash(root,opts,conf){if(f.isSupported(opts.version))root.innerHTML=f.getHTML(opts,conf);else if(opts.expressInstall&&f.isSupported([6,65]))root.innerHTML=f.getHTML(extend(opts,{src:opts.expressInstall}),{MMredirectURL:location.href,MMplayerType:"PlugIn",MMdoctitle:document.title});else if(root.innerHTML.replace(/\s/g,"")||(root.innerHTML="<h2>Flash version "+opts.version+" or greater is required</h2><h3>"+(VERSION[0]>0?"Your version is "+VERSION:"You have no flash plugin installed")+"</h3>"+("A"==root.tagName?"<p>Click here to download latest version</p>":"<p>Download latest version from <a href='"+URL+"'>here</a></p>"),"A"==root.tagName&&(root.onclick=function(){location.href=URL})),opts.onFail){var ret=opts.onFail.call(this);"string"==typeof ret&&(root.innerHTML=ret)}IE&&(window[opts.id]=document.getElementById(opts.id)),extend(this,{getRoot:function(){return root},getOptions:function(){return opts},getConf:function(){return conf},getApi:function(){return root.firstChild}})}var IE=document.all,URL="http://www.adobe.com/go/getflashplayer",JQUERY="function"==typeof jQuery,RE=/(\d+)[^\d]+(\d+)[^\d]*(\d*)/,GLOBAL_OPTS={width:"100%",height:"100%",id:"_"+(""+Math.random()).slice(9),allowfullscreen:!0,allowscriptaccess:"always",quality:"high",version:[3,0],onFail:null,expressInstall:null,w3c:!1,cachebusting:!1};window.attachEvent&&window.attachEvent("onbeforeunload",function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){}}),window.flashembed=function(root,opts,conf){return"string"==typeof root&&(root=document.getElementById(root.replace("#",""))),root?("string"==typeof opts&&(opts={src:opts}),new Flash(root,extend(extend({},GLOBAL_OPTS),opts),conf)):void 0};var f=extend(window.flashembed,{conf:GLOBAL_OPTS,getVersion:function(){var fo,ver;try{ver=navigator.plugins["Shockwave Flash"].description.slice(16)}catch(e){try{fo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),ver=fo&&fo.GetVariable("$version")}catch(err){try{fo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),ver=fo&&fo.GetVariable("$version")}catch(err2){}}}return ver=RE.exec(ver),ver?[ver[1],ver[3]]:[0,0]},asString:function(obj){if(null===obj||void 0===obj)return null;var type=typeof obj;switch("object"==type&&obj.push&&(type="array"),type){case"string":return obj=obj.replace(new RegExp('(["\\\\])',"g"),"\\$1"),obj=obj.replace(/^\s?(\d+\.?\d*)%/,"$1pct"),'"'+obj+'"';case"array":return"["+map(obj,function(el){return f.asString(el)}).join(",")+"]";case"function":return'"function()"';case"object":var str=[];for(var prop in obj)obj.hasOwnProperty(prop)&&str.push('"'+prop+'":'+f.asString(obj[prop]));return"{"+str.join(",")+"}"}return String(obj).replace(/\s/g," ").replace(/\'/g,'"')},getHTML:function(opts,conf){opts=extend({},opts);var html='<object width="'+opts.width+'" height="'+opts.height+'" id="'+opts.id+'" name="'+opts.id+'"';opts.cachebusting&&(opts.src+=(-1!=opts.src.indexOf("?")?"&":"?")+Math.random()),html+=opts.w3c||!IE?' data="'+opts.src+'" type="application/x-shockwave-flash"':' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"',html+=">",(opts.w3c||IE)&&(html+='<param name="movie" value="'+opts.src+'" />'),opts.width=opts.height=opts.id=opts.w3c=opts.src=null,opts.onFail=opts.version=opts.expressInstall=null;for(var key in opts)opts[key]&&(html+='<param name="'+key+'" value="'+opts[key]+'" />');var vars="";if(conf){for(var k in conf)if(conf[k]){var val=conf[k];vars+=k+"="+encodeURIComponent(/function|object/.test(typeof val)?f.asString(val):val)+"&"}vars=vars.slice(0,-1),html+='<param name="flashvars" value=\''+vars+"' />"}return html+="</object>"},isSupported:function(ver){return VERSION[0]>ver[0]||VERSION[0]==ver[0]&&VERSION[1]>=ver[1]}}),VERSION=f.getVersion();JQUERY&&(jQuery.tools=jQuery.tools||{version:"@VERSION"},jQuery.tools.flashembed={conf:GLOBAL_OPTS},jQuery.fn.flashembed=function(opts,conf){return this.each(function(){jQuery(this).data("flashembed",flashembed(this,opts,conf))})})}(),function($){function wheelHandler(event){switch(event.type){case"mousemove":return $.extend(event.data,{clientX:event.clientX,clientY:event.clientY,pageX:event.pageX,pageY:event.pageY});case"DOMMouseScroll":$.extend(event,event.data),event.delta=-event.detail/3;break;case"mousewheel":event.delta=event.wheelDelta/120}return event.type="wheel",$.event.handle.call(this,event,event.delta)}$.fn.mousewheel=function(fn){return this[fn?"on":"trigger"]("wheel",fn)},$.event.special.wheel={setup:function(){$.event.add(this,wheelEvents,wheelHandler,{})},teardown:function(){$.event.remove(this,wheelEvents,wheelHandler)}};var wheelEvents=$.browser.mozilla?"DOMMouseScroll"+($.browser.version<"1.9"?" mousemove":""):"mousewheel"}(jQuery);
\ No newline at end of file
+!function($){function getPosition(el){var p=el.offset();return{top:p.top+el.height()/2,left:p.left+el.width()/2}}var t=$.tools.overlay,w=$(window);$.extend(t.conf,{start:{top:null,left:null},fadeInSpeed:"fast",zIndex:9999});var loadEffect=function(pos,onLoad){var overlay=this.getOverlay(),conf=this.getConf(),trigger=this.getTrigger(),self=this,oWidth=overlay.outerWidth(!0),img=overlay.data("img"),position=conf.fixed?"fixed":"absolute";if(!img){var bg=overlay.css("backgroundImage");if(!bg)throw"background-image CSS property not set for overlay";bg=bg.slice(bg.indexOf("(")+1,bg.indexOf(")")).replace(/\"/g,""),overlay.css("backgroundImage","none"),img=$('<img src="'+bg+'"/>'),img.css({border:0,display:"none"}).width(oWidth),$("body").append(img),overlay.data("img",img)}var itop=conf.start.top||Math.round(w.height()/2),ileft=conf.start.left||Math.round(w.width()/2);if(trigger){var p=getPosition(trigger);itop=p.top,ileft=p.left}conf.fixed?(itop-=w.scrollTop(),ileft-=w.scrollLeft()):(pos.top+=w.scrollTop(),pos.left+=w.scrollLeft()),img.css({position:"absolute",top:itop,left:ileft,width:0,zIndex:conf.zIndex}).show(),pos.position=position,overlay.css(pos),img.animate({top:pos.top,left:pos.left,width:oWidth},conf.speed,function(){overlay.css("zIndex",conf.zIndex+1).fadeIn(conf.fadeInSpeed,function(){self.isOpened()&&!$(this).index(overlay)?onLoad.call():overlay.hide()})}).css("position",position)},closeEffect=function(onClose){var overlay=this.getOverlay().hide(),conf=this.getConf(),trigger=this.getTrigger(),img=overlay.data("img"),css={top:conf.start.top,left:conf.start.left,width:0};trigger&&$.extend(css,getPosition(trigger)),conf.fixed&&img.css({position:"absolute"}).animate({top:"+="+w.scrollTop(),left:"+="+w.scrollLeft()},0),img.animate(css,conf.closeSpeed,onClose)};t.addEffect("apple",loadEffect,closeEffect)}(jQuery),function($){var t=$.tools.scrollable;t.autoscroll={conf:{autoplay:!0,interval:3e3,autopause:!0}},$.fn.autoscroll=function(conf){"number"==typeof conf&&(conf={interval:conf});var ret,opts=$.extend({},t.autoscroll.conf,conf);return this.each(function(){function scroll(){timer&&clearTimeout(timer),timer=setTimeout(function(){api.next()},opts.interval)}var timer,api=$(this).data("scrollable"),root=api.getRoot(),stopped=!1;api&&(ret=api),api.play=function(){timer||(stopped=!1,root.on("onSeek",scroll),scroll())},api.pause=function(){timer=clearTimeout(timer),root.off("onSeek",scroll)},api.resume=function(){stopped||api.play()},api.stop=function(){stopped=!0,api.pause()},opts.autopause&&root.add(api.getNaviButtons()).hover(api.pause,api.resume),opts.autoplay&&api.play()}),opts.api?ret:this}}(jQuery),function($){function find(root,query){var el=$(query);return el.length<2?el:root.parent().find(query)}var t=$.tools.scrollable;t.navigator={conf:{navi:".navi",naviItem:null,activeClass:"active",indexed:!1,idPrefix:null,history:!1}},$.fn.navigator=function(conf){"string"==typeof conf&&(conf={navi:conf}),conf=$.extend({},t.navigator.conf,conf);var ret;return this.each(function(){function doClick(el,i,e){api.seekTo(i),e.preventDefault(),hashed&&history.pushState({i:i},"")}function els(){return navi.find(conf.naviItem||"> *")}function addItem(i){var item=$("<"+(conf.naviItem||"a")+"/>").click(function(e){doClick($(this),i,e)});return 0===i&&item.addClass(cls),conf.indexed&&item.text(i+1),conf.idPrefix&&item.attr("id",conf.idPrefix+i),item.appendTo(navi)}var api=$(this).data("scrollable"),navi=conf.navi.jquery?conf.navi:find(api.getRoot(),conf.navi),buttons=api.getNaviButtons(),cls=conf.activeClass,hashed=conf.history&&!!history.pushState,size=api.getConf().size;api&&(ret=api),api.getNaviButtons=function(){return buttons.add(navi)},hashed&&(history.pushState({i:0},""),$(window).on("popstate",function(evt){var s=evt.originalEvent.state;s&&api.seekTo(s.i)})),els().length?els().each(function(i){$(this).click(function(e){doClick($(this),i,e)})}):$.each(api.getItems(),function(i){i%size==0&&addItem(i)}),api.onBeforeSeek(function(e,index){setTimeout(function(){if(!e.isDefaultPrevented()){var i=index/size,el=els().eq(i);el.length&&els().removeClass(cls).eq(i).addClass(cls)}},1)}),api.onAddItem(function(e,item){var i=api.getItems().index(item);i%size==0&&addItem(i)})}),conf.api?ret:this}}(jQuery),function($){function Slideshow(root,conf){function find(query){var el=$(query);return el.length<2?el:root.parent().find(query)}function next(){timer&&clearTimeout(timer),timer=setTimeout(function(){tabs.next()},conf.interval)}var timer,self=this,fire=root.add(this),tabs=root.data("tabs"),stopped=!0,nextButton=find(conf.next).click(function(){tabs.next()}),prevButton=find(conf.prev).click(function(){tabs.prev()});if($.extend(self,{getTabs:function(){return tabs},getConf:function(){return conf},play:function(){if(timer)return self;var e=$.Event("onBeforePlay");return fire.trigger(e),e.isDefaultPrevented()?self:(stopped=!1,fire.trigger("onPlay"),fire.on("onClick",next),next(),self)},pause:function(){if(!timer)return self;var e=$.Event("onBeforePause");return fire.trigger(e),e.isDefaultPrevented()?self:(timer=clearTimeout(timer),fire.trigger("onPause"),fire.off("onClick",next),self)},resume:function(){stopped||self.play()},stop:function(){self.pause(),stopped=!0}}),$.each("onBeforePlay,onPlay,onBeforePause,onPause".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return $(self).on(name,fn)}}),conf.autopause&&tabs.getTabs().add(nextButton).add(prevButton).add(tabs.getPanes()).hover(self.pause,self.resume),conf.autoplay&&self.play(),conf.clickable&&tabs.getPanes().click(function(){tabs.next()}),!tabs.getConf().rotate){var disabled=conf.disabledClass;tabs.getIndex()||prevButton.addClass(disabled),tabs.onBeforeClick(function(e,i){prevButton.toggleClass(disabled,!i),nextButton.toggleClass(disabled,i==tabs.getTabs().length-1)})}}var tool;tool=$.tools.tabs.slideshow={conf:{next:".forward",prev:".backward",disabledClass:"disabled",autoplay:!1,autopause:!0,interval:3e3,clickable:!0,api:!1}},$.fn.slideshow=function(conf){var el=this.data("slideshow");return el?el:(conf=$.extend({},tool.conf,conf),this.each(function(){el=new Slideshow($(this),conf),$(this).data("slideshow",el)}),conf.api?el:this)}}(jQuery),function(){function extend(to,from){if(from)for(var key in from)from.hasOwnProperty(key)&&(to[key]=from[key]);return to}function map(arr,func){var newArr=[];for(var i in arr)arr.hasOwnProperty(i)&&(newArr[i]=func(arr[i]));return newArr}function Flash(root,opts,conf){if(f.isSupported(opts.version))root.innerHTML=f.getHTML(opts,conf);else if(opts.expressInstall&&f.isSupported([6,65]))root.innerHTML=f.getHTML(extend(opts,{src:opts.expressInstall}),{MMredirectURL:location.href,MMplayerType:"PlugIn",MMdoctitle:document.title});else if(root.innerHTML.replace(/\s/g,"")||(root.innerHTML="<h2>Flash version "+opts.version+" or greater is required</h2><h3>"+(VERSION[0]>0?"Your version is "+VERSION:"You have no flash plugin installed")+"</h3>"+("A"==root.tagName?"<p>Click here to download latest version</p>":"<p>Download latest version from <a href='"+URL+"'>here</a></p>"),"A"==root.tagName&&(root.onclick=function(){location.href=URL})),opts.onFail){var ret=opts.onFail.call(this);"string"==typeof ret&&(root.innerHTML=ret)}IE&&(window[opts.id]=document.getElementById(opts.id)),extend(this,{getRoot:function(){return root},getOptions:function(){return opts},getConf:function(){return conf},getApi:function(){return root.firstChild}})}var IE=document.all,URL="http://www.adobe.com/go/getflashplayer",JQUERY="function"==typeof jQuery,RE=/(\d+)[^\d]+(\d+)[^\d]*(\d*)/,GLOBAL_OPTS={width:"100%",height:"100%",id:"_"+(""+Math.random()).slice(9),allowfullscreen:!0,allowscriptaccess:"always",quality:"high",version:[3,0],onFail:null,expressInstall:null,w3c:!1,cachebusting:!1};window.attachEvent&&window.attachEvent("onbeforeunload",function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){}}),window.flashembed=function(root,opts,conf){if("string"==typeof root&&(root=document.getElementById(root.replace("#",""))),root)return"string"==typeof opts&&(opts={src:opts}),new Flash(root,extend(extend({},GLOBAL_OPTS),opts),conf)};var f=extend(window.flashembed,{conf:GLOBAL_OPTS,getVersion:function(){var fo,ver;try{ver=navigator.plugins["Shockwave Flash"].description.slice(16)}catch(e){try{fo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),ver=fo&&fo.GetVariable("$version")}catch(err){try{fo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),ver=fo&&fo.GetVariable("$version")}catch(err2){}}}return ver=RE.exec(ver),ver?[ver[1],ver[3]]:[0,0]},asString:function(obj){if(null===obj||void 0===obj)return null;var type=typeof obj;switch("object"==type&&obj.push&&(type="array"),type){case"string":return obj=obj.replace(new RegExp('(["\\\\])',"g"),"\\$1"),obj=obj.replace(/^\s?(\d+\.?\d*)%/,"$1pct"),'"'+obj+'"';case"array":return"["+map(obj,function(el){return f.asString(el)}).join(",")+"]";case"function":return'"function()"';case"object":var str=[];for(var prop in obj)obj.hasOwnProperty(prop)&&str.push('"'+prop+'":'+f.asString(obj[prop]));return"{"+str.join(",")+"}"}return String(obj).replace(/\s/g," ").replace(/\'/g,'"')},getHTML:function(opts,conf){opts=extend({},opts);var html='<object width="'+opts.width+'" height="'+opts.height+'" id="'+opts.id+'" name="'+opts.id+'"';opts.cachebusting&&(opts.src+=(opts.src.indexOf("?")!=-1?"&":"?")+Math.random()),html+=opts.w3c||!IE?' data="'+opts.src+'" type="application/x-shockwave-flash"':' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"',html+=">",(opts.w3c||IE)&&(html+='<param name="movie" value="'+opts.src+'" />'),opts.width=opts.height=opts.id=opts.w3c=opts.src=null,opts.onFail=opts.version=opts.expressInstall=null;for(var key in opts)opts[key]&&(html+='<param name="'+key+'" value="'+opts[key]+'" />');var vars="";if(conf){for(var k in conf)if(conf[k]){var val=conf[k];vars+=k+"="+encodeURIComponent(/function|object/.test(typeof val)?f.asString(val):val)+"&"}vars=vars.slice(0,-1),html+='<param name="flashvars" value=\''+vars+"' />"}return html+="</object>"},isSupported:function(ver){return VERSION[0]>ver[0]||VERSION[0]==ver[0]&&VERSION[1]>=ver[1]}}),VERSION=f.getVersion();JQUERY&&(jQuery.tools=jQuery.tools||{version:"@VERSION"},jQuery.tools.flashembed={conf:GLOBAL_OPTS},jQuery.fn.flashembed=function(opts,conf){return this.each(function(){jQuery(this).data("flashembed",flashembed(this,opts,conf))})})}(),function($){function wheelHandler(event){switch(event.type){case"mousemove":return $.extend(event.data,{clientX:event.clientX,clientY:event.clientY,pageX:event.pageX,pageY:event.pageY});case"DOMMouseScroll":$.extend(event,event.data),event.delta=-event.detail/3;break;case"mousewheel":event.delta=event.wheelDelta/120}return event.type="wheel",$.event.handle.call(this,event,event.delta)}$.fn.mousewheel=function(fn){return this[fn?"on":"trigger"]("wheel",fn)},$.event.special.wheel={setup:function(){$.event.add(this,wheelEvents,wheelHandler,{})},teardown:function(){$.event.remove(this,wheelEvents,wheelHandler)}};var wheelEvents=$.browser.mozilla?"DOMMouseScroll"+($.browser.version<"1.9"?" mousemove":""):"mousewheel"}(jQuery);
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.rangeinput.min.js b/plone/app/jquerytools/browser/jquery.tools.rangeinput.min.js
index 0ca8759..ccc38d3 100644
--- a/plone/app/jquerytools/browser/jquery.tools.rangeinput.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.rangeinput.min.js
@@ -1 +1 @@
-var oldFnData=jQuery.fn.data;jQuery.fn.data=function(name){var ret,evt,elem=this[0];return elem&&"events"===name&&1===arguments.length&&(ret=jQuery.data(elem,name),evt=jQuery._data(elem,name)),oldFnData.apply(this,arguments)},function($){function round(value,precision){var n=Math.pow(10,precision);return Math.round(value*n)/n}function dim(el,key){var v=parseInt(el.css(key),10);if(v)return v;var s=el[0].currentStyle;return s&&s.width&&parseInt(s.width,10)}function hasEvent(el){var e=el.data("events");return e&&e.onSlide}function RangeInput(input,conf){function slide(evt,x,val,isSetValue){if(void 0===val?val=x/len*range:isSetValue&&(val-=conf.min),step&&(val=Math.round(val/step)*step),(void 0===x||step)&&(x=val*len/range),isNaN(val))return self;x=Math.max(0,Math.min(x,len)),val=x/len*range,(isSetValue||!vertical)&&(val+=conf.min),vertical&&(isSetValue?x=len-x:val=conf.max-val),val=round(val,precision);var isClick="click"==evt.type;if(fireOnSlide&&void 0!==value&&!isClick&&(evt.type="onSlide",fire.trigger(evt,[val,x]),evt.isDefaultPrevented()))return self;var speed=isClick?conf.speed:0,callback=isClick?function(){evt.type="change",fire.trigger(evt,[val])}:null;return vertical?(handle.animate({top:x},speed,callback),conf.progress&&progress.animate({height:len-x+handle.height()/2},speed)):(handle.animate({left:x},speed,callback),conf.progress&&progress.animate({width:x+handle.width()/2},speed)),value=val,pos=x,input.val(val),self}function init(){vertical=conf.vertical||dim(root,"height")>dim(root,"width"),vertical?(len=dim(root,"height")-dim(handle,"height"),origo=root.offset().top+len):(len=dim(root,"width")-dim(handle,"width"),origo=root.offset().left)}function begin(){init(),self.setValue(void 0!==conf.value?conf.value:conf.min)}var vertical,value,origo,len,pos,self=this,css=conf.css,root=$("<div><div/><a href='#'/></div>").data("rangeinput",self);input.before(root);var handle=root.addClass(css.slider).find("a").addClass(css.handle),progress=root.find("div").addClass(css.progress);$.each("min,max,step,value".split(","),function(i,key){var val=input.attr(key);parseFloat(val)&&(conf[key]=parseFloat(val,10))});var range=conf.max-conf.min,step="any"==conf.step?0:conf.step,precision=conf.precision;if(void 0===precision&&(precision=step.toString().split("."),precision=2===precision.length?precision[1].length:0),"range"==input.attr("type")){var def=input.clone().wrap("<div/>").parent().html(),clone=$(def.replace(/type/i,"type=text data-orig-type"));clone.val(conf.value),input.replaceWith(clone),input=clone}input.addClass(css.input);var fire=$(self).add(input),fireOnSlide=!0;$.extend(self,{getValue:function(){return value},setValue:function(val,e){return init(),slide(e||$.Event("api"),void 0,val,!0)},getConf:function(){return conf},getProgress:function(){return progress},getHandle:function(){return handle},getInput:function(){return input},step:function(am,e){e=e||$.Event();var step="any"==conf.step?1:conf.step;self.setValue(value+step*(am||1),e)},stepUp:function(am){return self.step(am||1)},stepDown:function(am){return self.step(-am||-1)}}),$.each("onSlide,change".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),handle.drag({drag:!1}).on("dragStart",function(){init(),fireOnSlide=hasEvent($(self))||hasEvent(input)}).on("drag",function(e,y,x){return input.is(":disabled")?!1:void slide(e,vertical?y:x)}).on("dragEnd",function(e){e.isDefaultPrevented()||(e.type="change",fire.trigger(e,[value]))}).click(function(e){return e.preventDefault()}),root.click(function(e){if(input.is(":disabled")||e.target==handle[0])return e.preventDefault();init();var fix=vertical?handle.height()/2:handle.width()/2;slide(e,vertical?len-origo-fix+e.pageY:e.pageX-origo-fix)}),conf.keyboard&&input.keydown(function(e){if(!input.attr("readonly")){var key=e.keyCode,up=-1!=$([75,76,38,33,39]).index(key),down=-1!=$([74,72,40,34,37]).index(key);return!up&&!down||e.shiftKey||e.altKey||e.ctrlKey?void 0:(up?self.step(33==key?10:1,e):down&&self.step(34==key?-10:-1,e),e.preventDefault())}}),input.blur(function(e){var val=$(this).val();val!==value&&self.setValue(val,e)}),$.extend(input[0],{stepUp:self.stepUp,stepDown:self.stepDown}),begin(),len||$(window).load(begin)}$.tools=$.tools||{version:"@VERSION"};var tool;tool=$.tools.rangeinput={conf:{min:0,max:100,step:"any",steps:0,value:0,precision:void 0,vertical:0,keyboard:!0,progress:!1,speed:100,css:{input:"range",slider:"slider",progress:"progress",handle:"handle"}}};var doc,draggable;$.fn.drag=function(conf){return document.ondragstart=function(){return!1},conf=$.extend({x:!0,y:!0,drag:!0},conf),doc=doc||$(document).on("mousedown mouseup",function(e){var el=$(e.target);if("mousedown"==e.type&&el.data("drag")){var offset=el.position(),x0=e.pageX-offset.left,y0=e.pageY-offset.top,start=!0;doc.on("mousemove.drag",function(e){var x=e.pageX-x0,y=e.pageY-y0,props={};conf.x&&(props.left=x),conf.y&&(props.top=y),start&&(el.trigger("dragStart"),start=!1),conf.drag&&el.css(props),el.trigger("drag",[y,x]),draggable=el}),e.preventDefault()}else try{draggable&&draggable.trigger("dragEnd")}finally{doc.off("mousemove.drag"),draggable=null}}),this.data("drag",!0)},$.expr[":"].range=function(el){var type=el.getAttribute("type");return type&&"range"==type||!!$(el).filter("input").data("rangeinput")},$.fn.rangeinput=function(conf){if(this.data("rangeinput"))return this;conf=$.extend(!0,{},tool.conf,conf);var els;return this.each(function(){var el=new RangeInput($(this),$.extend(!0,{},conf)),input=el.getInput().data("rangeinput",el);els=els?els.add(input):input}),els?els:this}}(jQuery);
\ No newline at end of file
+var oldFnData=jQuery.fn.data;jQuery.fn.data=function(name){var ret,evt,elem=this[0];return elem&&"events"===name&&1===arguments.length&&(ret=jQuery.data(elem,name),evt=jQuery._data(elem,name)),oldFnData.apply(this,arguments)},function($){function round(value,precision){var n=Math.pow(10,precision);return Math.round(value*n)/n}function dim(el,key){var v=parseInt(el.css(key),10);if(v)return v;var s=el[0].currentStyle;return s&&s.width&&parseInt(s.width,10)}function hasEvent(el){var e=el.data("events");return e&&e.onSlide}function RangeInput(input,conf){function slide(evt,x,val,isSetValue){if(void 0===val?val=x/len*range:isSetValue&&(val-=conf.min),step&&(val=Math.round(val/step)*step),(void 0===x||step)&&(x=val*len/range),isNaN(val))return self;x=Math.max(0,Math.min(x,len)),val=x/len*range,!isSetValue&&vertical||(val+=conf.min),vertical&&(isSetValue?x=len-x:val=conf.max-val),val=round(val,precision);var isClick="click"==evt.type;if(fireOnSlide&&void 0!==value&&!isClick&&(evt.type="onSlide",fire.trigger(evt,[val,x]),evt.isDefaultPrevented()))return self;var speed=isClick?conf.speed:0,callback=isClick?function(){evt.type="change",fire.trigger(evt,[val])}:null;return vertical?(handle.animate({top:x},speed,callback),conf.progress&&progress.animate({height:len-x+handle.height()/2},speed)):(handle.animate({left:x},speed,callback),conf.progress&&progress.animate({width:x+handle.width()/2},speed)),value=val,pos=x,input.val(val),self}function init(){vertical=conf.vertical||dim(root,"height")>dim(root,"width"),vertical?(len=dim(root,"height")-dim(handle,"height"),origo=root.offset().top+len):(len=dim(root,"width")-dim(handle,"width"),origo=root.offset().left)}function begin(){init(),self.setValue(void 0!==conf.value?conf.value:conf.min)}var vertical,value,origo,len,pos,self=this,css=conf.css,root=$("<div><div/><a href='#'/></div>").data("rangeinput",self);input.before(root);var handle=root.addClass(css.slider).find("a").addClass(css.handle),progress=root.find("div").addClass(css.progress);$.each("min,max,step,value".split(","),function(i,key){var val=input.attr(key);parseFloat(val)&&(conf[key]=parseFloat(val,10))});var range=conf.max-conf.min,step="any"==conf.step?0:conf.step,precision=conf.precision;if(void 0===precision&&(precision=step.toString().split("."),precision=2===precision.length?precision[1].length:0),"range"==input.attr("type")){var def=input.clone().wrap("<div/>").parent().html(),clone=$(def.replace(/type/i,"type=text data-orig-type"));clone.val(conf.value),input.replaceWith(clone),input=clone}input.addClass(css.input);var fire=$(self).add(input),fireOnSlide=!0;$.extend(self,{getValue:function(){return value},setValue:function(val,e){return init(),slide(e||$.Event("api"),void 0,val,!0)},getConf:function(){return conf},getProgress:function(){return progress},getHandle:function(){return handle},getInput:function(){return input},step:function(am,e){e=e||$.Event();var step="any"==conf.step?1:conf.step;self.setValue(value+step*(am||1),e)},stepUp:function(am){return self.step(am||1)},stepDown:function(am){return self.step(-am||-1)}}),$.each("onSlide,change".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),handle.drag({drag:!1}).on("dragStart",function(){init(),fireOnSlide=hasEvent($(self))||hasEvent(input)}).on("drag",function(e,y,x){return!input.is(":disabled")&&void slide(e,vertical?y:x)}).on("dragEnd",function(e){e.isDefaultPrevented()||(e.type="change",fire.trigger(e,[value]))}).click(function(e){return e.preventDefault()}),root.click(function(e){if(input.is(":disabled")||e.target==handle[0])return e.preventDefault();init();var fix=vertical?handle.height()/2:handle.width()/2;slide(e,vertical?len-origo-fix+e.pageY:e.pageX-origo-fix)}),conf.keyboard&&input.keydown(function(e){if(!input.attr("readonly")){var key=e.keyCode,up=$([75,76,38,33,39]).index(key)!=-1,down=$([74,72,40,34,37]).index(key)!=-1;return!up&&!down||e.shiftKey||e.altKey||e.ctrlKey?void 0:(up?self.step(33==key?10:1,e):down&&self.step(34==key?-10:-1,e),e.preventDefault())}}),input.blur(function(e){var val=$(this).val();val!==value&&self.setValue(val,e)}),$.extend(input[0],{stepUp:self.stepUp,stepDown:self.stepDown}),begin(),len||$(window).load(begin)}$.tools=$.tools||{version:"@VERSION"};var tool;tool=$.tools.rangeinput={conf:{min:0,max:100,step:"any",steps:0,value:0,precision:void 0,vertical:0,keyboard:!0,progress:!1,speed:100,css:{input:"range",slider:"slider",progress:"progress",handle:"handle"}}};var doc,draggable;$.fn.drag=function(conf){return document.ondragstart=function(){return!1},conf=$.extend({x:!0,y:!0,drag:!0},conf),doc=doc||$(document).on("mousedown mouseup",function(e){var el=$(e.target);if("mousedown"==e.type&&el.data("drag")){var offset=el.position(),x0=e.pageX-offset.left,y0=e.pageY-offset.top,start=!0;doc.on("mousemove.drag",function(e){var x=e.pageX-x0,y=e.pageY-y0,props={};conf.x&&(props.left=x),conf.y&&(props.top=y),start&&(el.trigger("dragStart"),start=!1),conf.drag&&el.css(props),el.trigger("drag",[y,x]),draggable=el}),e.preventDefault()}else try{draggable&&draggable.trigger("dragEnd")}finally{doc.off("mousemove.drag"),draggable=null}}),this.data("drag",!0)},$.expr[":"].range=function(el){var type=el.getAttribute("type");return type&&"range"==type||!!$(el).filter("input").data("rangeinput")},$.fn.rangeinput=function(conf){if(this.data("rangeinput"))return this;conf=$.extend(!0,{},tool.conf,conf);var els;return this.each(function(){var el=new RangeInput($(this),$.extend(!0,{},conf)),input=el.getInput().data("rangeinput",el);els=els?els.add(input):input}),els?els:this}}(jQuery);
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.tooltip.min.js b/plone/app/jquerytools/browser/jquery.tools.tooltip.min.js
index e933be2..88eb5b1 100644
--- a/plone/app/jquerytools/browser/jquery.tools.tooltip.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.tooltip.min.js
@@ -1 +1 @@
-!function($){function getPosition(trigger,tip,conf){var top=conf.relative?trigger.position().top:trigger.offset().top,left=conf.relative?trigger.position().left:trigger.offset().left,pos=conf.position[0];top-=tip.outerHeight()-conf.offset[0],left+=trigger.outerWidth()+conf.offset[1],/iPad/i.test(navigator.userAgent)&&(top-=$(window).scrollTop());var height=tip.outerHeight()+trigger.outerHeight();"center"==pos&&(top+=height/2),"bottom"==pos&&(top+=height),pos=conf.position[1];var width=tip.outerWidth()+trigger.outerWidth();return"center"==pos&&(left-=width/2),"left"==pos&&(left-=width),{top:top,left:left}}function Tooltip(trigger,conf){var tip,shown,self=this,fire=trigger.add(self),timer=0,pretimer=0,title=trigger.attr("title"),tipAttr=trigger.attr("data-tooltip"),effect=effects[conf.effect],isInput=trigger.is(":input"),isWidget=isInput&&trigger.is(":checkbox, :radio, select, :button, :submit"),type=trigger.attr("type"),evt=conf.events[type]||conf.events[isInput?isWidget?"widget":"input":"def"];if(!effect)throw'Nonexistent effect "'+conf.effect+'"';if(evt=evt.split(/,\s*/),2!=evt.length)throw"Tooltip: bad events configuration for "+type;trigger.on(evt[0],function(e){clearTimeout(timer),conf.predelay?pretimer=setTimeout(function(){self.show(e)},conf.predelay):self.show(e)}).on(evt[1],function(e){clearTimeout(pretimer),conf.delay?timer=setTimeout(function(){self.hide(e)},conf.delay):self.hide(e)}),title&&conf.cancelDefault&&(trigger.removeAttr("title"),trigger.data("title",title)),$.extend(self,{show:function(e){if(!tip&&(tipAttr?tip=$(tipAttr):conf.tip?tip=$(conf.tip).eq(0):title?tip=$(conf.layout).addClass(conf.tipClass).appendTo(document.body).hide().append(title):(tip=trigger.find("."+conf.tipClass),tip.length||(tip=trigger.next()),tip.length||(tip=trigger.parent().next())),!tip.length))throw"Cannot find tooltip for "+trigger;if(self.isShown())return self;tip.stop(!0,!0);var pos=getPosition(trigger,tip,conf);if(conf.tip&&tip.html(trigger.data("title")),e=$.Event(),e.type="onBeforeShow",fire.trigger(e,[pos]),e.isDefaultPrevented())return self;pos=getPosition(trigger,tip,conf),tip.css({position:"absolute",top:pos.top,left:pos.left}),shown=!0,effect[0].call(self,function(){e.type="onShow",shown="full",fire.trigger(e)});var event=conf.events.tooltip.split(/,\s*/);return tip.data("__set")||(tip.off(event[0]).on(event[0],function(){clearTimeout(timer),clearTimeout(pretimer)}),event[1]&&!trigger.is("input:not(:checkbox, :radio), textarea")&&tip.off(event[1]).on(event[1],function(e){e.relatedTarget!=trigger[0]&&trigger.trigger(evt[1].split(" ")[0])}),conf.tip||tip.data("__set",!0)),self},hide:function(e){return tip&&self.isShown()?(e=$.Event(),e.type="onBeforeHide",fire.trigger(e),e.isDefaultPrevented()?void 0:(shown=!1,effects[conf.effect][1].call(self,function(){e.type="onHide",fire.trigger(e)}),self)):self},isShown:function(fully){return fully?"full"==shown:shown},getConf:function(){return conf},getTip:function(){return tip},getTrigger:function(){return trigger}}),$.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}})}$.tools=$.tools||{version:"@VERSION"},$.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(name,loadFn,hideFn){effects[name]=[loadFn,hideFn]}};var effects={toggle:[function(done){var conf=this.getConf(),tip=this.getTip(),o=conf.opacity;1>o&&tip.css({opacity:o}),tip.show(),done.call()},function(done){this.getTip().hide(),done.call()}],fade:[function(done){var conf=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||conf.fadeIE?this.getTip().fadeTo(conf.fadeInSpeed,conf.opacity,done):(this.getTip().show(),done())},function(done){var conf=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||conf.fadeIE?this.getTip().fadeOut(conf.fadeOutSpeed,done):(this.getTip().hide(),done())}]};$.fn.tooltip=function(conf){var api=this.data("tooltip");return api?api:(conf=$.extend(!0,{},$.tools.tooltip.conf,conf),"string"==typeof conf.position&&(conf.position=conf.position.split(/,?\s/)),this.each(function(){api=new Tooltip($(this),conf),$(this).data("tooltip",api)}),conf.api?api:this)}}(jQuery);
\ No newline at end of file
+!function($){function getPosition(trigger,tip,conf){var top=conf.relative?trigger.position().top:trigger.offset().top,left=conf.relative?trigger.position().left:trigger.offset().left,pos=conf.position[0];top-=tip.outerHeight()-conf.offset[0],left+=trigger.outerWidth()+conf.offset[1],/iPad/i.test(navigator.userAgent)&&(top-=$(window).scrollTop());var height=tip.outerHeight()+trigger.outerHeight();"center"==pos&&(top+=height/2),"bottom"==pos&&(top+=height),pos=conf.position[1];var width=tip.outerWidth()+trigger.outerWidth();return"center"==pos&&(left-=width/2),"left"==pos&&(left-=width),{top:top,left:left}}function Tooltip(trigger,conf){var tip,shown,self=this,fire=trigger.add(self),timer=0,pretimer=0,title=trigger.attr("title"),tipAttr=trigger.attr("data-tooltip"),effect=effects[conf.effect],isInput=trigger.is(":input"),isWidget=isInput&&trigger.is(":checkbox, :radio, select, :button, :submit"),type=trigger.attr("type"),evt=conf.events[type]||conf.events[isInput?isWidget?"widget":"input":"def"];if(!effect)throw'Nonexistent effect "'+conf.effect+'"';if(evt=evt.split(/,\s*/),2!=evt.length)throw"Tooltip: bad events configuration for "+type;trigger.on(evt[0],function(e){clearTimeout(timer),conf.predelay?pretimer=setTimeout(function(){self.show(e)},conf.predelay):self.show(e)}).on(evt[1],function(e){clearTimeout(pretimer),conf.delay?timer=setTimeout(function(){self.hide(e)},conf.delay):self.hide(e)}),title&&conf.cancelDefault&&(trigger.removeAttr("title"),trigger.data("title",title)),$.extend(self,{show:function(e){if(!tip&&(tipAttr?tip=$(tipAttr):conf.tip?tip=$(conf.tip).eq(0):title?tip=$(conf.layout).addClass(conf.tipClass).appendTo(document.body).hide().append(title):(tip=trigger.find("."+conf.tipClass),tip.length||(tip=trigger.next()),tip.length||(tip=trigger.parent().next())),!tip.length))throw"Cannot find tooltip for "+trigger;if(self.isShown())return self;tip.stop(!0,!0);var pos=getPosition(trigger,tip,conf);if(conf.tip&&tip.html(trigger.data("title")),e=$.Event(),e.type="onBeforeShow",fire.trigger(e,[pos]),e.isDefaultPrevented())return self;pos=getPosition(trigger,tip,conf),tip.css({position:"absolute",top:pos.top,left:pos.left}),shown=!0,effect[0].call(self,function(){e.type="onShow",shown="full",fire.trigger(e)});var event=conf.events.tooltip.split(/,\s*/);return tip.data("__set")||(tip.off(event[0]).on(event[0],function(){clearTimeout(timer),clearTimeout(pretimer)}),event[1]&&!trigger.is("input:not(:checkbox, :radio), textarea")&&tip.off(event[1]).on(event[1],function(e){e.relatedTarget!=trigger[0]&&trigger.trigger(evt[1].split(" ")[0])}),conf.tip||tip.data("__set",!0)),self},hide:function(e){return tip&&self.isShown()?(e=$.Event(),e.type="onBeforeHide",fire.trigger(e),e.isDefaultPrevented()?void 0:(shown=!1,effects[conf.effect][1].call(self,function(){e.type="onHide",fire.trigger(e)}),self)):self},isShown:function(fully){return fully?"full"==shown:shown},getConf:function(){return conf},getTip:function(){return tip},getTrigger:function(){return trigger}}),$.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}})}$.tools=$.tools||{version:"@VERSION"},$.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(name,loadFn,hideFn){effects[name]=[loadFn,hideFn]}};var effects={toggle:[function(done){var conf=this.getConf(),tip=this.getTip(),o=conf.opacity;o<1&&tip.css({opacity:o}),tip.show(),done.call()},function(done){this.getTip().hide(),done.call()}],fade:[function(done){var conf=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||conf.fadeIE?this.getTip().fadeTo(conf.fadeInSpeed,conf.opacity,done):(this.getTip().show(),done())},function(done){var conf=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||conf.fadeIE?this.getTip().fadeOut(conf.fadeOutSpeed,done):(this.getTip().hide(),done())}]};$.fn.tooltip=function(conf){var api=this.data("tooltip");return api?api:(conf=$.extend(!0,{},$.tools.tooltip.conf,conf),"string"==typeof conf.position&&(conf.position=conf.position.split(/,?\s/)),this.each(function(){api=new Tooltip($(this),conf),$(this).data("tooltip",api)}),conf.api?api:this)}}(jQuery);
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.tooltip.plugins.min.js b/plone/app/jquerytools/browser/jquery.tools.tooltip.plugins.min.js
index 607c200..d6c82aa 100644
--- a/plone/app/jquerytools/browser/jquery.tools.tooltip.plugins.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.tooltip.plugins.min.js
@@ -1 +1 @@
-!function($){function getCropping(el){var w=$(window),right=w.width()+w.scrollLeft(),bottom=w.height()+w.scrollTop();return[el.offset().top<=w.scrollTop(),right<=el.offset().left+el.width(),bottom<=el.offset().top+el.height(),w.scrollLeft()>=el.offset().left]}function isVisible(crop){for(var i=crop.length;i--;)if(crop[i])return!1;return!0}var t=$.tools.tooltip;t.dynamic={conf:{classNames:"top right bottom left"}},$.fn.dynamic=function(conf){"number"==typeof conf&&(conf={speed:conf}),conf=$.extend({},t.dynamic.conf,conf);var orig,ret,confOrigin=$.extend(!0,{},conf),cls=conf.classNames.split(/\s/);return this.each(function(){var api=$(this).tooltip().onBeforeShow(function(e,pos){var tip=this.getTip(),tipConf=this.getConf();orig||(orig=[tipConf.position[0],tipConf.position[1],tipConf.offset[0],tipConf.offset[1],$.extend({},tipConf)]),$.extend(tipConf,orig[4]),tipConf.position=[orig[0],orig[1]],tipConf.offset=[orig[2],orig[3]],tip.css({visibility:"hidden",position:"absolute",top:pos.top,left:pos.left}).show();var conf=$.extend(!0,{},confOrigin),crop=getCropping(tip);isVisible(crop)||(crop[2]&&($.extend(tipConf,conf.top),tipConf.position[0]="top",tip.addClass(cls[0])),crop[3]&&($.extend(tipConf,conf.right),tipConf.position[1]="right",tip.addClass(cls[1])),crop[0]&&($.extend(tipConf,conf.bottom),tipConf.position[0]="bottom",tip.addClass(cls[2])),crop[1]&&($.extend(tipConf,conf.left),tipConf.position[1]="left",tip.addClass(cls[3])),(crop[0]||crop[2])&&(tipConf.offset[0]*=-1),(crop[1]||crop[3])&&(tipConf.offset[1]*=-1)),tip.css({visibility:"visible"}).hide()});api.onBeforeShow(function(){{var c=this.getConf();this.getTip()}setTimeout(function(){c.position=[orig[0],orig[1]],c.offset=[orig[2],orig[3]]},0)}),api.onHide(function(){var tip=this.getTip();tip.removeClass(conf.classNames)}),ret=api}),conf.api?ret:this}}(jQuery),function($){var t=$.tools.tooltip;$.extend(t.conf,{direction:"up",bounce:!1,slideOffset:10,slideInSpeed:200,slideOutSpeed:200,slideFade:!/msie/.test(navigator.userAgent.toLowerCase())});var dirs={up:["-","top"],down:["+","top"],left:["-","left"],right:["+","left"]};t.addEffect("slide",function(done){var conf=this.getConf(),tip=this.getTip(),params=conf.slideFade?{opacity:conf.opacity}:{},dir=dirs[conf.direction]||dirs.up;params[dir[1]]=dir[0]+"="+conf.slideOffset,conf.slideFade&&tip.css({opacity:0}),tip.show().animate(params,conf.slideInSpeed,done)},function(done){var conf=this.getConf(),offset=conf.slideOffset,params=conf.slideFade?{opacity:0}:{},dir=dirs[conf.direction]||dirs.up,sign=""+dir[0];conf.bounce&&(sign="+"==sign?"-":"+"),params[dir[1]]=sign+"="+offset,this.getTip().animate(params,conf.slideOutSpeed,function(){$(this).hide(),done.call()})})}(jQuery);
\ No newline at end of file
+!function($){function getCropping(el){var w=$(window),right=w.width()+w.scrollLeft(),bottom=w.height()+w.scrollTop();return[el.offset().top<=w.scrollTop(),right<=el.offset().left+el.width(),bottom<=el.offset().top+el.height(),w.scrollLeft()>=el.offset().left]}function isVisible(crop){for(var i=crop.length;i--;)if(crop[i])return!1;return!0}var t=$.tools.tooltip;t.dynamic={conf:{classNames:"top right bottom left"}},$.fn.dynamic=function(conf){"number"==typeof conf&&(conf={speed:conf}),conf=$.extend({},t.dynamic.conf,conf);var orig,ret,confOrigin=$.extend(!0,{},conf),cls=conf.classNames.split(/\s/);return this.each(function(){var api=$(this).tooltip().onBeforeShow(function(e,pos){var tip=this.getTip(),tipConf=this.getConf();orig||(orig=[tipConf.position[0],tipConf.position[1],tipConf.offset[0],tipConf.offset[1],$.extend({},tipConf)]),$.extend(tipConf,orig[4]),tipConf.position=[orig[0],orig[1]],tipConf.offset=[orig[2],orig[3]],tip.css({visibility:"hidden",position:"absolute",top:pos.top,left:pos.left}).show();var conf=$.extend(!0,{},confOrigin),crop=getCropping(tip);isVisible(crop)||(crop[2]&&($.extend(tipConf,conf.top),tipConf.position[0]="top",tip.addClass(cls[0])),crop[3]&&($.extend(tipConf,conf.right),tipConf.position[1]="right",tip.addClass(cls[1])),crop[0]&&($.extend(tipConf,conf.bottom),tipConf.position[0]="bottom",tip.addClass(cls[2])),crop[1]&&($.extend(tipConf,conf.left),tipConf.position[1]="left",tip.addClass(cls[3])),(crop[0]||crop[2])&&(tipConf.offset[0]*=-1),(crop[1]||crop[3])&&(tipConf.offset[1]*=-1)),tip.css({visibility:"visible"}).hide()});api.onBeforeShow(function(){var c=this.getConf();this.getTip();setTimeout(function(){c.position=[orig[0],orig[1]],c.offset=[orig[2],orig[3]]},0)}),api.onHide(function(){var tip=this.getTip();tip.removeClass(conf.classNames)}),ret=api}),conf.api?ret:this}}(jQuery),function($){var t=$.tools.tooltip;$.extend(t.conf,{direction:"up",bounce:!1,slideOffset:10,slideInSpeed:200,slideOutSpeed:200,slideFade:!/msie/.test(navigator.userAgent.toLowerCase())});var dirs={up:["-","top"],down:["+","top"],left:["-","left"],right:["+","left"]};t.addEffect("slide",function(done){var conf=this.getConf(),tip=this.getTip(),params=conf.slideFade?{opacity:conf.opacity}:{},dir=dirs[conf.direction]||dirs.up;params[dir[1]]=dir[0]+"="+conf.slideOffset,conf.slideFade&&tip.css({opacity:0}),tip.show().animate(params,conf.slideInSpeed,done)},function(done){var conf=this.getConf(),offset=conf.slideOffset,params=conf.slideFade?{opacity:0}:{},dir=dirs[conf.direction]||dirs.up,sign=""+dir[0];conf.bounce&&(sign="+"==sign?"-":"+"),params[dir[1]]=sign+"="+offset,this.getTip().animate(params,conf.slideOutSpeed,function(){$(this).hide(),done.call()})})}(jQuery);
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.validator.min.js b/plone/app/jquerytools/browser/jquery.tools.validator.min.js
index 7c6953a..47fa188 100644
--- a/plone/app/jquerytools/browser/jquery.tools.validator.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.validator.min.js
@@ -1 +1 @@
-!function($){function getPosition(trigger,el,conf){el=$(el).first()||el;var top=trigger.offset().top,left=trigger.offset().left,pos=conf.position.split(/,?\s+/),y=pos[0],x=pos[1];top-=el.outerHeight()-conf.offset[0],left+=trigger.outerWidth()+conf.offset[1],/iPad/i.test(navigator.userAgent)&&(top-=$(window).scrollTop());var height=el.outerHeight()+trigger.outerHeight();"center"==y&&(top+=height/2),"bottom"==y&&(top+=height);var width=trigger.outerWidth();return"center"==x&&(left-=(width+el.outerWidth())/2),"left"==x&&(left-=width),{top:top,left:left}}function isType(type){function fn(){return this.getAttribute("type")==type}return fn.key='[type="'+type+'"]',fn}function Validator(inputs,form,conf){function pushMessage(to,matcher,returnValue){if(conf.grouped||!to.length){var msg;if(returnValue===!1||$.isArray(returnValue)){msg=v.messages[matcher.key||matcher]||v.messages["*"],msg=msg[conf.lang]||v.messages["*"].en;var matches=msg.match(/\$\d/g);matches&&$.isArray(returnValue)&&$.each(matches,function(i){msg=msg.replace(this,returnValue[i])})}else msg=returnValue[conf.lang]||returnValue;to.push(msg)}}var self=this,fire=form.add(self);inputs=inputs.not(":button, :image, :reset, :submit"),form.attr("novalidate","novalidate"),$.extend(self,{getConf:function(){return conf},getForm:function(){return form},getInputs:function(){return inputs},reflow:function(){return inputs.each(function(){var input=$(this),msg=input.data("msg.el");if(msg){var pos=getPosition(input,msg,conf);msg.css({top:pos.top,left:pos.left})}}),self},invalidate:function(errs,e){if(!e){var errors=[];$.each(errs,function(key,val){var input=inputs.filter("[name='"+key+"']");input.length&&(input.trigger("OI",[val]),errors.push({input:input,messages:[val]}))}),errs=errors,e=$.Event()}return e.type="onFail",fire.trigger(e,[errs]),e.isDefaultPrevented()||effects[conf.effect][0].call(self,errs,e),self},reset:function(els){return els=els||inputs,els.removeClass(conf.errorClass).each(function(){var msg=$(this).data("msg.el");msg&&(msg.remove(),$(this).data("msg.el",null))}).off(conf.errorInputEvent+".v"||""),self},destroy:function(){return form.off(conf.formEvent+".V reset.V"),inputs.off(conf.inputEvent+".V change.V"),self.reset()},checkValidity:function(els,e){els=els||inputs,els=els.not(":disabled");var names={};if(els=els.filter(function(){var name=$(this).attr("name");return names[name]?void 0:(names[name]=!0,$(this))}),!els.length)return!0;if(e=e||$.Event(),e.type="onBeforeValidate",fire.trigger(e,[els]),e.isDefaultPrevented())return e.result;var errs=[];els.each(function(){var msgs=[],el=$(this).data("messages",msgs),event=dateInput&&el.is(":date")?"onHide.v":conf.errorInputEvent+".v";return el.off(event),$.each(fns,function(){var fn=this,match=fn[0];if(el.filter(match).length){var returnValue=fn[1].call(self,el,el.val());if(returnValue!==!0){if(e.type="onBeforeFail",fire.trigger(e,[el,match]),e.isDefaultPrevented())return!1;var msg=el.attr(conf.messageAttr);if(msg)return msgs=[msg],!1;pushMessage(msgs,match,returnValue)}}}),msgs.length&&(errs.push({input:el,messages:msgs}),el.trigger("OI",[msgs]),conf.errorInputEvent&&el.on(event,function(e){self.checkValidity(el,e)})),conf.singleError&&errs.length?!1:void 0});var eff=effects[conf.effect];if(!eff)throw'Validator: cannot find effect "'+conf.effect+'"';return errs.length?(self.invalidate(errs,e),!1):(eff[1].call(self,els,e),e.type="onSuccess",fire.trigger(e,[els]),els.off(conf.errorInputEvent+".v"),!0)}}),$.each("onBeforeValidate,onBeforeFail,onFail,onSuccess".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.formEvent&&form.on(conf.formEvent+".V",function(e){return self.checkValidity(null,e)?(e.target=form,void(e.type=conf.formEvent)):e.preventDefault()}),form.on("reset.V",function(){self.reset()}),inputs[0]&&inputs[0].validity&&inputs.each(function(){this.oninvalid=function(){return!1}}),form[0]&&(form[0].checkValidity=self.checkValidity),conf.inputEvent&&inputs.on(conf.inputEvent+".V",function(e){self.checkValidity($(this),e)}),inputs.filter(":checkbox, select").filter("[required]").on("change.V",function(e){var el=$(this);(this.checked||el.is("select")&&$(this).val())&&effects[conf.effect][1].call(self,el,e)}),inputs.filter(":radio[required]").on("change.V",function(e){var els=$("[name='"+$(e.srcElement).attr("name")+"']");null!=els&&0!=els.length&&self.checkValidity(els,e)}),$(window).resize(function(){self.reflow()})}$.tools=$.tools||{version:"@VERSION"};var v,typeRe=/\[type=([a-z]+)\]/,numRe=/^-?[0-9]*(\.[0-9]+)?$/,dateInput=$.tools.dateinput,emailRe=/^([a-z0-9_\.\-\+]+)@([\da-z\.\-]+)\.([a-z\.]{2,6})$/i,urlRe=/^(https?:\/\/)?[\da-z\.\-]+\.[a-z\.]{2,6}[#&+_\?\/\w \.\-=]*$/i;v=$.tools.validator={conf:{grouped:!1,effect:"default",errorClass:"invalid",inputEvent:null,errorInputEvent:"keyup",formEvent:"submit",lang:"en",message:"<div/>",messageAttr:"data-message",messageClass:"error",offset:[0,0],position:"center right",singleError:!1,speed:"normal"},messages:{"*":{en:"Please correct this value"}},localize:function(lang,messages){$.each(messages,function(key,msg){v.messages[key]=v.messages[key]||{},v.messages[key][lang]=msg})},localizeFn:function(key,messages){v.messages[key]=v.messages[key]||{},$.extend(v.messages[key],messages)},fn:function(matcher,msg,fn){$.isFunction(msg)?fn=msg:("string"==typeof msg&&(msg={en:msg}),this.messages[matcher.key||matcher]=msg);var test=typeRe.exec(matcher);test&&(matcher=isType(test[1])),fns.push([matcher,fn])},addEffect:function(name,showFn,closeFn){effects[name]=[showFn,closeFn]}};var fns=[],effects={"default":[function(errs){var conf=this.getConf();$.each(errs,function(i,err){var input=err.input;input.addClass(conf.errorClass);var msg=input.data("msg.el");msg||(msg=$(conf.message).addClass(conf.messageClass).appendTo(document.body),input.data("msg.el",msg)),msg.css({visibility:"hidden"}).find("p").remove(),$.each(err.messages,function(i,m){$("<p/>").html(m).appendTo(msg)}),msg.outerWidth()==msg.parent().width()&&msg.add(msg.find("p")).css({display:"inline"});var pos=getPosition(input,msg,conf);msg.css({visibility:"visible",position:"absolute",top:pos.top,left:pos.left}).fadeIn(conf.speed)})},function(inputs){var conf=this.getConf();inputs.removeClass(conf.errorClass).each(function(){var msg=$(this).data("msg.el");msg&&msg.css({visibility:"hidden"})})}]};$.each("email,url,number".split(","),function(i,key){$.expr[":"][key]=function(el){return el.getAttribute("type")===key}}),$.fn.oninvalid=function(fn){return this[fn?"on":"trigger"]("OI",fn)},v.fn(":email","Please enter a valid email address",function(el,v){return!v||emailRe.test(v)}),v.fn(":url","Please enter a valid URL",function(el,v){return!v||urlRe.test(v)}),v.fn(":number","Please enter a numeric value.",function(el,v){return numRe.test(v)}),v.fn("[max]","Please enter a value no larger than $1",function(el,v){if(""===v||dateInput&&el.is(":date"))return!0;var max=el.attr("max");return parseFloat(v)<=parseFloat(max)?!0:[max]}),v.fn("[min]","Please enter a value of at least $1",function(el,v){if(""===v||dateInput&&el.is(":date"))return!0;var min=el.attr("min");return parseFloat(v)>=parseFloat(min)?!0:[min]}),v.fn("[required]","Please complete this mandatory field.",function(el,v){return el.is(":checkbox")?el.is(":checked"):!!v}),v.fn("[pattern]",function(el,v){return""===v||new RegExp("^"+el.attr("pattern")+"$").test(v)}),v.fn(":radio[required]","Please select an option.",function(el){{var checked=!1;$("[name='"+el.attr("name")+"']").each(function(i,el){($(el).is(":checked")||checked)&&(checked=!0)})}return checked?!0:!1}),$.fn.validator=function(conf){var instance=this.data("validator");return instance&&(instance.destroy(),this.removeData("validator")),conf=$.extend(!0,{},v.conf,conf),this.is("form")?this.each(function(){var form=$(this);instance=new Validator(form.find(":input"),form,conf),form.data("validator",instance)}):(instance=new Validator(this,this.eq(0).closest("form"),conf),this.data("validator",instance))}}(jQuery);
\ No newline at end of file
+!function($){function getPosition(trigger,el,conf){el=$(el).first()||el;var top=trigger.offset().top,left=trigger.offset().left,pos=conf.position.split(/,?\s+/),y=pos[0],x=pos[1];top-=el.outerHeight()-conf.offset[0],left+=trigger.outerWidth()+conf.offset[1],/iPad/i.test(navigator.userAgent)&&(top-=$(window).scrollTop());var height=el.outerHeight()+trigger.outerHeight();"center"==y&&(top+=height/2),"bottom"==y&&(top+=height);var width=trigger.outerWidth();return"center"==x&&(left-=(width+el.outerWidth())/2),"left"==x&&(left-=width),{top:top,left:left}}function isType(type){function fn(){return this.getAttribute("type")==type}return fn.key='[type="'+type+'"]',fn}function Validator(inputs,form,conf){function pushMessage(to,matcher,returnValue){if(conf.grouped||!to.length){var msg;if(returnValue===!1||$.isArray(returnValue)){msg=v.messages[matcher.key||matcher]||v.messages["*"],msg=msg[conf.lang]||v.messages["*"].en;var matches=msg.match(/\$\d/g);matches&&$.isArray(returnValue)&&$.each(matches,function(i){msg=msg.replace(this,returnValue[i])})}else msg=returnValue[conf.lang]||returnValue;to.push(msg)}}var self=this,fire=form.add(self);inputs=inputs.not(":button, :image, :reset, :submit"),form.attr("novalidate","novalidate"),$.extend(self,{getConf:function(){return conf},getForm:function(){return form},getInputs:function(){return inputs},reflow:function(){return inputs.each(function(){var input=$(this),msg=input.data("msg.el");if(msg){var pos=getPosition(input,msg,conf);msg.css({top:pos.top,left:pos.left})}}),self},invalidate:function(errs,e){if(!e){var errors=[];$.each(errs,function(key,val){var input=inputs.filter("[name='"+key+"']");input.length&&(input.trigger("OI",[val]),errors.push({input:input,messages:[val]}))}),errs=errors,e=$.Event()}return e.type="onFail",fire.trigger(e,[errs]),e.isDefaultPrevented()||effects[conf.effect][0].call(self,errs,e),self},reset:function(els){return els=els||inputs,els.removeClass(conf.errorClass).each(function(){var msg=$(this).data("msg.el");msg&&(msg.remove(),$(this).data("msg.el",null))}).off(conf.errorInputEvent+".v"||""),self},destroy:function(){return form.off(conf.formEvent+".V reset.V"),inputs.off(conf.inputEvent+".V change.V"),self.reset()},checkValidity:function(els,e){els=els||inputs,els=els.not(":disabled");var names={};if(els=els.filter(function(){var name=$(this).attr("name");if(!names[name])return names[name]=!0,$(this)}),!els.length)return!0;if(e=e||$.Event(),e.type="onBeforeValidate",fire.trigger(e,[els]),e.isDefaultPrevented())return e.result;var errs=[];els.each(function(){var msgs=[],el=$(this).data("messages",msgs),event=dateInput&&el.is(":date")?"onHide.v":conf.errorInputEvent+".v";if(el.off(event),$.each(fns,function(){var fn=this,match=fn[0];if(el.filter(match).length){var returnValue=fn[1].call(self,el,el.val());if(returnValue!==!0){if(e.type="onBeforeFail",fire.trigger(e,[el,match]),e.isDefaultPrevented())return!1;var msg=el.attr(conf.messageAttr);if(msg)return msgs=[msg],!1;pushMessage(msgs,match,returnValue)}}}),msgs.length&&(errs.push({input:el,messages:msgs}),el.trigger("OI",[msgs]),conf.errorInputEvent&&el.on(event,function(e){self.checkValidity(el,e)})),conf.singleError&&errs.length)return!1});var eff=effects[conf.effect];if(!eff)throw'Validator: cannot find effect "'+conf.effect+'"';return errs.length?(self.invalidate(errs,e),!1):(eff[1].call(self,els,e),e.type="onSuccess",fire.trigger(e,[els]),els.off(conf.errorInputEvent+".v"),!0)}}),$.each("onBeforeValidate,onBeforeFail,onFail,onSuccess".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.formEvent&&form.on(conf.formEvent+".V",function(e){return self.checkValidity(null,e)?(e.target=form,void(e.type=conf.formEvent)):e.preventDefault()}),form.on("reset.V",function(){self.reset()}),inputs[0]&&inputs[0].validity&&inputs.each(function(){this.oninvalid=function(){return!1}}),form[0]&&(form[0].checkValidity=self.checkValidity),conf.inputEvent&&inputs.on(conf.inputEvent+".V",function(e){self.checkValidity($(this),e)}),inputs.filter(":checkbox, select").filter("[required]").on("change.V",function(e){var el=$(this);(this.checked||el.is("select")&&$(this).val())&&effects[conf.effect][1].call(self,el,e)}),inputs.filter(":radio[required]").on("change.V",function(e){var els=$("[name='"+$(e.srcElement).attr("name")+"']");null!=els&&0!=els.length&&self.checkValidity(els,e)}),$(window).resize(function(){self.reflow()})}$.tools=$.tools||{version:"@VERSION"};var v,typeRe=/\[type=([a-z]+)\]/,numRe=/^-?[0-9]*(\.[0-9]+)?$/,dateInput=$.tools.dateinput,emailRe=/^([a-z0-9_\.\-\+]+)@([\da-z\.\-]+)\.([a-z\.]{2,6})$/i,urlRe=/^(https?:\/\/)?[\da-z\.\-]+\.[a-z\.]{2,6}[#&+_\?\/\w \.\-=]*$/i;v=$.tools.validator={conf:{grouped:!1,effect:"default",errorClass:"invalid",inputEvent:null,errorInputEvent:"keyup",formEvent:"submit",lang:"en",message:"<div/>",messageAttr:"data-message",messageClass:"error",offset:[0,0],position:"center right",singleError:!1,speed:"normal"},messages:{"*":{en:"Please correct this value"}},localize:function(lang,messages){$.each(messages,function(key,msg){v.messages[key]=v.messages[key]||{},v.messages[key][lang]=msg})},localizeFn:function(key,messages){v.messages[key]=v.messages[key]||{},$.extend(v.messages[key],messages)},fn:function(matcher,msg,fn){$.isFunction(msg)?fn=msg:("string"==typeof msg&&(msg={en:msg}),this.messages[matcher.key||matcher]=msg);var test=typeRe.exec(matcher);test&&(matcher=isType(test[1])),fns.push([matcher,fn])},addEffect:function(name,showFn,closeFn){effects[name]=[showFn,closeFn]}};var fns=[],effects={default:[function(errs){var conf=this.getConf();$.each(errs,function(i,err){var input=err.input;input.addClass(conf.errorClass);var msg=input.data("msg.el");msg||(msg=$(conf.message).addClass(conf.messageClass).appendTo(document.body),input.data("msg.el",msg)),msg.css({visibility:"hidden"}).find("p").remove(),$.each(err.messages,function(i,m){$("<p/>").html(m).appendTo(msg)}),msg.outerWidth()==msg.parent().width()&&msg.add(msg.find("p")).css({display:"inline"});var pos=getPosition(input,msg,conf);msg.css({visibility:"visible",position:"absolute",top:pos.top,left:pos.left}).fadeIn(conf.speed)})},function(inputs){var conf=this.getConf();inputs.removeClass(conf.errorClass).each(function(){var msg=$(this).data("msg.el");msg&&msg.css({visibility:"hidden"})})}]};$.each("email,url,number".split(","),function(i,key){$.expr[":"][key]=function(el){return el.getAttribute("type")===key}}),$.fn.oninvalid=function(fn){return this[fn?"on":"trigger"]("OI",fn)},v.fn(":email","Please enter a valid email address",function(el,v){return!v||emailRe.test(v)}),v.fn(":url","Please enter a valid URL",function(el,v){return!v||urlRe.test(v)}),v.fn(":number","Please enter a numeric value.",function(el,v){return numRe.test(v)}),v.fn("[max]","Please enter a value no larger than $1",function(el,v){if(""===v||dateInput&&el.is(":date"))return!0;var max=el.attr("max");return parseFloat(v)<=parseFloat(max)||[max]}),v.fn("[min]","Please enter a value of at least $1",function(el,v){if(""===v||dateInput&&el.is(":date"))return!0;var min=el.attr("min");return parseFloat(v)>=parseFloat(min)||[min]}),v.fn("[required]","Please complete this mandatory field.",function(el,v){return el.is(":checkbox")?el.is(":checked"):!!v}),v.fn("[pattern]",function(el,v){return""===v||new RegExp("^"+el.attr("pattern")+"$").test(v)}),v.fn(":radio[required]","Please select an option.",function(el){var checked=!1;$("[name='"+el.attr("name")+"']").each(function(i,el){($(el).is(":checked")||checked)&&(checked=!0)});return!!checked}),$.fn.validator=function(conf){var instance=this.data("validator");return instance&&(instance.destroy(),this.removeData("validator")),conf=$.extend(!0,{},v.conf,conf),this.is("form")?this.each(function(){var form=$(this);instance=new Validator(form.find(":input"),form,conf),form.data("validator",instance)}):(instance=new Validator(this,this.eq(0).closest("form"),conf),this.data("validator",instance))}}(jQuery);
\ No newline at end of file


Repository: plone.app.jquerytools


Branch: refs/heads/master
Date: 2017-02-08T14:52:13+01:00
Author: Marc Sommerhalder (msom) <marc.sommerhalder@seantis.ch>
Commit: https://github.com/plone/plone.app.jquerytools/commit/e4ab77ac20ae9be7b46aa25affc50ddfa5bed66f

Update changelog

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 715b094..0dc26d2 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -6,13 +6,9 @@ Changelog
 
 Bug fixes:
 
-- Fix for dotted path form ids.
-  [malsup]
-
-- Fix initaliziation of minimum and maximum dates in dateinput.
+- Updated jquery.form and jquery.tools to latest versions.
   [msom]
 
-
 1.9.0 (2016-12-02)
 ------------------
 


Repository: plone.app.jquerytools


Branch: refs/heads/master
Date: 2017-03-20T11:06:14+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.jquerytools/commit/bf1792be3c35dfe81598ebc8226ac228c0e2179c

Merge pull request #15 from seantis/master

Use latest versions of jquery.form and jquery.tools

Files changed:
M CHANGES.rst
M plone/app/jquerytools/browser/jquery.form.js
M plone/app/jquerytools/browser/jquery.form.min.js
M plone/app/jquerytools/browser/jquery.tools.dateinput.js
M plone/app/jquerytools/browser/jquery.tools.dateinput.min.js
M plone/app/jquerytools/browser/jquery.tools.min.js
M plone/app/jquerytools/browser/jquery.tools.plugins.min.js
M plone/app/jquerytools/browser/jquery.tools.rangeinput.min.js
M plone/app/jquerytools/browser/jquery.tools.tooltip.min.js
M plone/app/jquerytools/browser/jquery.tools.tooltip.plugins.min.js
M plone/app/jquerytools/browser/jquery.tools.validator.min.js

diff --git a/CHANGES.rst b/CHANGES.rst
index 8c8c1ad..0dc26d2 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -4,18 +4,10 @@ Changelog
 1.9.1 (unreleased)
 ------------------
 
-Breaking changes:
-
-- *add item here*
-
-New features:
-
-- *add item here*
-
 Bug fixes:
 
-- *add item here*
-
+- Updated jquery.form and jquery.tools to latest versions.
+  [msom]
 
 1.9.0 (2016-12-02)
 ------------------
@@ -27,7 +19,6 @@ New features:
   [petri]
 
 
-
 1.8.0 (2016-08-12)
 ------------------
 
diff --git a/plone/app/jquerytools/browser/jquery.form.js b/plone/app/jquerytools/browser/jquery.form.js
index 0a606c0..591ad6f 100644
--- a/plone/app/jquerytools/browser/jquery.form.js
+++ b/plone/app/jquerytools/browser/jquery.form.js
@@ -10,6 +10,21 @@
  */
 /*global ActiveXObject */
 
+// AMD support
+(function (factory) {
+    "use strict";
+    if (typeof define === 'function' && define.amd) {
+        // using AMD; register as anon module
+        define(['jquery'], factory);
+    } else {
+        // no AMD; invoke directly
+        factory( (typeof(jQuery) != 'undefined') ? jQuery : window.Zepto );
+    }
+}
+
+(function($) {
+"use strict";
+
 /*
     Usage Note:
     -----------
@@ -47,8 +62,6 @@
     at the appropriate time.
 */
 
-(function($) {
-
 /**
  * Feature detection
  */
@@ -1261,4 +1274,4 @@ function log() {
     }
 }
 
-}(jQuery));
+}));
diff --git a/plone/app/jquerytools/browser/jquery.form.min.js b/plone/app/jquerytools/browser/jquery.form.min.js
index c2e9cae..0b2bab8 100644
--- a/plone/app/jquerytools/browser/jquery.form.min.js
+++ b/plone/app/jquerytools/browser/jquery.form.min.js
@@ -1 +1 @@
-!function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):factory("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function($){"use strict";function doAjaxSubmit(e){var options=e.data;e.isDefaultPrevented()||(e.preventDefault(),$(e.target).ajaxSubmit(options))}function captureSubmittingElement(e){var target=e.target,$el=$(target);if(!$el.is("[type=submit],[type=image]")){var t=$el.closest("[type=submit]");if(0===t.length)return;target=t[0]}var form=this;if(form.clk=target,"image"==target.type)if(void 0!==e.offsetX)form.clk_x=e.offsetX,form.clk_y=e.offsetY;else if("function"==typeof $.fn.offset){var offset=$el.offset();form.clk_x=e.pageX-offset.left,form.clk_y=e.pageY-offset.top}else form.clk_x=e.pageX-target.offsetLeft,form.clk_y=e.pageY-target.offsetTop;setTimeout(function(){form.clk=form.clk_x=form.clk_y=null},100)}function log(){if($.fn.ajaxSubmit.debug){var msg="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(msg):window.opera&&window.opera.postError&&window.opera.postError(msg)}}var feature={};feature.fileapi=void 0!==$("<input type='file'/>").get(0).files,feature.formdata=void 0!==window.FormData;var hasProp=!!$.fn.prop;$.fn.attr2=function(){if(!hasProp)return this.attr.apply(this,arguments);var val=this.prop.apply(this,arguments);return val&&val.jquery||"string"==typeof val?val:this.attr.apply(this,arguments)},$.fn.ajaxSubmit=function(options){function deepSerialize(extraData){var i,part,serialized=$.param(extraData,options.traditional).split("&"),len=serialized.length,result=[];for(i=0;len>i;i++)serialized[i]=serialized[i].replace(/\+/g," "),part=serialized[i].split("="),result.push([decodeURIComponent(part[0]),decodeURIComponent(part[1])]);return result}function fileUploadXhr(a){for(var formdata=new FormData,i=0;i<a.length;i++)formdata.append(a[i].name,a[i].value);if(options.extraData){var serializedData=deepSerialize(options.extraData);for(i=0;i<serializedData.length;i++)serializedData[i]&&formdata.append(serializedData[i][0],serializedData[i][1])}options.data=null;var s=$.extend(!0,{},$.ajaxSettings,options,{contentType:!1,processData:!1,cache:!1,type:method||"POST"});options.uploadProgress&&(s.xhr=function(){var xhr=$.ajaxSettings.xhr();return xhr.upload&&xhr.upload.addEventListener("progress",function(event){var percent=0,position=event.loaded||event.position,total=event.total;event.lengthComputable&&(percent=Math.ceil(position/total*100)),options.uploadProgress(event,position,total,percent)},!1),xhr}),s.data=null;var beforeSend=s.beforeSend;return s.beforeSend=function(xhr,o){o.data=options.formData?options.formData:formdata,beforeSend&&beforeSend.call(this,xhr,o)},$.ajax(s)}function fileUploadIframe(a){function getDoc(frame){var doc=null;try{frame.contentWindow&&(doc=frame.contentWindow.document)}catch(err){log("cannot get iframe.contentWindow document: "+err)}if(doc)return doc;try{doc=frame.contentDocument?frame.contentDocument:frame.document}catch(err){log("cannot get iframe.contentDocument: "+err),doc=frame.document}return doc}function doSubmit(){function checkState(){try{var state=getDoc(io).readyState;log("state = "+state),state&&"uninitialized"==state.toLowerCase()&&setTimeout(checkState,50)}catch(e){log("Server abort: ",e," (",e.name,")"),cb(SERVER_ABORT),timeoutHandle&&clearTimeout(timeoutHandle),timeoutHandle=void 0}}var t=$form.attr2("target"),a=$form.attr2("action"),mp="multipart/form-data",et=$form.attr("enctype")||$form.attr("encoding")||mp;form.setAttribute("target",id),(!method||/post/i.test(method))&&form.setAttribute("method","POST"),a!=s.url&&form.setAttribute("action",s.url),s.skipEncodingOverride||method&&!/post/i.test(method)||$form.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),s.timeout&&(timeoutHandle=setTimeout(function(){timedOut=!0,cb(CLIENT_TIMEOUT_ABORT)},s.timeout));var extraInputs=[];try{if(s.extraData)for(var n in s.extraData)s.extraData.hasOwnProperty(n)&&extraInputs.push($.isPlainObject(s.extraData[n])&&s.extraData[n].hasOwnProperty("name")&&s.extraData[n].hasOwnProperty("value")?$('<input type="hidden" name="'+s.extraData[n].name+'">').val(s.extraData[n].value).appendTo(form)[0]:$('<input type="hidden" name="'+n+'">').val(s.extraData[n]).appendTo(form)[0]);s.iframeTarget||$io.appendTo("body"),io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,!1),setTimeout(checkState,15);try{form.submit()}catch(err){var submitFn=document.createElement("form").submit;submitFn.apply(form)}}finally{form.setAttribute("action",a),form.setAttribute("enctype",et),t?form.setAttribute("target",t):$form.removeAttr("target"),$(extraInputs).remove()}}function cb(e){if(!xhr.aborted&&!callbackProcessed){if(doc=getDoc(io),doc||(log("cannot access response document"),e=SERVER_ABORT),e===CLIENT_TIMEOUT_ABORT&&xhr)return xhr.abort("timeout"),void deferred.reject(xhr,"timeout");if(e==SERVER_ABORT&&xhr)return xhr.abort("server abort"),void deferred.reject(xhr,"error","server abort");if(doc&&doc.location.href!=s.iframeSrc||timedOut){io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",cb,!1);var errMsg,status="success";try{if(timedOut)throw"timeout";var isXml="xml"==s.dataType||doc.XMLDocument||$.isXMLDoc(doc);if(log("isXml="+isXml),!isXml&&window.opera&&(null===doc.body||!doc.body.innerHTML)&&--domCheckCount)return log("requeing onLoad callback, DOM not available"),void setTimeout(cb,250);var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null,xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc,isXml&&(s.dataType="xml"),xhr.getResponseHeader=function(header){var headers={"content-type":s.dataType};return headers[header.toLowerCase()]},docRoot&&(xhr.status=Number(docRoot.getAttribute("status"))||xhr.status,xhr.statusText=docRoot.getAttribute("statusText")||xhr.statusText);var dt=(s.dataType||"").toLowerCase(),scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName("textarea")[0];if(ta)xhr.responseText=ta.value,xhr.status=Number(ta.getAttribute("status"))||xhr.status,xhr.statusText=ta.getAttribute("statusText")||xhr.statusText;else if(scr){var pre=doc.getElementsByTagName("pre")[0],b=doc.getElementsByTagName("body")[0];pre?xhr.responseText=pre.textContent?pre.textContent:pre.innerText:b&&(xhr.responseText=b.textContent?b.textContent:b.innerText)}}else"xml"==dt&&!xhr.responseXML&&xhr.responseText&&(xhr.responseXML=toXml(xhr.responseText));try{data=httpData(xhr,dt,s)}catch(err){status="parsererror",xhr.error=errMsg=err||status}}catch(err){log("error caught: ",err),status="error",xhr.error=errMsg=err||status}xhr.aborted&&(log("upload aborted"),status=null),xhr.status&&(status=xhr.status>=200&&xhr.status<300||304===xhr.status?"success":"error"),"success"===status?(s.success&&s.success.call(s.context,data,"success",xhr),deferred.resolve(xhr.responseText,"success",xhr),g&&$.event.trigger("ajaxSuccess",[xhr,s])):status&&(void 0===errMsg&&(errMsg=xhr.statusText),s.error&&s.error.call(s.context,xhr,status,errMsg),deferred.reject(xhr,"error",errMsg),g&&$.event.trigger("ajaxError",[xhr,s,errMsg])),g&&$.event.trigger("ajaxComplete",[xhr,s]),g&&!--$.active&&$.event.trigger("ajaxStop"),s.complete&&s.complete.call(s.context,xhr,status),callbackProcessed=!0,s.timeout&&clearTimeout(timeoutHandle),setTimeout(function(){s.iframeTarget?$io.attr("src",s.iframeSrc):$io.remove(),xhr.responseXML=null},100)}}}var el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle,form=$form[0],deferred=$.Deferred();if(deferred.abort=function(status){xhr.abort(status)},a)for(i=0;i<elements.length;i++)el=$(elements[i]),hasProp?el.prop("disabled",!1):el.removeAttr("disabled");if(s=$.extend(!0,{},$.ajaxSettings,options),s.context=s.context||s,id="jqFormIO"+(new Date).getTime(),s.iframeTarget?($io=$(s.iframeTarget),n=$io.attr2("name"),n?id=n:$io.attr2("name",id)):($io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />'),$io.css({position:"absolute",top:"-1000px",left:"-1000px"})),io=$io[0],xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e="timeout"===status?"timeout":"aborted";log("aborting upload... "+e),this.aborted=1;try{io.contentWindow.document.execCommand&&io.contentWindow.document.execCommand("Stop")}catch(ignore){}$io.attr("src",s.iframeSrc),xhr.error=e,s.error&&s.error.call(s.context,xhr,e,status),g&&$.event.trigger("ajaxError",[xhr,s,e]),s.complete&&s.complete.call(s.context,xhr,e)}},g=s.global,g&&0===$.active++&&$.event.trigger("ajaxStart"),g&&$.event.trigger("ajaxSend",[xhr,s]),s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===!1)return s.global&&$.active--,deferred.reject(),deferred;if(xhr.aborted)return deferred.reject(),deferred;sub=form.clk,sub&&(n=sub.name,n&&!sub.disabled&&(s.extraData=s.extraData||{},s.extraData[n]=sub.value,"image"==sub.type&&(s.extraData[n+".x"]=form.clk_x,s.extraData[n+".y"]=form.clk_y)));var CLIENT_TIMEOUT_ABORT=1,SERVER_ABORT=2,csrf_token=$("meta[name=csrf-token]").attr("content"),csrf_param=$("meta[name=csrf-param]").attr("content");csrf_param&&csrf_token&&(s.extraData=s.extraData||{},s.extraData[csrf_param]=csrf_token),s.forceSync?doSubmit():setTimeout(doSubmit,10);var data,doc,callbackProcessed,domCheckCount=50,toXml=$.parseXML||function(s,doc){return window.ActiveXObject?(doc=new ActiveXObject("Microsoft.XMLDOM"),doc.async="false",doc.loadXML(s)):doc=(new DOMParser).parseFromString(s,"text/xml"),doc&&doc.documentElement&&"parsererror"!=doc.documentElement.nodeName?doc:null},parseJSON=$.parseJSON||function(s){return window.eval("("+s+")")},httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type")||"",xml="xml"===type||!type&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;return xml&&"parsererror"===data.documentElement.nodeName&&$.error&&$.error("parsererror"),s&&s.dataFilter&&(data=s.dataFilter(data,type)),"string"==typeof data&&("json"===type||!type&&ct.indexOf("json")>=0?data=parseJSON(data):("script"===type||!type&&ct.indexOf("javascript")>=0)&&$.globalEval(data)),data};return deferred}if(!this.length)return log("ajaxSubmit: skipping submit process - no element selected"),this;var method,action,url,$form=this;"function"==typeof options?options={success:options}:void 0===options&&(options={}),method=options.type||this.attr2("method"),action=options.url||this.attr2("action"),url="string"==typeof action?$.trim(action):"",url=url||window.location.href||"",url&&(url=(url.match(/^([^#]+)/)||[])[1]),options=$.extend(!0,{url:url,success:$.ajaxSettings.success,type:method||$.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},options);var veto={};if(this.trigger("form-pre-serialize",[this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(options.beforeSerialize&&options.beforeSerialize(this,options)===!1)return log("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var traditional=options.traditional;void 0===traditional&&(traditional=$.ajaxSettings.traditional);var qx,elements=[],a=this.formToArray(options.semantic,elements);if(options.data&&(options.extraData=options.data,qx=$.param(options.data,traditional)),options.beforeSubmit&&options.beforeSubmit(a,this,options)===!1)return log("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[a,this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var q=$.param(a,traditional);qx&&(q=q?q+"&"+qx:qx),"GET"==options.type.toUpperCase()?(options.url+=(options.url.indexOf("?")>=0?"&":"?")+q,options.data=null):options.data=q;var callbacks=[];if(options.resetForm&&callbacks.push(function(){$form.resetForm()}),options.clearForm&&callbacks.push(function(){$form.clearForm(options.includeHidden)}),!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?"replaceWith":"html";$(options.target)[fn](data).each(oldSuccess,arguments)})}else options.success&&callbacks.push(options.success);if(options.success=function(data,status,xhr){for(var context=options.context||this,i=0,max=callbacks.length;max>i;i++)callbacks[i].apply(context,[data,status,xhr||$form,$form])},options.error){var oldError=options.error;options.error=function(xhr,status,error){var context=options.context||this;oldError.apply(context,[xhr,status,error,$form])}}if(options.complete){var oldComplete=options.complete;options.complete=function(xhr,status){var context=options.context||this;oldComplete.apply(context,[xhr,status,$form])}}var fileInputs=$("input[type=file]:enabled",this).filter(function(){return""!==$(this).val()}),hasFileInputs=fileInputs.length>0,mp="multipart/form-data",multipart=$form.attr("enctype")==mp||$form.attr("encoding")==mp,fileAPI=feature.fileapi&&feature.formdata;log("fileAPI :"+fileAPI);var jqxhr,shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;options.iframe!==!1&&(options.iframe||shouldUseFrame)?options.closeKeepAlive?$.get(options.closeKeepAlive,function(){jqxhr=fileUploadIframe(a)}):jqxhr=fileUploadIframe(a):jqxhr=(hasFileInputs||multipart)&&fileAPI?fileUploadXhr(a):$.ajax(options),$form.removeData("jqxhr").data("jqxhr",jqxhr);for(var k=0;k<elements.length;k++)elements[k]=null;return this.trigger("form-submit-notify",[this,options]),this},$.fn.ajaxForm=function(options){if(options=options||{},options.delegation=options.delegation&&$.isFunction($.fn.on),!options.delegation&&0===this.length){var o={s:this.selector,c:this.context};return!$.isReady&&o.s?(log("DOM not ready, queuing ajaxForm"),$(function(){$(o.s,o.c).ajaxForm(options)}),this):(log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)")),this)}return options.delegation?($(document).off("submit.form-plugin",this.selector,doAjaxSubmit).off("click.form-plugin",this.selector,captureSubmittingElement).on("submit.form-plugin",this.selector,options,doAjaxSubmit).on("click.form-plugin",this.selector,options,captureSubmittingElement),this):this.ajaxFormUnbind().bind("submit.form-plugin",options,doAjaxSubmit).bind("click.form-plugin",options,captureSubmittingElement)},$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},$.fn.formToArray=function(semantic,elements){var a=[];if(0===this.length)return a;var els2,form=this[0],formId=this.attr("id"),els=semantic?form.getElementsByTagName("*"):form.elements;if(els&&!/MSIE [678]/.test(navigator.userAgent)&&(els=$(els).get()),formId&&(els2=$(':input[form="'+formId+'"]').get(),els2.length&&(els=(els||[]).concat(els2))),!els||!els.length)return a;var i,j,n,v,el,max,jmax;for(i=0,max=els.length;max>i;i++)if(el=els[i],n=el.name,n&&!el.disabled)if(semantic&&form.clk&&"image"==el.type)form.clk==el&&(a.push({name:n,value:$(el).val(),type:el.type}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}));else if(v=$.fieldValue(el,!0),v&&v.constructor==Array)for(elements&&elements.push(el),j=0,jmax=v.length;jmax>j;j++)a.push({name:n,value:v[j]});else if(feature.fileapi&&"file"==el.type){elements&&elements.push(el);var files=el.files;if(files.length)for(j=0;j<files.length;j++)a.push({name:n,value:files[j],type:el.type});else a.push({name:n,value:"",type:el.type})}else null!==v&&"undefined"!=typeof v&&(elements&&elements.push(el),a.push({name:n,value:v,type:el.type,required:el.required}));if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name,n&&!input.disabled&&"image"==input.type&&(a.push({name:n,value:$input.val()}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}))}return a},$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))},$.fn.fieldSerialize=function(successful){var a=[];return this.each(function(){var n=this.name;if(n){var v=$.fieldValue(this,successful);if(v&&v.constructor==Array)for(var i=0,max=v.length;max>i;i++)a.push({name:n,value:v[i]});else null!==v&&"undefined"!=typeof v&&a.push({name:this.name,value:v})}}),$.param(a)},$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;max>i;i++){var el=this[i],v=$.fieldValue(el,successful);null===v||"undefined"==typeof v||v.constructor==Array&&!v.length||(v.constructor==Array?$.merge(val,v):val.push(v))}return val},$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(void 0===successful&&(successful=!0),successful&&(!n||el.disabled||"reset"==t||"button"==t||("checkbox"==t||"radio"==t)&&!el.checked||("submit"==t||"image"==t)&&el.form&&el.form.clk!=el||"select"==tag&&-1==el.selectedIndex))return null;if("select"==tag){var index=el.selectedIndex;if(0>index)return null;for(var a=[],ops=el.options,one="select-one"==t,max=one?index+1:ops.length,i=one?index:0;max>i;i++){var op=ops[i];if(op.selected){var v=op.value;if(v||(v=op.attributes&&op.attributes.value&&!op.attributes.value.specified?op.text:op.value),one)return v;a.push(v)}}return a}return $(el).val()},$.fn.clearForm=function(includeHidden){return this.each(function(){$("input,select,textarea",this).clearFields(includeHidden)})},$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();re.test(t)||"textarea"==tag?this.value="":"checkbox"==t||"radio"==t?this.checked=!1:"select"==tag?this.selectedIndex=-1:"file"==t?/MSIE/.test(navigator.userAgent)?$(this).replaceWith($(this).clone(!0)):$(this).val(""):includeHidden&&(includeHidden===!0&&/hidden/.test(t)||"string"==typeof includeHidden&&$(this).is(includeHidden))&&(this.value="")})},$.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},$.fn.enable=function(b){return void 0===b&&(b=!0),this.each(function(){this.disabled=!b})},$.fn.selected=function(select){return void 0===select&&(select=!0),this.each(function(){var t=this.type;if("checkbox"==t||"radio"==t)this.checked=select;else if("option"==this.tagName.toLowerCase()){var $sel=$(this).parent("select");select&&$sel[0]&&"select-one"==$sel[0].type&&$sel.find("option").selected(!1),this.selected=select}})},$.fn.ajaxSubmit.debug=!1});
\ No newline at end of file
+!function(factory){"use strict";"function"==typeof define&&define.amd?define(["jquery"],factory):factory("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function($){"use strict";function doAjaxSubmit(e){var options=e.data;e.isDefaultPrevented()||(e.preventDefault(),$(e.target).ajaxSubmit(options))}function captureSubmittingElement(e){var target=e.target,$el=$(target);if(!$el.is("[type=submit],[type=image]")){var t=$el.closest("[type=submit]");if(0===t.length)return;target=t[0]}var form=this;if(form.clk=target,"image"==target.type)if(void 0!==e.offsetX)form.clk_x=e.offsetX,form.clk_y=e.offsetY;else if("function"==typeof $.fn.offset){var offset=$el.offset();form.clk_x=e.pageX-offset.left,form.clk_y=e.pageY-offset.top}else form.clk_x=e.pageX-target.offsetLeft,form.clk_y=e.pageY-target.offsetTop;setTimeout(function(){form.clk=form.clk_x=form.clk_y=null},100)}function log(){if($.fn.ajaxSubmit.debug){var msg="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(msg):window.opera&&window.opera.postError&&window.opera.postError(msg)}}var feature={};feature.fileapi=void 0!==$("<input type='file'/>").get(0).files,feature.formdata=void 0!==window.FormData;var hasProp=!!$.fn.prop;$.fn.attr2=function(){if(!hasProp)return this.attr.apply(this,arguments);var val=this.prop.apply(this,arguments);return val&&val.jquery||"string"==typeof val?val:this.attr.apply(this,arguments)},$.fn.ajaxSubmit=function(options){function deepSerialize(extraData){var i,part,serialized=$.param(extraData,options.traditional).split("&"),len=serialized.length,result=[];for(i=0;i<len;i++)serialized[i]=serialized[i].replace(/\+/g," "),part=serialized[i].split("="),result.push([decodeURIComponent(part[0]),decodeURIComponent(part[1])]);return result}function fileUploadXhr(a){for(var formdata=new FormData,i=0;i<a.length;i++)formdata.append(a[i].name,a[i].value);if(options.extraData){var serializedData=deepSerialize(options.extraData);for(i=0;i<serializedData.length;i++)serializedData[i]&&formdata.append(serializedData[i][0],serializedData[i][1])}options.data=null;var s=$.extend(!0,{},$.ajaxSettings,options,{contentType:!1,processData:!1,cache:!1,type:method||"POST"});options.uploadProgress&&(s.xhr=function(){var xhr=$.ajaxSettings.xhr();return xhr.upload&&xhr.upload.addEventListener("progress",function(event){var percent=0,position=event.loaded||event.position,total=event.total;event.lengthComputable&&(percent=Math.ceil(position/total*100)),options.uploadProgress(event,position,total,percent)},!1),xhr}),s.data=null;var beforeSend=s.beforeSend;return s.beforeSend=function(xhr,o){options.formData?o.data=options.formData:o.data=formdata,beforeSend&&beforeSend.call(this,xhr,o)},$.ajax(s)}function fileUploadIframe(a){function getDoc(frame){var doc=null;try{frame.contentWindow&&(doc=frame.contentWindow.document)}catch(err){log("cannot get iframe.contentWindow document: "+err)}if(doc)return doc;try{doc=frame.contentDocument?frame.contentDocument:frame.document}catch(err){log("cannot get iframe.contentDocument: "+err),doc=frame.document}return doc}function doSubmit(){function checkState(){try{var state=getDoc(io).readyState;log("state = "+state),state&&"uninitialized"==state.toLowerCase()&&setTimeout(checkState,50)}catch(e){log("Server abort: ",e," (",e.name,")"),cb(SERVER_ABORT),timeoutHandle&&clearTimeout(timeoutHandle),timeoutHandle=void 0}}var t=$form.attr2("target"),a=$form.attr2("action"),mp="multipart/form-data",et=$form.attr("enctype")||$form.attr("encoding")||mp;form.setAttribute("target",id),method&&!/post/i.test(method)||form.setAttribute("method","POST"),a!=s.url&&form.setAttribute("action",s.url),s.skipEncodingOverride||method&&!/post/i.test(method)||$form.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),s.timeout&&(timeoutHandle=setTimeout(function(){timedOut=!0,cb(CLIENT_TIMEOUT_ABORT)},s.timeout));var extraInputs=[];try{if(s.extraData)for(var n in s.extraData)s.extraData.hasOwnProperty(n)&&($.isPlainObject(s.extraData[n])&&s.extraData[n].hasOwnProperty("name")&&s.extraData[n].hasOwnProperty("value")?extraInputs.push($('<input type="hidden" name="'+s.extraData[n].name+'">').val(s.extraData[n].value).appendTo(form)[0]):extraInputs.push($('<input type="hidden" name="'+n+'">').val(s.extraData[n]).appendTo(form)[0]));s.iframeTarget||$io.appendTo("body"),io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,!1),setTimeout(checkState,15);try{form.submit()}catch(err){var submitFn=document.createElement("form").submit;submitFn.apply(form)}}finally{form.setAttribute("action",a),form.setAttribute("enctype",et),t?form.setAttribute("target",t):$form.removeAttr("target"),$(extraInputs).remove()}}function cb(e){if(!xhr.aborted&&!callbackProcessed){if(doc=getDoc(io),doc||(log("cannot access response document"),e=SERVER_ABORT),e===CLIENT_TIMEOUT_ABORT&&xhr)return xhr.abort("timeout"),void deferred.reject(xhr,"timeout");if(e==SERVER_ABORT&&xhr)return xhr.abort("server abort"),void deferred.reject(xhr,"error","server abort");if(doc&&doc.location.href!=s.iframeSrc||timedOut){io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",cb,!1);var errMsg,status="success";try{if(timedOut)throw"timeout";var isXml="xml"==s.dataType||doc.XMLDocument||$.isXMLDoc(doc);if(log("isXml="+isXml),!isXml&&window.opera&&(null===doc.body||!doc.body.innerHTML)&&--domCheckCount)return log("requeing onLoad callback, DOM not available"),void setTimeout(cb,250);var docRoot=doc.body?doc.body:doc.documentElement;xhr.responseText=docRoot?docRoot.innerHTML:null,xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc,isXml&&(s.dataType="xml"),xhr.getResponseHeader=function(header){var headers={"content-type":s.dataType};return headers[header.toLowerCase()]},docRoot&&(xhr.status=Number(docRoot.getAttribute("status"))||xhr.status,xhr.statusText=docRoot.getAttribute("statusText")||xhr.statusText);var dt=(s.dataType||"").toLowerCase(),scr=/(json|script|text)/.test(dt);if(scr||s.textarea){var ta=doc.getElementsByTagName("textarea")[0];if(ta)xhr.responseText=ta.value,xhr.status=Number(ta.getAttribute("status"))||xhr.status,xhr.statusText=ta.getAttribute("statusText")||xhr.statusText;else if(scr){var pre=doc.getElementsByTagName("pre")[0],b=doc.getElementsByTagName("body")[0];pre?xhr.responseText=pre.textContent?pre.textContent:pre.innerText:b&&(xhr.responseText=b.textContent?b.textContent:b.innerText)}}else"xml"==dt&&!xhr.responseXML&&xhr.responseText&&(xhr.responseXML=toXml(xhr.responseText));try{data=httpData(xhr,dt,s)}catch(err){status="parsererror",xhr.error=errMsg=err||status}}catch(err){log("error caught: ",err),status="error",xhr.error=errMsg=err||status}xhr.aborted&&(log("upload aborted"),status=null),xhr.status&&(status=xhr.status>=200&&xhr.status<300||304===xhr.status?"success":"error"),"success"===status?(s.success&&s.success.call(s.context,data,"success",xhr),deferred.resolve(xhr.responseText,"success",xhr),g&&$.event.trigger("ajaxSuccess",[xhr,s])):status&&(void 0===errMsg&&(errMsg=xhr.statusText),s.error&&s.error.call(s.context,xhr,status,errMsg),deferred.reject(xhr,"error",errMsg),g&&$.event.trigger("ajaxError",[xhr,s,errMsg])),g&&$.event.trigger("ajaxComplete",[xhr,s]),g&&!--$.active&&$.event.trigger("ajaxStop"),s.complete&&s.complete.call(s.context,xhr,status),callbackProcessed=!0,s.timeout&&clearTimeout(timeoutHandle),setTimeout(function(){s.iframeTarget?$io.attr("src",s.iframeSrc):$io.remove(),xhr.responseXML=null},100)}}}var el,i,s,g,id,$io,io,xhr,sub,n,timedOut,timeoutHandle,form=$form[0],deferred=$.Deferred();if(deferred.abort=function(status){xhr.abort(status)},a)for(i=0;i<elements.length;i++)el=$(elements[i]),hasProp?el.prop("disabled",!1):el.removeAttr("disabled");if(s=$.extend(!0,{},$.ajaxSettings,options),s.context=s.context||s,id="jqFormIO"+(new Date).getTime(),s.iframeTarget?($io=$(s.iframeTarget),n=$io.attr2("name"),n?id=n:$io.attr2("name",id)):($io=$('<iframe name="'+id+'" src="'+s.iframeSrc+'" />'),$io.css({position:"absolute",top:"-1000px",left:"-1000px"})),io=$io[0],xhr={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(status){var e="timeout"===status?"timeout":"aborted";log("aborting upload... "+e),this.aborted=1;try{io.contentWindow.document.execCommand&&io.contentWindow.document.execCommand("Stop")}catch(ignore){}$io.attr("src",s.iframeSrc),xhr.error=e,s.error&&s.error.call(s.context,xhr,e,status),g&&$.event.trigger("ajaxError",[xhr,s,e]),s.complete&&s.complete.call(s.context,xhr,e)}},g=s.global,g&&0===$.active++&&$.event.trigger("ajaxStart"),g&&$.event.trigger("ajaxSend",[xhr,s]),s.beforeSend&&s.beforeSend.call(s.context,xhr,s)===!1)return s.global&&$.active--,deferred.reject(),deferred;if(xhr.aborted)return deferred.reject(),deferred;sub=form.clk,sub&&(n=sub.name,n&&!sub.disabled&&(s.extraData=s.extraData||{},s.extraData[n]=sub.value,"image"==sub.type&&(s.extraData[n+".x"]=form.clk_x,s.extraData[n+".y"]=form.clk_y)));var CLIENT_TIMEOUT_ABORT=1,SERVER_ABORT=2,csrf_token=$("meta[name=csrf-token]").attr("content"),csrf_param=$("meta[name=csrf-param]").attr("content");csrf_param&&csrf_token&&(s.extraData=s.extraData||{},s.extraData[csrf_param]=csrf_token),s.forceSync?doSubmit():setTimeout(doSubmit,10);var data,doc,callbackProcessed,domCheckCount=50,toXml=$.parseXML||function(s,doc){return window.ActiveXObject?(doc=new ActiveXObject("Microsoft.XMLDOM"),doc.async="false",doc.loadXML(s)):doc=(new DOMParser).parseFromString(s,"text/xml"),doc&&doc.documentElement&&"parsererror"!=doc.documentElement.nodeName?doc:null},parseJSON=$.parseJSON||function(s){return window.eval("("+s+")")},httpData=function(xhr,type,s){var ct=xhr.getResponseHeader("content-type")||"",xml="xml"===type||!type&&ct.indexOf("xml")>=0,data=xml?xhr.responseXML:xhr.responseText;return xml&&"parsererror"===data.documentElement.nodeName&&$.error&&$.error("parsererror"),s&&s.dataFilter&&(data=s.dataFilter(data,type)),"string"==typeof data&&("json"===type||!type&&ct.indexOf("json")>=0?data=parseJSON(data):("script"===type||!type&&ct.indexOf("javascript")>=0)&&$.globalEval(data)),data};return deferred}if(!this.length)return log("ajaxSubmit: skipping submit process - no element selected"),this;var method,action,url,$form=this;"function"==typeof options?options={success:options}:void 0===options&&(options={}),method=options.type||this.attr2("method"),action=options.url||this.attr2("action"),url="string"==typeof action?$.trim(action):"",url=url||window.location.href||"",url&&(url=(url.match(/^([^#]+)/)||[])[1]),options=$.extend(!0,{url:url,success:$.ajaxSettings.success,type:method||$.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},options);var veto={};if(this.trigger("form-pre-serialize",[this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(options.beforeSerialize&&options.beforeSerialize(this,options)===!1)return log("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var traditional=options.traditional;void 0===traditional&&(traditional=$.ajaxSettings.traditional);var qx,elements=[],a=this.formToArray(options.semantic,elements);if(options.data&&(options.extraData=options.data,qx=$.param(options.data,traditional)),options.beforeSubmit&&options.beforeSubmit(a,this,options)===!1)return log("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[a,this,options,veto]),veto.veto)return log("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var q=$.param(a,traditional);qx&&(q=q?q+"&"+qx:qx),"GET"==options.type.toUpperCase()?(options.url+=(options.url.indexOf("?")>=0?"&":"?")+q,options.data=null):options.data=q;var callbacks=[];if(options.resetForm&&callbacks.push(function(){$form.resetForm()}),options.clearForm&&callbacks.push(function(){$form.clearForm(options.includeHidden)}),!options.dataType&&options.target){var oldSuccess=options.success||function(){};callbacks.push(function(data){var fn=options.replaceTarget?"replaceWith":"html";$(options.target)[fn](data).each(oldSuccess,arguments)})}else options.success&&callbacks.push(options.success);if(options.success=function(data,status,xhr){for(var context=options.context||this,i=0,max=callbacks.length;i<max;i++)callbacks[i].apply(context,[data,status,xhr||$form,$form])},options.error){var oldError=options.error;options.error=function(xhr,status,error){var context=options.context||this;oldError.apply(context,[xhr,status,error,$form])}}if(options.complete){var oldComplete=options.complete;options.complete=function(xhr,status){var context=options.context||this;oldComplete.apply(context,[xhr,status,$form])}}var fileInputs=$("input[type=file]:enabled",this).filter(function(){return""!==$(this).val()}),hasFileInputs=fileInputs.length>0,mp="multipart/form-data",multipart=$form.attr("enctype")==mp||$form.attr("encoding")==mp,fileAPI=feature.fileapi&&feature.formdata;log("fileAPI :"+fileAPI);var jqxhr,shouldUseFrame=(hasFileInputs||multipart)&&!fileAPI;options.iframe!==!1&&(options.iframe||shouldUseFrame)?options.closeKeepAlive?$.get(options.closeKeepAlive,function(){jqxhr=fileUploadIframe(a)}):jqxhr=fileUploadIframe(a):jqxhr=(hasFileInputs||multipart)&&fileAPI?fileUploadXhr(a):$.ajax(options),$form.removeData("jqxhr").data("jqxhr",jqxhr);for(var k=0;k<elements.length;k++)elements[k]=null;return this.trigger("form-submit-notify",[this,options]),this},$.fn.ajaxForm=function(options){if(options=options||{},options.delegation=options.delegation&&$.isFunction($.fn.on),!options.delegation&&0===this.length){var o={s:this.selector,c:this.context};return!$.isReady&&o.s?(log("DOM not ready, queuing ajaxForm"),$(function(){$(o.s,o.c).ajaxForm(options)}),this):(log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)")),this)}return options.delegation?($(document).off("submit.form-plugin",this.selector,doAjaxSubmit).off("click.form-plugin",this.selector,captureSubmittingElement).on("submit.form-plugin",this.selector,options,doAjaxSubmit).on("click.form-plugin",this.selector,options,captureSubmittingElement),this):this.ajaxFormUnbind().bind("submit.form-plugin",options,doAjaxSubmit).bind("click.form-plugin",options,captureSubmittingElement)},$.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},$.fn.formToArray=function(semantic,elements){var a=[];if(0===this.length)return a;var els2,form=this[0],formId=this.attr("id"),els=semantic?form.getElementsByTagName("*"):form.elements;if(els&&!/MSIE [678]/.test(navigator.userAgent)&&(els=$(els).get()),formId&&(els2=$(':input[form="'+formId+'"]').get(),els2.length&&(els=(els||[]).concat(els2))),!els||!els.length)return a;var i,j,n,v,el,max,jmax;for(i=0,max=els.length;i<max;i++)if(el=els[i],n=el.name,n&&!el.disabled)if(semantic&&form.clk&&"image"==el.type)form.clk==el&&(a.push({name:n,value:$(el).val(),type:el.type}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}));else if(v=$.fieldValue(el,!0),v&&v.constructor==Array)for(elements&&elements.push(el),j=0,jmax=v.length;j<jmax;j++)a.push({name:n,value:v[j]});else if(feature.fileapi&&"file"==el.type){elements&&elements.push(el);var files=el.files;if(files.length)for(j=0;j<files.length;j++)a.push({name:n,value:files[j],type:el.type});else a.push({name:n,value:"",type:el.type})}else null!==v&&"undefined"!=typeof v&&(elements&&elements.push(el),a.push({name:n,value:v,type:el.type,required:el.required}));if(!semantic&&form.clk){var $input=$(form.clk),input=$input[0];n=input.name,n&&!input.disabled&&"image"==input.type&&(a.push({name:n,value:$input.val()}),a.push({name:n+".x",value:form.clk_x},{name:n+".y",value:form.clk_y}))}return a},$.fn.formSerialize=function(semantic){return $.param(this.formToArray(semantic))},$.fn.fieldSerialize=function(successful){var a=[];return this.each(function(){var n=this.name;if(n){var v=$.fieldValue(this,successful);if(v&&v.constructor==Array)for(var i=0,max=v.length;i<max;i++)a.push({name:n,value:v[i]});else null!==v&&"undefined"!=typeof v&&a.push({name:this.name,value:v})}}),$.param(a)},$.fn.fieldValue=function(successful){for(var val=[],i=0,max=this.length;i<max;i++){var el=this[i],v=$.fieldValue(el,successful);null===v||"undefined"==typeof v||v.constructor==Array&&!v.length||(v.constructor==Array?$.merge(val,v):val.push(v))}return val},$.fieldValue=function(el,successful){var n=el.name,t=el.type,tag=el.tagName.toLowerCase();if(void 0===successful&&(successful=!0),successful&&(!n||el.disabled||"reset"==t||"button"==t||("checkbox"==t||"radio"==t)&&!el.checked||("submit"==t||"image"==t)&&el.form&&el.form.clk!=el||"select"==tag&&el.selectedIndex==-1))return null;if("select"==tag){var index=el.selectedIndex;if(index<0)return null;for(var a=[],ops=el.options,one="select-one"==t,max=one?index+1:ops.length,i=one?index:0;i<max;i++){var op=ops[i];if(op.selected){var v=op.value;if(v||(v=op.attributes&&op.attributes.value&&!op.attributes.value.specified?op.text:op.value),one)return v;a.push(v)}}return a}return $(el).val()},$.fn.clearForm=function(includeHidden){return this.each(function(){$("input,select,textarea",this).clearFields(includeHidden)})},$.fn.clearFields=$.fn.clearInputs=function(includeHidden){var re=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var t=this.type,tag=this.tagName.toLowerCase();re.test(t)||"textarea"==tag?this.value="":"checkbox"==t||"radio"==t?this.checked=!1:"select"==tag?this.selectedIndex=-1:"file"==t?/MSIE/.test(navigator.userAgent)?$(this).replaceWith($(this).clone(!0)):$(this).val(""):includeHidden&&(includeHidden===!0&&/hidden/.test(t)||"string"==typeof includeHidden&&$(this).is(includeHidden))&&(this.value="")})},$.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},$.fn.enable=function(b){return void 0===b&&(b=!0),this.each(function(){this.disabled=!b})},$.fn.selected=function(select){return void 0===select&&(select=!0),this.each(function(){var t=this.type;if("checkbox"==t||"radio"==t)this.checked=select;else if("option"==this.tagName.toLowerCase()){var $sel=$(this).parent("select");select&&$sel[0]&&"select-one"==$sel[0].type&&$sel.find("option").selected(!1),this.selected=select}})},$.fn.ajaxSubmit.debug=!1});
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.dateinput.js b/plone/app/jquerytools/browser/jquery.tools.dateinput.js
index a3a0845..5c12d0c 100644
--- a/plone/app/jquerytools/browser/jquery.tools.dateinput.js
+++ b/plone/app/jquerytools/browser/jquery.tools.dateinput.js
@@ -211,9 +211,8 @@
 		
 		// use sane values for value, min & max		
 		value = parseDate(value) || now;  
-		
-		min   = parseDate(min || new Date(yearNow + conf.yearRange[0], 1, 1));
-		max   = parseDate(max || new Date( yearNow + conf.yearRange[1]+ 1, 1, -1));
+		min   = parseDate(min || new Date(yearNow + conf.yearRange[0], 0, 1));
+		max   = parseDate(max || new Date(yearNow + conf.yearRange[1]+ 1, 0, 0));
 		
 		
 		// check that language exists
diff --git a/plone/app/jquerytools/browser/jquery.tools.dateinput.min.js b/plone/app/jquerytools/browser/jquery.tools.dateinput.min.js
index 9fef390..e165f44 100644
--- a/plone/app/jquerytools/browser/jquery.tools.dateinput.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.dateinput.min.js
@@ -1 +1 @@
-!function($,undefined){function dayAm(year,month){return new Date(year,month+1,0).getDate()}function zeropad(val,len){for(val=""+val,len=len||2;val.length<len;)val="0"+val;return val}function format(formatter,date,text,lang){var d=date.getDate(),D=date.getDay(),m=date.getMonth(),y=date.getFullYear(),flags={d:d,dd:zeropad(d),ddd:LABELS[lang].shortDays[D],dddd:LABELS[lang].days[D],m:m+1,mm:zeropad(m+1),mmm:LABELS[lang].shortMonths[m],mmmm:LABELS[lang].months[m],yy:String(y).slice(2),yyyy:y},ret=formatters[formatter](text,date,flags,lang);return tmpTag.html(ret).html()}function integer(val){return parseInt(val,10)}function isSameDay(d1,d2){return d1.getFullYear()===d2.getFullYear()&&d1.getMonth()==d2.getMonth()&&d1.getDate()==d2.getDate()}function parseDate(val){if(val!==undefined){if(val.constructor==Date)return val;if("string"==typeof val){var els=val.split("-");if(3==els.length)return new Date(integer(els[0]),integer(els[1])-1,integer(els[2]));if(!/^-?\d+$/.test(val))return;val=integer(val)}var date=new Date;return date.setDate(date.getDate()+val),date}}function Dateinput(input,conf){function select(date,conf,e){return input.attr("readonly")?void self.hide(e):(value=date,currYear=date.getFullYear(),currMonth=date.getMonth(),currDay=date.getDate(),e||(e=$.Event("api")),"click"!=e.type||/msie/.test(navigator.userAgent.toLowerCase())||input.focus(),e.type="beforeChange",fire.trigger(e,[date]),void(e.isDefaultPrevented()||(input.val(format(conf.formatter,date,conf.format,conf.lang)),e.type="change",e.target=input[0],fire.trigger(e),input.data("date",date),self.hide(e))))}function onShow(ev){ev.type="onShow",fire.trigger(ev),$(document).on("keydown.d",function(e){if(e.ctrlKey)return!0;var key=e.keyCode;if(8==key||46==key)return input.val(""),self.hide(e);if(27==key||9==key)return self.hide(e);if($(KEYS).index(key)>=0){if(!opened)return self.show(e),e.preventDefault();var days=$("#"+css.weeks+" a"),el=$("."+css.focus),index=days.index(el);return el.removeClass(css.focus),74==key||40==key?index+=7:75==key||38==key?index-=7:76==key||39==key?index+=1:(72==key||37==key)&&(index-=1),index>41?(self.addMonth(),el=$("#"+css.weeks+" a:eq("+(index-42)+")")):0>index?(self.addMonth(-1),el=$("#"+css.weeks+" a:eq("+(index+42)+")")):el=days.eq(index),el.addClass(css.focus),e.preventDefault()}return 34==key?self.addMonth():33==key?self.addMonth(-1):36==key?self.today():(13==key&&($(e.target).is("select")||$("."+css.focus).click()),$([16,17,18,9]).index(key)>=0)}),$(document).on("click.d",function(e){var el=e.target;el.id==css.root||$(el).parents("#"+css.root).length||el==input[0]||trigger&&el==trigger[0]||self.hide(e)})}var trigger,pm,nm,currYear,currMonth,currDay,opened,original,self=this,now=new Date,yearNow=now.getFullYear(),css=conf.css,labels=LABELS[conf.lang],root=$("#"+css.root),title=root.find("#"+css.title),value=input.attr("data-value")||conf.value||input.val(),min=input.attr("min")||conf.min,max=input.attr("max")||conf.max;if(0===min&&(min="0"),value=parseDate(value)||now,min=parseDate(min||new Date(yearNow+conf.yearRange[0],1,1)),max=parseDate(max||new Date(yearNow+conf.yearRange[1]+1,1,-1)),!labels)throw"Dateinput: invalid language: "+conf.lang;if("date"==input.attr("type")){var original=input.clone(),def=original.wrap("<div/>").parent().html(),clone=$(def.replace(/type/i,"type=text data-orig-type"));conf.value&&clone.val(conf.value),input.replaceWith(clone),input=clone}input.addClass(css.input);var fire=input.add(self);if(!root.length){if(root=$("<div><div><a/><div/><a/></div><div><div/><div/></div></div>").hide().css({position:"absolute"}).attr("id",css.root),root.children().eq(0).attr("id",css.head).end().eq(1).attr("id",css.body).children().eq(0).attr("id",css.days).end().eq(1).attr("id",css.weeks).end().end().end().find("a").eq(0).attr("id",css.prev).end().eq(1).attr("id",css.next),title=root.find("#"+css.head).find("div").attr("id",css.title),conf.selectors){var monthSelector=$("<select/>").attr("id",css.month),yearSelector=$("<select/>").attr("id",css.year);title.html(monthSelector.add(yearSelector))}for(var days=root.find("#"+css.days),d=0;7>d;d++)days.append($("<span/>").text(labels.shortDays[(d+conf.firstDay)%7]));$("body").append(root)}conf.trigger&&(trigger=$("<a/>").attr("href","#").addClass(css.trigger).click(function(e){return conf.toggle?self.toggle():self.show(),e.preventDefault()}).insertAfter(input));var weeks=root.find("#"+css.weeks);yearSelector=root.find("#"+css.year),monthSelector=root.find("#"+css.month),$.extend(self,{show:function(e){if(!input.attr("disabled")&&!opened&&(e=e||$.Event(),e.type="onBeforeShow",fire.trigger(e),!e.isDefaultPrevented())){$.each(instances,function(){this.hide()}),opened=!0,monthSelector.off("change").change(function(){self.setValue(integer(yearSelector.val()),integer($(this).val()))}),yearSelector.off("change").change(function(){self.setValue(integer($(this).val()),integer(monthSelector.val()))}),pm=root.find("#"+css.prev).off("click").click(function(){return pm.hasClass(css.disabled)||self.addMonth(-1),!1}),nm=root.find("#"+css.next).off("click").click(function(){return nm.hasClass(css.disabled)||self.addMonth(),!1}),self.setValue(value);var pos=input.offset();return/iPad/i.test(navigator.userAgent)&&(pos.top-=$(window).scrollTop()),root.css({top:pos.top+input.outerHeight(!0)+conf.offset[0],left:pos.left+conf.offset[1]}),conf.speed?root.show(conf.speed,function(){onShow(e)}):(root.show(),onShow(e)),self}},setValue:function(year,month,day){var date=integer(month)>=-1?new Date(integer(year),integer(month),integer(day==undefined||isNaN(day)?1:day)):year||value;if(min>date?date=min:date>max&&(date=max),"string"==typeof year&&(date=parseDate(year)),year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),-1==month?(month=11,year--):12==month&&(month=0,year++),!opened)return select(date,conf),self;currMonth=month,currYear=year,currDay=day;var week,tmp=new Date(year,month,1-conf.firstDay),begin=tmp.getDay(),days=dayAm(year,month),prevDays=dayAm(year,month-1);if(conf.selectors){monthSelector.empty(),$.each(labels.months,function(i,m){min<new Date(year,i+1,1)&&max>new Date(year,i,0)&&monthSelector.append($("<option/>").html(m).attr("value",i))}),yearSelector.empty();for(var yearNow=now.getFullYear(),i=yearNow+conf.yearRange[0];i<yearNow+conf.yearRange[1];i++)min<new Date(i+1,0,1)&&max>new Date(i,0,0)&&yearSelector.append($("<option/>").text(i));monthSelector.val(month),yearSelector.val(year)}else title.html(labels.months[month]+" "+year);weeks.empty(),pm.add(nm).removeClass(css.disabled);for(var a,num,j=begin?0:-7;(begin?42:35)>j;j++)a=$("<a/>"),j%7===0&&(week=$("<div/>").addClass(css.week),weeks.append(week)),begin>j?(a.addClass(css.off),num=prevDays-begin+j+1,date=new Date(year,month-1,num)):j>=begin+days?(a.addClass(css.off),num=j-days-begin+1,date=new Date(year,month+1,num)):(num=j-begin+1,date=new Date(year,month,num),isSameDay(value,date)?a.attr("id",css.current).addClass(css.focus):isSameDay(now,date)&&a.attr("id",css.today)),min&&min>date&&a.add(pm).addClass(css.disabled),max&&date>max&&a.add(nm).addClass(css.disabled),a.attr("href","#"+num).text(num).data("date",date),week.append(a);return weeks.find("a").click(function(e){var el=$(this);return el.hasClass(css.disabled)||($("#"+css.current).removeAttr("id"),el.attr("id",css.current),select(el.data("date"),conf,e)),!1}),css.sunday&&weeks.find("."+css.week).each(function(){var beg=conf.firstDay?7-conf.firstDay:0;$(this).children().slice(beg,beg+1).addClass(css.sunday)}),self},setMin:function(val,fit){return min=parseDate(val),fit&&min>value&&self.setValue(min),self},setMax:function(val,fit){return max=parseDate(val),fit&&value>max&&self.setValue(max),self},today:function(){return self.setValue(now)},addDay:function(amount){return this.setValue(currYear,currMonth,currDay+(amount||1))},addMonth:function(amount){var targetMonth=currMonth+(amount||1),daysInTargetMonth=dayAm(currYear,targetMonth),targetDay=daysInTargetMonth>=currDay?currDay:daysInTargetMonth;return this.setValue(currYear,targetMonth,targetDay)},addYear:function(amount){return this.setValue(currYear+(amount||1),currMonth,currDay)},destroy:function(){input.add(document).off("click.d keydown.d"),root.add(trigger).remove(),input.removeData("dateinput").removeClass(css.input),original&&input.replaceWith(original)},hide:function(e){if(opened){if(e=$.Event(),e.type="onHide",fire.trigger(e),e.isDefaultPrevented())return;$(document).off("click.d keydown.d"),root.hide(),opened=!1}return self},toggle:function(){return self.isOpen()?self.hide():self.show()},getConf:function(){return conf},getInput:function(){return input},getCalendar:function(){return root},getValue:function(dateFormat){return dateFormat?format(conf.formatter,value,dateFormat,conf.lang):value},isOpen:function(){return opened}}),$.each(["onBeforeShow","onShow","change","onHide"],function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.editable||input.on("focus.d click.d",self.show).keydown(function(e){var key=e.keyCode;return!opened&&$(KEYS).index(key)>=0?(self.show(e),e.preventDefault()):((8==key||46==key)&&input.val(""),e.shiftKey||e.ctrlKey||e.altKey||9==key?!0:e.preventDefault())}),parseDate(input.val())&&select(value,conf)}$.tools=$.tools||{version:"@VERSION"};var tool,instances=[],formatters={},KEYS=[75,76,38,39,74,72,40,37],LABELS={};tool=$.tools.dateinput={conf:{format:"mm/dd/yy",formatter:"default",selectors:!1,yearRange:[-5,5],lang:"en",offset:[0,0],speed:0,firstDay:0,min:undefined,max:undefined,trigger:0,toggle:0,editable:0,css:{prefix:"cal",input:"date",root:0,head:0,title:0,prev:0,next:0,month:0,year:0,days:0,body:0,weeks:0,today:0,current:0,week:0,off:0,sunday:0,focus:0,disabled:0,trigger:0}},addFormatter:function(name,fn){formatters[name]=fn},localize:function(language,labels){$.each(labels,function(key,val){labels[key]=val.split(",")}),LABELS[language]=labels}},tool.localize("en",{months:"January,February,March,April,May,June,July,August,September,October,November,December",shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",days:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat"});var tmpTag=$("<a/>");tool.addFormatter("default",function(text,date,flags){return text.replace(/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g,function($0){return $0 in flags?flags[$0]:$0})}),tool.addFormatter("prefixed",function(text,date,flags){return text.replace(/%(d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*')/g,function($0,$1){return $1 in flags?flags[$1]:$0})}),$.expr[":"].date=function(el){var type=el.getAttribute("type");return type&&"date"==type||!!$(el).data("dateinput")},$.fn.dateinput=function(conf){if(this.data("dateinput"))return this;conf=$.extend(!0,{},tool.conf,conf),$.each(conf.css,function(key,val){val||"prefix"==key||(conf.css[key]=(conf.css.prefix||"")+(val||key))});var els;return this.each(function(){var el=new Dateinput($(this),conf);instances.push(el);var input=el.getInput().data("dateinput",el);els=els?els.add(input):input}),els?els:this}}(jQuery);
\ No newline at end of file
+!function($,undefined){function dayAm(year,month){return new Date(year,month+1,0).getDate()}function zeropad(val,len){for(val=""+val,len=len||2;val.length<len;)val="0"+val;return val}function format(formatter,date,text,lang){var d=date.getDate(),D=date.getDay(),m=date.getMonth(),y=date.getFullYear(),flags={d:d,dd:zeropad(d),ddd:LABELS[lang].shortDays[D],dddd:LABELS[lang].days[D],m:m+1,mm:zeropad(m+1),mmm:LABELS[lang].shortMonths[m],mmmm:LABELS[lang].months[m],yy:String(y).slice(2),yyyy:y},ret=formatters[formatter](text,date,flags,lang);return tmpTag.html(ret).html()}function integer(val){return parseInt(val,10)}function isSameDay(d1,d2){return d1.getFullYear()===d2.getFullYear()&&d1.getMonth()==d2.getMonth()&&d1.getDate()==d2.getDate()}function parseDate(val){if(val!==undefined){if(val.constructor==Date)return val;if("string"==typeof val){var els=val.split("-");if(3==els.length)return new Date(integer(els[0]),integer(els[1])-1,integer(els[2]));if(!/^-?\d+$/.test(val))return;val=integer(val)}var date=new Date;return date.setDate(date.getDate()+val),date}}function Dateinput(input,conf){function select(date,conf,e){return input.attr("readonly")?void self.hide(e):(value=date,currYear=date.getFullYear(),currMonth=date.getMonth(),currDay=date.getDate(),e||(e=$.Event("api")),"click"!=e.type||/msie/.test(navigator.userAgent.toLowerCase())||input.focus(),e.type="beforeChange",fire.trigger(e,[date]),void(e.isDefaultPrevented()||(input.val(format(conf.formatter,date,conf.format,conf.lang)),e.type="change",e.target=input[0],fire.trigger(e),input.data("date",date),self.hide(e))))}function onShow(ev){ev.type="onShow",fire.trigger(ev),$(document).on("keydown.d",function(e){if(e.ctrlKey)return!0;var key=e.keyCode;if(8==key||46==key)return input.val(""),self.hide(e);if(27==key||9==key)return self.hide(e);if($(KEYS).index(key)>=0){if(!opened)return self.show(e),e.preventDefault();var days=$("#"+css.weeks+" a"),el=$("."+css.focus),index=days.index(el);return el.removeClass(css.focus),74==key||40==key?index+=7:75==key||38==key?index-=7:76==key||39==key?index+=1:72!=key&&37!=key||(index-=1),index>41?(self.addMonth(),el=$("#"+css.weeks+" a:eq("+(index-42)+")")):index<0?(self.addMonth(-1),el=$("#"+css.weeks+" a:eq("+(index+42)+")")):el=days.eq(index),el.addClass(css.focus),e.preventDefault()}return 34==key?self.addMonth():33==key?self.addMonth(-1):36==key?self.today():(13==key&&($(e.target).is("select")||$("."+css.focus).click()),$([16,17,18,9]).index(key)>=0)}),$(document).on("click.d",function(e){var el=e.target;el.id==css.root||$(el).parents("#"+css.root).length||el==input[0]||trigger&&el==trigger[0]||self.hide(e)})}var trigger,pm,nm,currYear,currMonth,currDay,opened,original,self=this,now=new Date,yearNow=now.getFullYear(),css=conf.css,labels=LABELS[conf.lang],root=$("#"+css.root),title=root.find("#"+css.title),value=input.attr("data-value")||conf.value||input.val(),min=input.attr("min")||conf.min,max=input.attr("max")||conf.max;if(0===min&&(min="0"),value=parseDate(value)||now,min=parseDate(min||new Date(yearNow+conf.yearRange[0],0,1)),max=parseDate(max||new Date(yearNow+conf.yearRange[1]+1,0,0)),!labels)throw"Dateinput: invalid language: "+conf.lang;if("date"==input.attr("type")){var original=input.clone(),def=original.wrap("<div/>").parent().html(),clone=$(def.replace(/type/i,"type=text data-orig-type"));conf.value&&clone.val(conf.value),input.replaceWith(clone),input=clone}input.addClass(css.input);var fire=input.add(self);if(!root.length){if(root=$("<div><div><a/><div/><a/></div><div><div/><div/></div></div>").hide().css({position:"absolute"}).attr("id",css.root),root.children().eq(0).attr("id",css.head).end().eq(1).attr("id",css.body).children().eq(0).attr("id",css.days).end().eq(1).attr("id",css.weeks).end().end().end().find("a").eq(0).attr("id",css.prev).end().eq(1).attr("id",css.next),title=root.find("#"+css.head).find("div").attr("id",css.title),conf.selectors){var monthSelector=$("<select/>").attr("id",css.month),yearSelector=$("<select/>").attr("id",css.year);title.html(monthSelector.add(yearSelector))}for(var days=root.find("#"+css.days),d=0;d<7;d++)days.append($("<span/>").text(labels.shortDays[(d+conf.firstDay)%7]));$("body").append(root)}conf.trigger&&(trigger=$("<a/>").attr("href","#").addClass(css.trigger).click(function(e){return conf.toggle?self.toggle():self.show(),e.preventDefault()}).insertAfter(input));var weeks=root.find("#"+css.weeks);yearSelector=root.find("#"+css.year),monthSelector=root.find("#"+css.month),$.extend(self,{show:function(e){if(!input.attr("disabled")&&!opened&&(e=e||$.Event(),e.type="onBeforeShow",fire.trigger(e),!e.isDefaultPrevented())){$.each(instances,function(){this.hide()}),opened=!0,monthSelector.off("change").change(function(){self.setValue(integer(yearSelector.val()),integer($(this).val()))}),yearSelector.off("change").change(function(){self.setValue(integer($(this).val()),integer(monthSelector.val()))}),pm=root.find("#"+css.prev).off("click").click(function(e){return pm.hasClass(css.disabled)||self.addMonth(-1),!1}),nm=root.find("#"+css.next).off("click").click(function(e){return nm.hasClass(css.disabled)||self.addMonth(),!1}),self.setValue(value);var pos=input.offset();return/iPad/i.test(navigator.userAgent)&&(pos.top-=$(window).scrollTop()),root.css({top:pos.top+input.outerHeight(!0)+conf.offset[0],left:pos.left+conf.offset[1]}),conf.speed?root.show(conf.speed,function(){onShow(e)}):(root.show(),onShow(e)),self}},setValue:function(year,month,day){var date=integer(month)>=-1?new Date(integer(year),integer(month),integer(day==undefined||isNaN(day)?1:day)):year||value;if(date<min?date=min:date>max&&(date=max),"string"==typeof year&&(date=parseDate(year)),year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),month==-1?(month=11,year--):12==month&&(month=0,year++),!opened)return select(date,conf),self;currMonth=month,currYear=year,currDay=day;var week,tmp=new Date(year,month,1-conf.firstDay),begin=tmp.getDay(),days=dayAm(year,month),prevDays=dayAm(year,month-1);if(conf.selectors){monthSelector.empty(),$.each(labels.months,function(i,m){min<new Date(year,i+1,1)&&max>new Date(year,i,0)&&monthSelector.append($("<option/>").html(m).attr("value",i))}),yearSelector.empty();for(var yearNow=now.getFullYear(),i=yearNow+conf.yearRange[0];i<yearNow+conf.yearRange[1];i++)min<new Date(i+1,0,1)&&max>new Date(i,0,0)&&yearSelector.append($("<option/>").text(i));monthSelector.val(month),yearSelector.val(year)}else title.html(labels.months[month]+" "+year);weeks.empty(),pm.add(nm).removeClass(css.disabled);for(var a,num,j=begin?0:-7;j<(begin?42:35);j++)a=$("<a/>"),j%7===0&&(week=$("<div/>").addClass(css.week),weeks.append(week)),j<begin?(a.addClass(css.off),num=prevDays-begin+j+1,date=new Date(year,month-1,num)):j>=begin+days?(a.addClass(css.off),num=j-days-begin+1,date=new Date(year,month+1,num)):(num=j-begin+1,date=new Date(year,month,num),isSameDay(value,date)?a.attr("id",css.current).addClass(css.focus):isSameDay(now,date)&&a.attr("id",css.today)),min&&date<min&&a.add(pm).addClass(css.disabled),max&&date>max&&a.add(nm).addClass(css.disabled),a.attr("href","#"+num).text(num).data("date",date),week.append(a);return weeks.find("a").click(function(e){var el=$(this);return el.hasClass(css.disabled)||($("#"+css.current).removeAttr("id"),el.attr("id",css.current),select(el.data("date"),conf,e)),!1}),css.sunday&&weeks.find("."+css.week).each(function(){var beg=conf.firstDay?7-conf.firstDay:0;$(this).children().slice(beg,beg+1).addClass(css.sunday)}),self},setMin:function(val,fit){return min=parseDate(val),fit&&value<min&&self.setValue(min),self},setMax:function(val,fit){return max=parseDate(val),fit&&value>max&&self.setValue(max),self},today:function(){return self.setValue(now)},addDay:function(amount){return this.setValue(currYear,currMonth,currDay+(amount||1))},addMonth:function(amount){var targetMonth=currMonth+(amount||1),daysInTargetMonth=dayAm(currYear,targetMonth),targetDay=currDay<=daysInTargetMonth?currDay:daysInTargetMonth;return this.setValue(currYear,targetMonth,targetDay)},addYear:function(amount){return this.setValue(currYear+(amount||1),currMonth,currDay)},destroy:function(){input.add(document).off("click.d keydown.d"),root.add(trigger).remove(),input.removeData("dateinput").removeClass(css.input),original&&input.replaceWith(original)},hide:function(e){if(opened){if(e=$.Event(),e.type="onHide",fire.trigger(e),e.isDefaultPrevented())return;$(document).off("click.d keydown.d"),root.hide(),opened=!1}return self},toggle:function(){return self.isOpen()?self.hide():self.show()},getConf:function(){return conf},getInput:function(){return input},getCalendar:function(){return root},getValue:function(dateFormat){return dateFormat?format(conf.formatter,value,dateFormat,conf.lang):value},isOpen:function(){return opened}}),$.each(["onBeforeShow","onShow","change","onHide"],function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.editable||input.on("focus.d click.d",self.show).keydown(function(e){var key=e.keyCode;return!opened&&$(KEYS).index(key)>=0?(self.show(e),e.preventDefault()):(8!=key&&46!=key||input.val(""),!!(e.shiftKey||e.ctrlKey||e.altKey||9==key)||e.preventDefault())}),parseDate(input.val())&&select(value,conf)}$.tools=$.tools||{version:"@VERSION"};var tool,instances=[],formatters={},KEYS=[75,76,38,39,74,72,40,37],LABELS={};tool=$.tools.dateinput={conf:{format:"mm/dd/yy",formatter:"default",selectors:!1,yearRange:[-5,5],lang:"en",offset:[0,0],speed:0,firstDay:0,min:undefined,max:undefined,trigger:0,toggle:0,editable:0,css:{prefix:"cal",input:"date",root:0,head:0,title:0,prev:0,next:0,month:0,year:0,days:0,body:0,weeks:0,today:0,current:0,week:0,off:0,sunday:0,focus:0,disabled:0,trigger:0}},addFormatter:function(name,fn){formatters[name]=fn},localize:function(language,labels){$.each(labels,function(key,val){labels[key]=val.split(",")}),LABELS[language]=labels}},tool.localize("en",{months:"January,February,March,April,May,June,July,August,September,October,November,December",shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",days:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat"});var tmpTag=$("<a/>");tool.addFormatter("default",function(text,date,flags,lang){return text.replace(/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g,function($0){return $0 in flags?flags[$0]:$0})}),tool.addFormatter("prefixed",function(text,date,flags,lang){return text.replace(/%(d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*')/g,function($0,$1){return $1 in flags?flags[$1]:$0})}),$.expr[":"].date=function(el){var type=el.getAttribute("type");return type&&"date"==type||!!$(el).data("dateinput")},$.fn.dateinput=function(conf){if(this.data("dateinput"))return this;conf=$.extend(!0,{},tool.conf,conf),$.each(conf.css,function(key,val){val||"prefix"==key||(conf.css[key]=(conf.css.prefix||"")+(val||key))});var els;return this.each(function(){var el=new Dateinput($(this),conf);instances.push(el);var input=el.getInput().data("dateinput",el);els=els?els.add(input):input}),els?els:this}}(jQuery);
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.min.js b/plone/app/jquerytools/browser/jquery.tools.min.js
index b1d3242..7e5d60b 100644
--- a/plone/app/jquerytools/browser/jquery.tools.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.min.js
@@ -1 +1 @@
-!function($){function Overlay(trigger,conf){var closers,overlay,opened,self=this,fire=trigger.add(self),w=$(window),maskConf=$.tools.expose&&(conf.mask||conf.expose),uid=Math.random().toString().slice(10);maskConf&&("string"==typeof maskConf&&(maskConf={color:maskConf}),maskConf.closeOnClick=maskConf.closeOnEsc=!1);var jq=conf.target||trigger.attr("rel");if(overlay=jq?$(jq):null||trigger,!overlay.length)throw"Could not find Overlay: "+jq;trigger&&-1==trigger.index(overlay)&&trigger.click(function(e){return self.load(e),e.preventDefault()}),$.extend(self,{load:function(e){if(self.isOpened())return self;var eff=effects[conf.effect];if(!eff)throw'Overlay: cannot find effect : "'+conf.effect+'"';if(conf.oneInstance&&$.each(instances,function(){this.close(e)}),e=e||$.Event(),e.type="onBeforeLoad",fire.trigger(e),e.isDefaultPrevented())return self;opened=!0,maskConf&&$(overlay).expose(maskConf);var top=conf.top,left=conf.left,oWidth=overlay.outerWidth(!0),oHeight=overlay.outerHeight(!0);return"string"==typeof top&&(top="center"==top?Math.max((w.height()-oHeight)/2,0):parseInt(top,10)/100*w.height()),"center"==left&&(left=Math.max((w.width()-oWidth)/2,0)),eff[0].call(self,{top:top,left:left},function(){opened&&(e.type="onLoad",fire.trigger(e))}),maskConf&&conf.closeOnClick&&$.mask.getMask().one("click",self.close),conf.closeOnClick&&$(document).on("click."+uid,function(e){$(e.target).parents(overlay).length||self.close(e)}),conf.closeOnEsc&&$(document).on("keydown."+uid,function(e){27==e.keyCode&&self.close(e)}),self},close:function(e){return self.isOpened()?(e=e||$.Event(),e.type="onBeforeClose",fire.trigger(e),e.isDefaultPrevented()?void 0:(opened=!1,effects[conf.effect][1].call(self,function(){e.type="onClose",fire.trigger(e)}),$(document).off("click."+uid+" keydown."+uid),maskConf&&$.mask.close(),self)):self},getOverlay:function(){return overlay},getTrigger:function(){return trigger},getClosers:function(){return closers},isOpened:function(){return opened},getConf:function(){return conf}}),$.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),closers=overlay.find(conf.close||".close"),closers.length||conf.close||(closers=$('<a class="close"></a>'),overlay.prepend(closers)),closers.click(function(e){self.close(e)}),conf.load&&self.load()}$.tools=$.tools||{version:"@VERSION"},$.tools.overlay={addEffect:function(name,loadFn,closeFn){effects[name]=[loadFn,closeFn]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!/msie/.test(navigator.userAgent.toLowerCase())||navigator.appVersion>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var instances=[],effects={};$.tools.overlay.addEffect("default",function(pos,onLoad){var conf=this.getConf(),w=$(window);conf.fixed||(pos.top+=w.scrollTop(),pos.left+=w.scrollLeft()),pos.position=conf.fixed?"fixed":"absolute",this.getOverlay().css(pos).fadeIn(conf.speed,onLoad)},function(onClose){this.getOverlay().fadeOut(this.getConf().closeSpeed,onClose)}),$.fn.overlay=function(conf){var el=this.data("overlay");return el?el:($.isFunction(conf)&&(conf={onBeforeLoad:conf}),conf=$.extend(!0,{},$.tools.overlay.conf,conf),this.each(function(){el=new Overlay($(this),conf),instances.push(el),$(this).data("overlay",el)}),conf.api?el:this)}}(jQuery),function($){function find(root,query){var el=$(query);return el.length<2?el:root.parent().find(query)}function Scrollable(root,conf){var self=this,fire=root.add(self),itemWrap=root.children(),index=0,vertical=conf.vertical;if(current||(current=self),itemWrap.length>1&&(itemWrap=$(conf.items,root)),conf.size>1&&(conf.circular=!1),$.extend(self,{getConf:function(){return conf},getIndex:function(){return index},getSize:function(){return self.getItems().size()},getNaviButtons:function(){return prev.add(next)},getRoot:function(){return root},getItemWrap:function(){return itemWrap},getItems:function(){return itemWrap.find(conf.item).not("."+conf.clonedClass)},move:function(offset,time){return self.seekTo(index+offset,time)},next:function(time){return self.move(conf.size,time)},prev:function(time){return self.move(-conf.size,time)},begin:function(time){return self.seekTo(0,time)},end:function(time){return self.seekTo(self.getSize()-1,time)},focus:function(){return current=self,self},addItem:function(item){return item=$(item),conf.circular?(itemWrap.children().last().before(item),itemWrap.children().first().replaceWith(item.clone().addClass(conf.clonedClass))):(itemWrap.append(item),next.removeClass("disabled")),fire.trigger("onAddItem",[item]),self},seekTo:function(i,time,fn){if(i.jquery||(i*=1),conf.circular&&0===i&&-1==index&&0!==time)return self;if(!conf.circular&&0>i||i>self.getSize()||-1>i)return self;var item=i;i.jquery?i=self.getItems().index(i):item=self.getItems().eq(i);var e=$.Event("onBeforeSeek");if(!fn&&(fire.trigger(e,[i,time]),e.isDefaultPrevented()||!item.length))return self;var props=vertical?{top:-item.position().top}:{left:-item.position().left};return index=i,current=self,void 0===time&&(time=conf.speed),itemWrap.animate(props,time,conf.easing,fn||function(){fire.trigger("onSeek",[i])}),self}}),$.each(["onBeforeSeek","onSeek","onAddItem"],function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.circular){var cloned1=self.getItems().slice(-1).clone().prependTo(itemWrap),cloned2=self.getItems().eq(1).clone().appendTo(itemWrap);cloned1.add(cloned2).addClass(conf.clonedClass),self.onBeforeSeek(function(e,i,time){return e.isDefaultPrevented()?void 0:-1==i?(self.seekTo(cloned1,time,function(){self.end(0)}),e.preventDefault()):void(i==self.getSize()&&self.seekTo(cloned2,time,function(){self.begin(0)}))});var hidden_parents=root.parents().add(root).filter(function(){return"none"===$(this).css("display")?!0:void 0});hidden_parents.length?(hidden_parents.show(),self.seekTo(0,0,function(){}),hidden_parents.hide()):self.seekTo(0,0,function(){})}var prev=find(root,conf.prev).click(function(e){e.stopPropagation(),self.prev()}),next=find(root,conf.next).click(function(e){e.stopPropagation(),self.next()});if(conf.circular||(self.onBeforeSeek(function(e,i){setTimeout(function(){e.isDefaultPrevented()||(prev.toggleClass(conf.disabledClass,0>=i),next.toggleClass(conf.disabledClass,i>=self.getSize()-1))},1)}),conf.initialIndex||prev.addClass(conf.disabledClass)),self.getSize()<2&&prev.add(next).addClass(conf.disabledClass),conf.mousewheel&&$.fn.mousewheel&&root.mousewheel(function(e,delta){return conf.mousewheel?(self.move(0>delta?1:-1,conf.wheelSpeed||50),!1):void 0}),conf.touch){var touch={};itemWrap[0].ontouchstart=function(e){var t=e.touches[0];touch.x=t.clientX,touch.y=t.clientY},itemWrap[0].ontouchmove=function(e){if(1==e.touches.length&&!itemWrap.is(":animated")){var t=e.touches[0],deltaX=touch.x-t.clientX,deltaY=touch.y-t.clientY;self[vertical&&deltaY>0||!vertical&&deltaX>0?"next":"prev"](),e.preventDefault()}}}conf.keyboard&&$(document).on("keydown.scrollable",function(evt){if(!(!conf.keyboard||evt.altKey||evt.ctrlKey||evt.metaKey||$(evt.target).is(":input")||"static"!=conf.keyboard&&current!=self)){var key=evt.keyCode;return!vertical||38!=key&&40!=key?vertical||37!=key&&39!=key?void 0:(self.move(37==key?-1:1),evt.preventDefault()):(self.move(38==key?-1:1),evt.preventDefault())}}),conf.initialIndex&&self.seekTo(conf.initialIndex,0,function(){})}$.tools=$.tools||{version:"@VERSION"},$.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}};var current;$.fn.scrollable=function(conf){var el=this.data("scrollable");return el?el:(conf=$.extend({},$.tools.scrollable.conf,conf),this.each(function(){el=new Scrollable($(this),conf),$(this).data("scrollable",el)}),conf.api?el:this)}}(jQuery),function($){function Tabs(root,paneSelector,conf){var current,self=this,trigger=root.add(this),tabs=root.find(conf.tabs),panes=paneSelector.jquery?paneSelector:root.children(paneSelector);tabs.length||(tabs=root.children()),panes.length||(panes=root.parent().find(paneSelector)),panes.length||(panes=$(paneSelector)),$.extend(this,{click:function(i,e){var tab=tabs.eq(i),firstRender=!root.data("tabs");if("string"==typeof i&&i.replace("#","")&&(tab=tabs.filter('[href*="'+i.replace("#","")+'"]'),i=Math.max(tabs.index(tab),0)),conf.rotate){var last=tabs.length-1;if(0>i)return self.click(last,e);if(i>last)return self.click(0,e)}if(!tab.length){if(current>=0)return self;i=conf.initialIndex,tab=tabs.eq(i)}if(i===current)return self;if(e=e||$.Event(),e.type="onBeforeClick",trigger.trigger(e,[i]),!e.isDefaultPrevented()){var effect=firstRender?conf.initialEffect&&conf.effect||"default":conf.effect;return effects[effect].call(self,i,function(){current=i,e.type="onClick",trigger.trigger(e,[i])}),tabs.removeClass(conf.current),tab.addClass(conf.current),self}},getConf:function(){return conf},getTabs:function(){return tabs},getPanes:function(){return panes},getCurrentPane:function(){return panes.eq(current)},getCurrentTab:function(){return tabs.eq(current)},getIndex:function(){return current},next:function(){return self.click(current+1)},prev:function(){return self.click(current-1)},destroy:function(){return tabs.off(conf.event).removeClass(conf.current),panes.find('a[href^="#"]').off("click.T"),self}}),$.each("onBeforeClick,onClick".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.history&&$.fn.history&&($.tools.history.init(tabs),conf.event="history"),tabs.each(function(i){$(this).on(conf.event,function(e){return self.click(i,e),e.preventDefault()})}),panes.find('a[href^="#"]').on("click.T",function(e){self.click($(this).attr("href"),e)}),location.hash&&"a"==conf.tabs&&root.find('[href="'+location.hash+'"]').length?self.click(location.hash):(0===conf.initialIndex||conf.initialIndex>0)&&self.click(conf.initialIndex)}$.tools=$.tools||{version:"@VERSION"},$.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialEffect:!1,initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(name,fn){effects[name]=fn}};var animating,w,effects={"default":function(i,done){this.getPanes().hide().eq(i).show(),done.call()},fade:function(i,done){var conf=this.getConf(),speed=conf.fadeOutSpeed,panes=this.getPanes();speed?panes.fadeOut(speed):panes.hide(),panes.eq(i).fadeIn(conf.fadeInSpeed,done)},slide:function(i,done){var conf=this.getConf();this.getPanes().slideUp(conf.slideUpSpeed),this.getPanes().eq(i).slideDown(conf.slideDownSpeed,done)},ajax:function(i,done){this.getPanes().eq(0).load(this.getTabs().eq(i).attr("href"),done)}};$.tools.tabs.addEffect("horizontal",function(i,done){if(!animating){var nextPane=this.getPanes().eq(i),currentPane=this.getCurrentPane();w||(w=this.getPanes().eq(0).width()),animating=!0,nextPane.show(),currentPane.animate({width:0},{step:function(now){nextPane.css("width",w-now)},complete:function(){$(this).hide(),done.call(),animating=!1}}),currentPane.length||(done.call(),animating=!1)}}),$.fn.tabs=function(paneSelector,conf){var el=this.data("tabs");return el&&(el.destroy(),this.removeData("tabs")),$.isFunction(conf)&&(conf={onBeforeClick:conf}),conf=$.extend({},$.tools.tabs.conf,conf),this.each(function(){el=new Tabs($(this),paneSelector,conf),$(this).data("tabs",el)}),conf.api?el:this}}(jQuery),function($){function setIframeLocation(h){if(h){var doc=iframe.contentWindow.document;doc.open().close(),doc.location.hash=h}}var hash,iframe,links,inited;$.tools=$.tools||{version:"@VERSION"},$.tools.history={init:function(els){inited||($.browser.msie&&$.browser.version<"8"?iframe||(iframe=$("<iframe/>").attr("src","javascript:false;").hide().get(0),$("body").append(iframe),setInterval(function(){var idoc=iframe.contentWindow.document,h=idoc.location.hash;hash!==h&&$(window).trigger("hash",h)},100),setIframeLocation(location.hash||"#")):setInterval(function(){var h=location.hash;h!==hash&&$(window).trigger("hash",h)},100),links=links?links.add(els):els,els.click(function(e){var href=$(this).attr("href");return iframe&&setIframeLocation(href),"#"!=href.slice(0,1)?(location.href="#"+href,e.preventDefault()):void 0}),inited=!0)}},$(window).on("hash",function(e,h){h?links.filter(function(){var href=$(this).attr("href");return href==h||href==h.replace("#","")}).trigger("history",[h]):links.eq(0).trigger("history",[h]),hash=h}),$.fn.history=function(fn){return $.tools.history.init(this),this.on("history",fn)}}(jQuery),function($){function viewport(){if(/msie/.test(navigator.userAgent.toLowerCase())){var d=$(document).height(),w=$(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,20>d-w?w:d]}return[$(document).width(),$(document).height()]}function call(fn){return fn?fn.call($.mask):void 0}$.tools=$.tools||{version:"@VERSION"};var tool;tool=$.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};var mask,exposed,loaded,config,overlayIndex;$.mask={load:function(conf,els){if(loaded)return this;"string"==typeof conf&&(conf={color:conf}),conf=conf||config,config=conf=$.extend($.extend({},tool.conf),conf),mask=$("#"+conf.maskId),mask.length||(mask=$("<div/>").attr("id",conf.maskId),$("body").append(mask));var size=viewport();return mask.css({position:"absolute",top:0,left:0,width:size[0],height:size[1],display:"none",opacity:conf.startOpacity,zIndex:conf.zIndex}),conf.color&&mask.css("backgroundColor",conf.color),call(conf.onBeforeLoad)===!1?this:(conf.closeOnEsc&&$(document).on("keydown.mask",function(e){27==e.keyCode&&$.mask.close(e)}),conf.closeOnClick&&mask.on("click.mask",function(e){$.mask.close(e)}),$(window).on("resize.mask",function(){$.mask.fit()}),els&&els.length&&(overlayIndex=els.eq(0).css("zIndex"),$.each(els,function(){var el=$(this);/relative|absolute|fixed/i.test(el.css("position"))||el.css("position","relative")}),exposed=els.css({zIndex:Math.max(conf.zIndex+1,"auto"==overlayIndex?0:overlayIndex)})),mask.css({display:"block"}).fadeTo(conf.loadSpeed,conf.opacity,function(){$.mask.fit(),call(conf.onLoad),loaded="full"}),loaded=!0,this)},close:function(){if(loaded){if(call(config.onBeforeClose)===!1)return this;mask.fadeOut(config.closeSpeed,function(){exposed&&exposed.css({zIndex:overlayIndex}),loaded=!1,call(config.onClose)}),$(document).off("keydown.mask"),mask.off("click.mask"),$(window).off("resize.mask")}return this},fit:function(){if(loaded){var size=viewport();mask.css({width:size[0],height:size[1]})}},getMask:function(){return mask},isLoaded:function(fully){return fully?"full"==loaded:loaded},getConf:function(){return config},getExposed:function(){return exposed}},$.fn.mask=function(conf){return $.mask.load(conf),this},$.fn.expose=function(conf){return $.mask.load(conf,this),this}}(jQuery);
\ No newline at end of file
+!function($){function Overlay(trigger,conf){var closers,overlay,opened,self=this,fire=trigger.add(self),w=$(window),maskConf=$.tools.expose&&(conf.mask||conf.expose),uid=Math.random().toString().slice(10);maskConf&&("string"==typeof maskConf&&(maskConf={color:maskConf}),maskConf.closeOnClick=maskConf.closeOnEsc=!1);var jq=conf.target||trigger.attr("rel");if(overlay=jq?$(jq):trigger,!overlay.length)throw"Could not find Overlay: "+jq;trigger&&trigger.index(overlay)==-1&&trigger.click(function(e){return self.load(e),e.preventDefault()}),$.extend(self,{load:function(e){if(self.isOpened())return self;var eff=effects[conf.effect];if(!eff)throw'Overlay: cannot find effect : "'+conf.effect+'"';if(conf.oneInstance&&$.each(instances,function(){this.close(e)}),e=e||$.Event(),e.type="onBeforeLoad",fire.trigger(e),e.isDefaultPrevented())return self;opened=!0,maskConf&&$(overlay).expose(maskConf);var top=conf.top,left=conf.left,oWidth=overlay.outerWidth(!0),oHeight=overlay.outerHeight(!0);return"string"==typeof top&&(top="center"==top?Math.max((w.height()-oHeight)/2,0):parseInt(top,10)/100*w.height()),"center"==left&&(left=Math.max((w.width()-oWidth)/2,0)),eff[0].call(self,{top:top,left:left},function(){opened&&(e.type="onLoad",fire.trigger(e))}),maskConf&&conf.closeOnClick&&$.mask.getMask().one("click",self.close),conf.closeOnClick&&$(document).on("click."+uid,function(e){$(e.target).parents(overlay).length||self.close(e)}),conf.closeOnEsc&&$(document).on("keydown."+uid,function(e){27==e.keyCode&&self.close(e)}),self},close:function(e){return self.isOpened()?(e=e||$.Event(),e.type="onBeforeClose",fire.trigger(e),e.isDefaultPrevented()?void 0:(opened=!1,effects[conf.effect][1].call(self,function(){e.type="onClose",fire.trigger(e)}),$(document).off("click."+uid+" keydown."+uid),maskConf&&$.mask.close(),self)):self},getOverlay:function(){return overlay},getTrigger:function(){return trigger},getClosers:function(){return closers},isOpened:function(){return opened},getConf:function(){return conf}}),$.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),closers=overlay.find(conf.close||".close"),closers.length||conf.close||(closers=$('<a class="close"></a>'),overlay.prepend(closers)),closers.click(function(e){self.close(e)}),conf.load&&self.load()}$.tools=$.tools||{version:"@VERSION"},$.tools.overlay={addEffect:function(name,loadFn,closeFn){effects[name]=[loadFn,closeFn]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!/msie/.test(navigator.userAgent.toLowerCase())||navigator.appVersion>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var instances=[],effects={};$.tools.overlay.addEffect("default",function(pos,onLoad){var conf=this.getConf(),w=$(window);conf.fixed||(pos.top+=w.scrollTop(),pos.left+=w.scrollLeft()),pos.position=conf.fixed?"fixed":"absolute",this.getOverlay().css(pos).fadeIn(conf.speed,onLoad)},function(onClose){this.getOverlay().fadeOut(this.getConf().closeSpeed,onClose)}),$.fn.overlay=function(conf){var el=this.data("overlay");return el?el:($.isFunction(conf)&&(conf={onBeforeLoad:conf}),conf=$.extend(!0,{},$.tools.overlay.conf,conf),this.each(function(){el=new Overlay($(this),conf),instances.push(el),$(this).data("overlay",el)}),conf.api?el:this)}}(jQuery),function($){function find(root,query){var el=$(query);return el.length<2?el:root.parent().find(query)}function Scrollable(root,conf){var self=this,fire=root.add(self),itemWrap=root.children(),index=0,vertical=conf.vertical;if(current||(current=self),itemWrap.length>1&&(itemWrap=$(conf.items,root)),conf.size>1&&(conf.circular=!1),$.extend(self,{getConf:function(){return conf},getIndex:function(){return index},getSize:function(){return self.getItems().size()},getNaviButtons:function(){return prev.add(next)},getRoot:function(){return root},getItemWrap:function(){return itemWrap},getItems:function(){return itemWrap.find(conf.item).not("."+conf.clonedClass)},move:function(offset,time){return self.seekTo(index+offset,time)},next:function(time){return self.move(conf.size,time)},prev:function(time){return self.move(-conf.size,time)},begin:function(time){return self.seekTo(0,time)},end:function(time){return self.seekTo(self.getSize()-1,time)},focus:function(){return current=self,self},addItem:function(item){return item=$(item),conf.circular?(itemWrap.children().last().before(item),itemWrap.children().first().replaceWith(item.clone().addClass(conf.clonedClass))):(itemWrap.append(item),next.removeClass("disabled")),fire.trigger("onAddItem",[item]),self},seekTo:function(i,time,fn){if(i.jquery||(i*=1),conf.circular&&0===i&&index==-1&&0!==time)return self;if(!conf.circular&&i<0||i>self.getSize()||i<-1)return self;var item=i;i.jquery?i=self.getItems().index(i):item=self.getItems().eq(i);var e=$.Event("onBeforeSeek");if(!fn&&(fire.trigger(e,[i,time]),e.isDefaultPrevented()||!item.length))return self;var props=vertical?{top:-item.position().top}:{left:-item.position().left};return index=i,current=self,void 0===time&&(time=conf.speed),itemWrap.animate(props,time,conf.easing,fn||function(){fire.trigger("onSeek",[i])}),self}}),$.each(["onBeforeSeek","onSeek","onAddItem"],function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.circular){var cloned1=self.getItems().slice(-1).clone().prependTo(itemWrap),cloned2=self.getItems().eq(1).clone().appendTo(itemWrap);cloned1.add(cloned2).addClass(conf.clonedClass),self.onBeforeSeek(function(e,i,time){if(!e.isDefaultPrevented())return i==-1?(self.seekTo(cloned1,time,function(){self.end(0)}),e.preventDefault()):void(i==self.getSize()&&self.seekTo(cloned2,time,function(){self.begin(0)}))});var hidden_parents=root.parents().add(root).filter(function(){if("none"===$(this).css("display"))return!0});hidden_parents.length?(hidden_parents.show(),self.seekTo(0,0,function(){}),hidden_parents.hide()):self.seekTo(0,0,function(){})}var prev=find(root,conf.prev).click(function(e){e.stopPropagation(),self.prev()}),next=find(root,conf.next).click(function(e){e.stopPropagation(),self.next()});if(conf.circular||(self.onBeforeSeek(function(e,i){setTimeout(function(){e.isDefaultPrevented()||(prev.toggleClass(conf.disabledClass,i<=0),next.toggleClass(conf.disabledClass,i>=self.getSize()-1))},1)}),conf.initialIndex||prev.addClass(conf.disabledClass)),self.getSize()<2&&prev.add(next).addClass(conf.disabledClass),conf.mousewheel&&$.fn.mousewheel&&root.mousewheel(function(e,delta){if(conf.mousewheel)return self.move(delta<0?1:-1,conf.wheelSpeed||50),!1}),conf.touch){var touch={};itemWrap[0].ontouchstart=function(e){var t=e.touches[0];touch.x=t.clientX,touch.y=t.clientY},itemWrap[0].ontouchmove=function(e){if(1==e.touches.length&&!itemWrap.is(":animated")){var t=e.touches[0],deltaX=touch.x-t.clientX,deltaY=touch.y-t.clientY;self[vertical&&deltaY>0||!vertical&&deltaX>0?"next":"prev"](),e.preventDefault()}}}conf.keyboard&&$(document).on("keydown.scrollable",function(evt){if(!(!conf.keyboard||evt.altKey||evt.ctrlKey||evt.metaKey||$(evt.target).is(":input")||"static"!=conf.keyboard&&current!=self)){var key=evt.keyCode;return!vertical||38!=key&&40!=key?vertical||37!=key&&39!=key?void 0:(self.move(37==key?-1:1),evt.preventDefault()):(self.move(38==key?-1:1),evt.preventDefault())}}),conf.initialIndex&&self.seekTo(conf.initialIndex,0,function(){})}$.tools=$.tools||{version:"@VERSION"},$.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}};var current;$.fn.scrollable=function(conf){var el=this.data("scrollable");return el?el:(conf=$.extend({},$.tools.scrollable.conf,conf),this.each(function(){el=new Scrollable($(this),conf),$(this).data("scrollable",el)}),conf.api?el:this)}}(jQuery),function($){function Tabs(root,paneSelector,conf){var current,self=this,trigger=root.add(this),tabs=root.find(conf.tabs),panes=paneSelector.jquery?paneSelector:root.children(paneSelector);tabs.length||(tabs=root.children()),panes.length||(panes=root.parent().find(paneSelector)),panes.length||(panes=$(paneSelector)),$.extend(this,{click:function(i,e){var tab=tabs.eq(i),firstRender=!root.data("tabs");if("string"==typeof i&&i.replace("#","")&&(tab=tabs.filter('[href*="'+i.replace("#","")+'"]'),i=Math.max(tabs.index(tab),0)),conf.rotate){var last=tabs.length-1;if(i<0)return self.click(last,e);if(i>last)return self.click(0,e)}if(!tab.length){if(current>=0)return self;i=conf.initialIndex,tab=tabs.eq(i)}if(i===current)return self;if(e=e||$.Event(),e.type="onBeforeClick",trigger.trigger(e,[i]),!e.isDefaultPrevented()){var effect=firstRender?conf.initialEffect&&conf.effect||"default":conf.effect;return effects[effect].call(self,i,function(){current=i,e.type="onClick",trigger.trigger(e,[i])}),tabs.removeClass(conf.current),tab.addClass(conf.current),self}},getConf:function(){return conf},getTabs:function(){return tabs},getPanes:function(){return panes},getCurrentPane:function(){return panes.eq(current)},getCurrentTab:function(){return tabs.eq(current)},getIndex:function(){return current},next:function(){return self.click(current+1)},prev:function(){return self.click(current-1)},destroy:function(){return tabs.off(conf.event).removeClass(conf.current),panes.find('a[href^="#"]').off("click.T"),self}}),$.each("onBeforeClick,onClick".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.history&&$.fn.history&&($.tools.history.init(tabs),conf.event="history"),tabs.each(function(i){$(this).on(conf.event,function(e){return self.click(i,e),e.preventDefault()})}),panes.find('a[href^="#"]').on("click.T",function(e){self.click($(this).attr("href"),e)}),location.hash&&"a"==conf.tabs&&root.find('[href="'+location.hash+'"]').length?self.click(location.hash):(0===conf.initialIndex||conf.initialIndex>0)&&self.click(conf.initialIndex)}$.tools=$.tools||{version:"@VERSION"},$.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialEffect:!1,initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(name,fn){effects[name]=fn}};var animating,w,effects={default:function(i,done){this.getPanes().hide().eq(i).show(),done.call()},fade:function(i,done){var conf=this.getConf(),speed=conf.fadeOutSpeed,panes=this.getPanes();speed?panes.fadeOut(speed):panes.hide(),panes.eq(i).fadeIn(conf.fadeInSpeed,done)},slide:function(i,done){var conf=this.getConf();this.getPanes().slideUp(conf.slideUpSpeed),this.getPanes().eq(i).slideDown(conf.slideDownSpeed,done)},ajax:function(i,done){this.getPanes().eq(0).load(this.getTabs().eq(i).attr("href"),done)}};$.tools.tabs.addEffect("horizontal",function(i,done){if(!animating){var nextPane=this.getPanes().eq(i),currentPane=this.getCurrentPane();w||(w=this.getPanes().eq(0).width()),animating=!0,nextPane.show(),currentPane.animate({width:0},{step:function(now){nextPane.css("width",w-now)},complete:function(){$(this).hide(),done.call(),animating=!1}}),currentPane.length||(done.call(),animating=!1)}}),$.fn.tabs=function(paneSelector,conf){var el=this.data("tabs");return el&&(el.destroy(),this.removeData("tabs")),$.isFunction(conf)&&(conf={onBeforeClick:conf}),conf=$.extend({},$.tools.tabs.conf,conf),this.each(function(){el=new Tabs($(this),paneSelector,conf),$(this).data("tabs",el)}),conf.api?el:this}}(jQuery),function($){function setIframeLocation(h){if(h){var doc=iframe.contentWindow.document;doc.open().close(),doc.location.hash=h}}var hash,iframe,links,inited;$.tools=$.tools||{version:"@VERSION"},$.tools.history={init:function(els){inited||($.browser.msie&&$.browser.version<"8"?iframe||(iframe=$("<iframe/>").attr("src","javascript:false;").hide().get(0),$("body").append(iframe),setInterval(function(){var idoc=iframe.contentWindow.document,h=idoc.location.hash;hash!==h&&$(window).trigger("hash",h)},100),setIframeLocation(location.hash||"#")):setInterval(function(){var h=location.hash;h!==hash&&$(window).trigger("hash",h)},100),links=links?links.add(els):els,els.click(function(e){var href=$(this).attr("href");if(iframe&&setIframeLocation(href),"#"!=href.slice(0,1))return location.href="#"+href,e.preventDefault()}),inited=!0)}},$(window).on("hash",function(e,h){h?links.filter(function(){var href=$(this).attr("href");return href==h||href==h.replace("#","")}).trigger("history",[h]):links.eq(0).trigger("history",[h]),hash=h}),$.fn.history=function(fn){return $.tools.history.init(this),this.on("history",fn)}}(jQuery),function($){function viewport(){if(/msie/.test(navigator.userAgent.toLowerCase())){var d=$(document).height(),w=$(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d-w<20?w:d]}return[$(document).width(),$(document).height()]}function call(fn){if(fn)return fn.call($.mask)}$.tools=$.tools||{version:"@VERSION"};var tool;tool=$.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};var mask,exposed,loaded,config,overlayIndex;$.mask={load:function(conf,els){if(loaded)return this;"string"==typeof conf&&(conf={color:conf}),conf=conf||config,config=conf=$.extend($.extend({},tool.conf),conf),mask=$("#"+conf.maskId),mask.length||(mask=$("<div/>").attr("id",conf.maskId),$("body").append(mask));var size=viewport();return mask.css({position:"absolute",top:0,left:0,width:size[0],height:size[1],display:"none",opacity:conf.startOpacity,zIndex:conf.zIndex}),conf.color&&mask.css("backgroundColor",conf.color),call(conf.onBeforeLoad)===!1?this:(conf.closeOnEsc&&$(document).on("keydown.mask",function(e){27==e.keyCode&&$.mask.close(e)}),conf.closeOnClick&&mask.on("click.mask",function(e){$.mask.close(e)}),$(window).on("resize.mask",function(){$.mask.fit()}),els&&els.length&&(overlayIndex=els.eq(0).css("zIndex"),$.each(els,function(){var el=$(this);/relative|absolute|fixed/i.test(el.css("position"))||el.css("position","relative")}),exposed=els.css({zIndex:Math.max(conf.zIndex+1,"auto"==overlayIndex?0:overlayIndex)})),mask.css({display:"block"}).fadeTo(conf.loadSpeed,conf.opacity,function(){$.mask.fit(),call(conf.onLoad),loaded="full"}),loaded=!0,this)},close:function(){if(loaded){if(call(config.onBeforeClose)===!1)return this;mask.fadeOut(config.closeSpeed,function(){exposed&&exposed.css({zIndex:overlayIndex}),loaded=!1,call(config.onClose)}),$(document).off("keydown.mask"),mask.off("click.mask"),$(window).off("resize.mask")}return this},fit:function(){if(loaded){var size=viewport();mask.css({width:size[0],height:size[1]})}},getMask:function(){return mask},isLoaded:function(fully){return fully?"full"==loaded:loaded},getConf:function(){return config},getExposed:function(){return exposed}},$.fn.mask=function(conf){return $.mask.load(conf),this},$.fn.expose=function(conf){return $.mask.load(conf,this),this}}(jQuery);
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.plugins.min.js b/plone/app/jquerytools/browser/jquery.tools.plugins.min.js
index fb297fb..6308804 100644
--- a/plone/app/jquerytools/browser/jquery.tools.plugins.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.plugins.min.js
@@ -1 +1 @@
-!function($){function getPosition(el){var p=el.offset();return{top:p.top+el.height()/2,left:p.left+el.width()/2}}var t=$.tools.overlay,w=$(window);$.extend(t.conf,{start:{top:null,left:null},fadeInSpeed:"fast",zIndex:9999});var loadEffect=function(pos,onLoad){var overlay=this.getOverlay(),conf=this.getConf(),trigger=this.getTrigger(),self=this,oWidth=overlay.outerWidth(!0),img=overlay.data("img"),position=conf.fixed?"fixed":"absolute";if(!img){var bg=overlay.css("backgroundImage");if(!bg)throw"background-image CSS property not set for overlay";bg=bg.slice(bg.indexOf("(")+1,bg.indexOf(")")).replace(/\"/g,""),overlay.css("backgroundImage","none"),img=$('<img src="'+bg+'"/>'),img.css({border:0,display:"none"}).width(oWidth),$("body").append(img),overlay.data("img",img)}var itop=conf.start.top||Math.round(w.height()/2),ileft=conf.start.left||Math.round(w.width()/2);if(trigger){var p=getPosition(trigger);itop=p.top,ileft=p.left}conf.fixed?(itop-=w.scrollTop(),ileft-=w.scrollLeft()):(pos.top+=w.scrollTop(),pos.left+=w.scrollLeft()),img.css({position:"absolute",top:itop,left:ileft,width:0,zIndex:conf.zIndex}).show(),pos.position=position,overlay.css(pos),img.animate({top:pos.top,left:pos.left,width:oWidth},conf.speed,function(){overlay.css("zIndex",conf.zIndex+1).fadeIn(conf.fadeInSpeed,function(){self.isOpened()&&!$(this).index(overlay)?onLoad.call():overlay.hide()})}).css("position",position)},closeEffect=function(onClose){var overlay=this.getOverlay().hide(),conf=this.getConf(),trigger=this.getTrigger(),img=overlay.data("img"),css={top:conf.start.top,left:conf.start.left,width:0};trigger&&$.extend(css,getPosition(trigger)),conf.fixed&&img.css({position:"absolute"}).animate({top:"+="+w.scrollTop(),left:"+="+w.scrollLeft()},0),img.animate(css,conf.closeSpeed,onClose)};t.addEffect("apple",loadEffect,closeEffect)}(jQuery),function($){var t=$.tools.scrollable;t.autoscroll={conf:{autoplay:!0,interval:3e3,autopause:!0}},$.fn.autoscroll=function(conf){"number"==typeof conf&&(conf={interval:conf});var ret,opts=$.extend({},t.autoscroll.conf,conf);return this.each(function(){function scroll(){timer&&clearTimeout(timer),timer=setTimeout(function(){api.next()},opts.interval)}var timer,api=$(this).data("scrollable"),root=api.getRoot(),stopped=!1;api&&(ret=api),api.play=function(){timer||(stopped=!1,root.on("onSeek",scroll),scroll())},api.pause=function(){timer=clearTimeout(timer),root.off("onSeek",scroll)},api.resume=function(){stopped||api.play()},api.stop=function(){stopped=!0,api.pause()},opts.autopause&&root.add(api.getNaviButtons()).hover(api.pause,api.resume),opts.autoplay&&api.play()}),opts.api?ret:this}}(jQuery),function($){function find(root,query){var el=$(query);return el.length<2?el:root.parent().find(query)}var t=$.tools.scrollable;t.navigator={conf:{navi:".navi",naviItem:null,activeClass:"active",indexed:!1,idPrefix:null,history:!1}},$.fn.navigator=function(conf){"string"==typeof conf&&(conf={navi:conf}),conf=$.extend({},t.navigator.conf,conf);var ret;return this.each(function(){function doClick(el,i,e){api.seekTo(i),e.preventDefault(),hashed&&history.pushState({i:i},"")}function els(){return navi.find(conf.naviItem||"> *")}function addItem(i){var item=$("<"+(conf.naviItem||"a")+"/>").click(function(e){doClick($(this),i,e)});return 0===i&&item.addClass(cls),conf.indexed&&item.text(i+1),conf.idPrefix&&item.attr("id",conf.idPrefix+i),item.appendTo(navi)}var api=$(this).data("scrollable"),navi=conf.navi.jquery?conf.navi:find(api.getRoot(),conf.navi),buttons=api.getNaviButtons(),cls=conf.activeClass,hashed=conf.history&&!!history.pushState,size=api.getConf().size;api&&(ret=api),api.getNaviButtons=function(){return buttons.add(navi)},hashed&&(history.pushState({i:0},""),$(window).on("popstate",function(evt){var s=evt.originalEvent.state;s&&api.seekTo(s.i)})),els().length?els().each(function(i){$(this).click(function(e){doClick($(this),i,e)})}):$.each(api.getItems(),function(i){i%size==0&&addItem(i)}),api.onBeforeSeek(function(e,index){setTimeout(function(){if(!e.isDefaultPrevented()){var i=index/size,el=els().eq(i);el.length&&els().removeClass(cls).eq(i).addClass(cls)}},1)}),api.onAddItem(function(e,item){var i=api.getItems().index(item);i%size==0&&addItem(i)})}),conf.api?ret:this}}(jQuery),function($){function Slideshow(root,conf){function find(query){var el=$(query);return el.length<2?el:root.parent().find(query)}function next(){timer&&clearTimeout(timer),timer=setTimeout(function(){tabs.next()},conf.interval)}var timer,self=this,fire=root.add(this),tabs=root.data("tabs"),stopped=!0,nextButton=find(conf.next).click(function(){tabs.next()}),prevButton=find(conf.prev).click(function(){tabs.prev()});if($.extend(self,{getTabs:function(){return tabs},getConf:function(){return conf},play:function(){if(timer)return self;var e=$.Event("onBeforePlay");return fire.trigger(e),e.isDefaultPrevented()?self:(stopped=!1,fire.trigger("onPlay"),fire.on("onClick",next),next(),self)},pause:function(){if(!timer)return self;var e=$.Event("onBeforePause");return fire.trigger(e),e.isDefaultPrevented()?self:(timer=clearTimeout(timer),fire.trigger("onPause"),fire.off("onClick",next),self)},resume:function(){stopped||self.play()},stop:function(){self.pause(),stopped=!0}}),$.each("onBeforePlay,onPlay,onBeforePause,onPause".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return $(self).on(name,fn)}}),conf.autopause&&tabs.getTabs().add(nextButton).add(prevButton).add(tabs.getPanes()).hover(self.pause,self.resume),conf.autoplay&&self.play(),conf.clickable&&tabs.getPanes().click(function(){tabs.next()}),!tabs.getConf().rotate){var disabled=conf.disabledClass;tabs.getIndex()||prevButton.addClass(disabled),tabs.onBeforeClick(function(e,i){prevButton.toggleClass(disabled,!i),nextButton.toggleClass(disabled,i==tabs.getTabs().length-1)})}}var tool;tool=$.tools.tabs.slideshow={conf:{next:".forward",prev:".backward",disabledClass:"disabled",autoplay:!1,autopause:!0,interval:3e3,clickable:!0,api:!1}},$.fn.slideshow=function(conf){var el=this.data("slideshow");return el?el:(conf=$.extend({},tool.conf,conf),this.each(function(){el=new Slideshow($(this),conf),$(this).data("slideshow",el)}),conf.api?el:this)}}(jQuery),function(){function extend(to,from){if(from)for(var key in from)from.hasOwnProperty(key)&&(to[key]=from[key]);return to}function map(arr,func){var newArr=[];for(var i in arr)arr.hasOwnProperty(i)&&(newArr[i]=func(arr[i]));return newArr}function Flash(root,opts,conf){if(f.isSupported(opts.version))root.innerHTML=f.getHTML(opts,conf);else if(opts.expressInstall&&f.isSupported([6,65]))root.innerHTML=f.getHTML(extend(opts,{src:opts.expressInstall}),{MMredirectURL:location.href,MMplayerType:"PlugIn",MMdoctitle:document.title});else if(root.innerHTML.replace(/\s/g,"")||(root.innerHTML="<h2>Flash version "+opts.version+" or greater is required</h2><h3>"+(VERSION[0]>0?"Your version is "+VERSION:"You have no flash plugin installed")+"</h3>"+("A"==root.tagName?"<p>Click here to download latest version</p>":"<p>Download latest version from <a href='"+URL+"'>here</a></p>"),"A"==root.tagName&&(root.onclick=function(){location.href=URL})),opts.onFail){var ret=opts.onFail.call(this);"string"==typeof ret&&(root.innerHTML=ret)}IE&&(window[opts.id]=document.getElementById(opts.id)),extend(this,{getRoot:function(){return root},getOptions:function(){return opts},getConf:function(){return conf},getApi:function(){return root.firstChild}})}var IE=document.all,URL="http://www.adobe.com/go/getflashplayer",JQUERY="function"==typeof jQuery,RE=/(\d+)[^\d]+(\d+)[^\d]*(\d*)/,GLOBAL_OPTS={width:"100%",height:"100%",id:"_"+(""+Math.random()).slice(9),allowfullscreen:!0,allowscriptaccess:"always",quality:"high",version:[3,0],onFail:null,expressInstall:null,w3c:!1,cachebusting:!1};window.attachEvent&&window.attachEvent("onbeforeunload",function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){}}),window.flashembed=function(root,opts,conf){return"string"==typeof root&&(root=document.getElementById(root.replace("#",""))),root?("string"==typeof opts&&(opts={src:opts}),new Flash(root,extend(extend({},GLOBAL_OPTS),opts),conf)):void 0};var f=extend(window.flashembed,{conf:GLOBAL_OPTS,getVersion:function(){var fo,ver;try{ver=navigator.plugins["Shockwave Flash"].description.slice(16)}catch(e){try{fo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),ver=fo&&fo.GetVariable("$version")}catch(err){try{fo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),ver=fo&&fo.GetVariable("$version")}catch(err2){}}}return ver=RE.exec(ver),ver?[ver[1],ver[3]]:[0,0]},asString:function(obj){if(null===obj||void 0===obj)return null;var type=typeof obj;switch("object"==type&&obj.push&&(type="array"),type){case"string":return obj=obj.replace(new RegExp('(["\\\\])',"g"),"\\$1"),obj=obj.replace(/^\s?(\d+\.?\d*)%/,"$1pct"),'"'+obj+'"';case"array":return"["+map(obj,function(el){return f.asString(el)}).join(",")+"]";case"function":return'"function()"';case"object":var str=[];for(var prop in obj)obj.hasOwnProperty(prop)&&str.push('"'+prop+'":'+f.asString(obj[prop]));return"{"+str.join(",")+"}"}return String(obj).replace(/\s/g," ").replace(/\'/g,'"')},getHTML:function(opts,conf){opts=extend({},opts);var html='<object width="'+opts.width+'" height="'+opts.height+'" id="'+opts.id+'" name="'+opts.id+'"';opts.cachebusting&&(opts.src+=(-1!=opts.src.indexOf("?")?"&":"?")+Math.random()),html+=opts.w3c||!IE?' data="'+opts.src+'" type="application/x-shockwave-flash"':' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"',html+=">",(opts.w3c||IE)&&(html+='<param name="movie" value="'+opts.src+'" />'),opts.width=opts.height=opts.id=opts.w3c=opts.src=null,opts.onFail=opts.version=opts.expressInstall=null;for(var key in opts)opts[key]&&(html+='<param name="'+key+'" value="'+opts[key]+'" />');var vars="";if(conf){for(var k in conf)if(conf[k]){var val=conf[k];vars+=k+"="+encodeURIComponent(/function|object/.test(typeof val)?f.asString(val):val)+"&"}vars=vars.slice(0,-1),html+='<param name="flashvars" value=\''+vars+"' />"}return html+="</object>"},isSupported:function(ver){return VERSION[0]>ver[0]||VERSION[0]==ver[0]&&VERSION[1]>=ver[1]}}),VERSION=f.getVersion();JQUERY&&(jQuery.tools=jQuery.tools||{version:"@VERSION"},jQuery.tools.flashembed={conf:GLOBAL_OPTS},jQuery.fn.flashembed=function(opts,conf){return this.each(function(){jQuery(this).data("flashembed",flashembed(this,opts,conf))})})}(),function($){function wheelHandler(event){switch(event.type){case"mousemove":return $.extend(event.data,{clientX:event.clientX,clientY:event.clientY,pageX:event.pageX,pageY:event.pageY});case"DOMMouseScroll":$.extend(event,event.data),event.delta=-event.detail/3;break;case"mousewheel":event.delta=event.wheelDelta/120}return event.type="wheel",$.event.handle.call(this,event,event.delta)}$.fn.mousewheel=function(fn){return this[fn?"on":"trigger"]("wheel",fn)},$.event.special.wheel={setup:function(){$.event.add(this,wheelEvents,wheelHandler,{})},teardown:function(){$.event.remove(this,wheelEvents,wheelHandler)}};var wheelEvents=$.browser.mozilla?"DOMMouseScroll"+($.browser.version<"1.9"?" mousemove":""):"mousewheel"}(jQuery);
\ No newline at end of file
+!function($){function getPosition(el){var p=el.offset();return{top:p.top+el.height()/2,left:p.left+el.width()/2}}var t=$.tools.overlay,w=$(window);$.extend(t.conf,{start:{top:null,left:null},fadeInSpeed:"fast",zIndex:9999});var loadEffect=function(pos,onLoad){var overlay=this.getOverlay(),conf=this.getConf(),trigger=this.getTrigger(),self=this,oWidth=overlay.outerWidth(!0),img=overlay.data("img"),position=conf.fixed?"fixed":"absolute";if(!img){var bg=overlay.css("backgroundImage");if(!bg)throw"background-image CSS property not set for overlay";bg=bg.slice(bg.indexOf("(")+1,bg.indexOf(")")).replace(/\"/g,""),overlay.css("backgroundImage","none"),img=$('<img src="'+bg+'"/>'),img.css({border:0,display:"none"}).width(oWidth),$("body").append(img),overlay.data("img",img)}var itop=conf.start.top||Math.round(w.height()/2),ileft=conf.start.left||Math.round(w.width()/2);if(trigger){var p=getPosition(trigger);itop=p.top,ileft=p.left}conf.fixed?(itop-=w.scrollTop(),ileft-=w.scrollLeft()):(pos.top+=w.scrollTop(),pos.left+=w.scrollLeft()),img.css({position:"absolute",top:itop,left:ileft,width:0,zIndex:conf.zIndex}).show(),pos.position=position,overlay.css(pos),img.animate({top:pos.top,left:pos.left,width:oWidth},conf.speed,function(){overlay.css("zIndex",conf.zIndex+1).fadeIn(conf.fadeInSpeed,function(){self.isOpened()&&!$(this).index(overlay)?onLoad.call():overlay.hide()})}).css("position",position)},closeEffect=function(onClose){var overlay=this.getOverlay().hide(),conf=this.getConf(),trigger=this.getTrigger(),img=overlay.data("img"),css={top:conf.start.top,left:conf.start.left,width:0};trigger&&$.extend(css,getPosition(trigger)),conf.fixed&&img.css({position:"absolute"}).animate({top:"+="+w.scrollTop(),left:"+="+w.scrollLeft()},0),img.animate(css,conf.closeSpeed,onClose)};t.addEffect("apple",loadEffect,closeEffect)}(jQuery),function($){var t=$.tools.scrollable;t.autoscroll={conf:{autoplay:!0,interval:3e3,autopause:!0}},$.fn.autoscroll=function(conf){"number"==typeof conf&&(conf={interval:conf});var ret,opts=$.extend({},t.autoscroll.conf,conf);return this.each(function(){function scroll(){timer&&clearTimeout(timer),timer=setTimeout(function(){api.next()},opts.interval)}var timer,api=$(this).data("scrollable"),root=api.getRoot(),stopped=!1;api&&(ret=api),api.play=function(){timer||(stopped=!1,root.on("onSeek",scroll),scroll())},api.pause=function(){timer=clearTimeout(timer),root.off("onSeek",scroll)},api.resume=function(){stopped||api.play()},api.stop=function(){stopped=!0,api.pause()},opts.autopause&&root.add(api.getNaviButtons()).hover(api.pause,api.resume),opts.autoplay&&api.play()}),opts.api?ret:this}}(jQuery),function($){function find(root,query){var el=$(query);return el.length<2?el:root.parent().find(query)}var t=$.tools.scrollable;t.navigator={conf:{navi:".navi",naviItem:null,activeClass:"active",indexed:!1,idPrefix:null,history:!1}},$.fn.navigator=function(conf){"string"==typeof conf&&(conf={navi:conf}),conf=$.extend({},t.navigator.conf,conf);var ret;return this.each(function(){function doClick(el,i,e){api.seekTo(i),e.preventDefault(),hashed&&history.pushState({i:i},"")}function els(){return navi.find(conf.naviItem||"> *")}function addItem(i){var item=$("<"+(conf.naviItem||"a")+"/>").click(function(e){doClick($(this),i,e)});return 0===i&&item.addClass(cls),conf.indexed&&item.text(i+1),conf.idPrefix&&item.attr("id",conf.idPrefix+i),item.appendTo(navi)}var api=$(this).data("scrollable"),navi=conf.navi.jquery?conf.navi:find(api.getRoot(),conf.navi),buttons=api.getNaviButtons(),cls=conf.activeClass,hashed=conf.history&&!!history.pushState,size=api.getConf().size;api&&(ret=api),api.getNaviButtons=function(){return buttons.add(navi)},hashed&&(history.pushState({i:0},""),$(window).on("popstate",function(evt){var s=evt.originalEvent.state;s&&api.seekTo(s.i)})),els().length?els().each(function(i){$(this).click(function(e){doClick($(this),i,e)})}):$.each(api.getItems(),function(i){i%size==0&&addItem(i)}),api.onBeforeSeek(function(e,index){setTimeout(function(){if(!e.isDefaultPrevented()){var i=index/size,el=els().eq(i);el.length&&els().removeClass(cls).eq(i).addClass(cls)}},1)}),api.onAddItem(function(e,item){var i=api.getItems().index(item);i%size==0&&addItem(i)})}),conf.api?ret:this}}(jQuery),function($){function Slideshow(root,conf){function find(query){var el=$(query);return el.length<2?el:root.parent().find(query)}function next(){timer&&clearTimeout(timer),timer=setTimeout(function(){tabs.next()},conf.interval)}var timer,self=this,fire=root.add(this),tabs=root.data("tabs"),stopped=!0,nextButton=find(conf.next).click(function(){tabs.next()}),prevButton=find(conf.prev).click(function(){tabs.prev()});if($.extend(self,{getTabs:function(){return tabs},getConf:function(){return conf},play:function(){if(timer)return self;var e=$.Event("onBeforePlay");return fire.trigger(e),e.isDefaultPrevented()?self:(stopped=!1,fire.trigger("onPlay"),fire.on("onClick",next),next(),self)},pause:function(){if(!timer)return self;var e=$.Event("onBeforePause");return fire.trigger(e),e.isDefaultPrevented()?self:(timer=clearTimeout(timer),fire.trigger("onPause"),fire.off("onClick",next),self)},resume:function(){stopped||self.play()},stop:function(){self.pause(),stopped=!0}}),$.each("onBeforePlay,onPlay,onBeforePause,onPause".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return $(self).on(name,fn)}}),conf.autopause&&tabs.getTabs().add(nextButton).add(prevButton).add(tabs.getPanes()).hover(self.pause,self.resume),conf.autoplay&&self.play(),conf.clickable&&tabs.getPanes().click(function(){tabs.next()}),!tabs.getConf().rotate){var disabled=conf.disabledClass;tabs.getIndex()||prevButton.addClass(disabled),tabs.onBeforeClick(function(e,i){prevButton.toggleClass(disabled,!i),nextButton.toggleClass(disabled,i==tabs.getTabs().length-1)})}}var tool;tool=$.tools.tabs.slideshow={conf:{next:".forward",prev:".backward",disabledClass:"disabled",autoplay:!1,autopause:!0,interval:3e3,clickable:!0,api:!1}},$.fn.slideshow=function(conf){var el=this.data("slideshow");return el?el:(conf=$.extend({},tool.conf,conf),this.each(function(){el=new Slideshow($(this),conf),$(this).data("slideshow",el)}),conf.api?el:this)}}(jQuery),function(){function extend(to,from){if(from)for(var key in from)from.hasOwnProperty(key)&&(to[key]=from[key]);return to}function map(arr,func){var newArr=[];for(var i in arr)arr.hasOwnProperty(i)&&(newArr[i]=func(arr[i]));return newArr}function Flash(root,opts,conf){if(f.isSupported(opts.version))root.innerHTML=f.getHTML(opts,conf);else if(opts.expressInstall&&f.isSupported([6,65]))root.innerHTML=f.getHTML(extend(opts,{src:opts.expressInstall}),{MMredirectURL:location.href,MMplayerType:"PlugIn",MMdoctitle:document.title});else if(root.innerHTML.replace(/\s/g,"")||(root.innerHTML="<h2>Flash version "+opts.version+" or greater is required</h2><h3>"+(VERSION[0]>0?"Your version is "+VERSION:"You have no flash plugin installed")+"</h3>"+("A"==root.tagName?"<p>Click here to download latest version</p>":"<p>Download latest version from <a href='"+URL+"'>here</a></p>"),"A"==root.tagName&&(root.onclick=function(){location.href=URL})),opts.onFail){var ret=opts.onFail.call(this);"string"==typeof ret&&(root.innerHTML=ret)}IE&&(window[opts.id]=document.getElementById(opts.id)),extend(this,{getRoot:function(){return root},getOptions:function(){return opts},getConf:function(){return conf},getApi:function(){return root.firstChild}})}var IE=document.all,URL="http://www.adobe.com/go/getflashplayer",JQUERY="function"==typeof jQuery,RE=/(\d+)[^\d]+(\d+)[^\d]*(\d*)/,GLOBAL_OPTS={width:"100%",height:"100%",id:"_"+(""+Math.random()).slice(9),allowfullscreen:!0,allowscriptaccess:"always",quality:"high",version:[3,0],onFail:null,expressInstall:null,w3c:!1,cachebusting:!1};window.attachEvent&&window.attachEvent("onbeforeunload",function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){}}),window.flashembed=function(root,opts,conf){if("string"==typeof root&&(root=document.getElementById(root.replace("#",""))),root)return"string"==typeof opts&&(opts={src:opts}),new Flash(root,extend(extend({},GLOBAL_OPTS),opts),conf)};var f=extend(window.flashembed,{conf:GLOBAL_OPTS,getVersion:function(){var fo,ver;try{ver=navigator.plugins["Shockwave Flash"].description.slice(16)}catch(e){try{fo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),ver=fo&&fo.GetVariable("$version")}catch(err){try{fo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),ver=fo&&fo.GetVariable("$version")}catch(err2){}}}return ver=RE.exec(ver),ver?[ver[1],ver[3]]:[0,0]},asString:function(obj){if(null===obj||void 0===obj)return null;var type=typeof obj;switch("object"==type&&obj.push&&(type="array"),type){case"string":return obj=obj.replace(new RegExp('(["\\\\])',"g"),"\\$1"),obj=obj.replace(/^\s?(\d+\.?\d*)%/,"$1pct"),'"'+obj+'"';case"array":return"["+map(obj,function(el){return f.asString(el)}).join(",")+"]";case"function":return'"function()"';case"object":var str=[];for(var prop in obj)obj.hasOwnProperty(prop)&&str.push('"'+prop+'":'+f.asString(obj[prop]));return"{"+str.join(",")+"}"}return String(obj).replace(/\s/g," ").replace(/\'/g,'"')},getHTML:function(opts,conf){opts=extend({},opts);var html='<object width="'+opts.width+'" height="'+opts.height+'" id="'+opts.id+'" name="'+opts.id+'"';opts.cachebusting&&(opts.src+=(opts.src.indexOf("?")!=-1?"&":"?")+Math.random()),html+=opts.w3c||!IE?' data="'+opts.src+'" type="application/x-shockwave-flash"':' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"',html+=">",(opts.w3c||IE)&&(html+='<param name="movie" value="'+opts.src+'" />'),opts.width=opts.height=opts.id=opts.w3c=opts.src=null,opts.onFail=opts.version=opts.expressInstall=null;for(var key in opts)opts[key]&&(html+='<param name="'+key+'" value="'+opts[key]+'" />');var vars="";if(conf){for(var k in conf)if(conf[k]){var val=conf[k];vars+=k+"="+encodeURIComponent(/function|object/.test(typeof val)?f.asString(val):val)+"&"}vars=vars.slice(0,-1),html+='<param name="flashvars" value=\''+vars+"' />"}return html+="</object>"},isSupported:function(ver){return VERSION[0]>ver[0]||VERSION[0]==ver[0]&&VERSION[1]>=ver[1]}}),VERSION=f.getVersion();JQUERY&&(jQuery.tools=jQuery.tools||{version:"@VERSION"},jQuery.tools.flashembed={conf:GLOBAL_OPTS},jQuery.fn.flashembed=function(opts,conf){return this.each(function(){jQuery(this).data("flashembed",flashembed(this,opts,conf))})})}(),function($){function wheelHandler(event){switch(event.type){case"mousemove":return $.extend(event.data,{clientX:event.clientX,clientY:event.clientY,pageX:event.pageX,pageY:event.pageY});case"DOMMouseScroll":$.extend(event,event.data),event.delta=-event.detail/3;break;case"mousewheel":event.delta=event.wheelDelta/120}return event.type="wheel",$.event.handle.call(this,event,event.delta)}$.fn.mousewheel=function(fn){return this[fn?"on":"trigger"]("wheel",fn)},$.event.special.wheel={setup:function(){$.event.add(this,wheelEvents,wheelHandler,{})},teardown:function(){$.event.remove(this,wheelEvents,wheelHandler)}};var wheelEvents=$.browser.mozilla?"DOMMouseScroll"+($.browser.version<"1.9"?" mousemove":""):"mousewheel"}(jQuery);
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.rangeinput.min.js b/plone/app/jquerytools/browser/jquery.tools.rangeinput.min.js
index 0ca8759..ccc38d3 100644
--- a/plone/app/jquerytools/browser/jquery.tools.rangeinput.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.rangeinput.min.js
@@ -1 +1 @@
-var oldFnData=jQuery.fn.data;jQuery.fn.data=function(name){var ret,evt,elem=this[0];return elem&&"events"===name&&1===arguments.length&&(ret=jQuery.data(elem,name),evt=jQuery._data(elem,name)),oldFnData.apply(this,arguments)},function($){function round(value,precision){var n=Math.pow(10,precision);return Math.round(value*n)/n}function dim(el,key){var v=parseInt(el.css(key),10);if(v)return v;var s=el[0].currentStyle;return s&&s.width&&parseInt(s.width,10)}function hasEvent(el){var e=el.data("events");return e&&e.onSlide}function RangeInput(input,conf){function slide(evt,x,val,isSetValue){if(void 0===val?val=x/len*range:isSetValue&&(val-=conf.min),step&&(val=Math.round(val/step)*step),(void 0===x||step)&&(x=val*len/range),isNaN(val))return self;x=Math.max(0,Math.min(x,len)),val=x/len*range,(isSetValue||!vertical)&&(val+=conf.min),vertical&&(isSetValue?x=len-x:val=conf.max-val),val=round(val,precision);var isClick="click"==evt.type;if(fireOnSlide&&void 0!==value&&!isClick&&(evt.type="onSlide",fire.trigger(evt,[val,x]),evt.isDefaultPrevented()))return self;var speed=isClick?conf.speed:0,callback=isClick?function(){evt.type="change",fire.trigger(evt,[val])}:null;return vertical?(handle.animate({top:x},speed,callback),conf.progress&&progress.animate({height:len-x+handle.height()/2},speed)):(handle.animate({left:x},speed,callback),conf.progress&&progress.animate({width:x+handle.width()/2},speed)),value=val,pos=x,input.val(val),self}function init(){vertical=conf.vertical||dim(root,"height")>dim(root,"width"),vertical?(len=dim(root,"height")-dim(handle,"height"),origo=root.offset().top+len):(len=dim(root,"width")-dim(handle,"width"),origo=root.offset().left)}function begin(){init(),self.setValue(void 0!==conf.value?conf.value:conf.min)}var vertical,value,origo,len,pos,self=this,css=conf.css,root=$("<div><div/><a href='#'/></div>").data("rangeinput",self);input.before(root);var handle=root.addClass(css.slider).find("a").addClass(css.handle),progress=root.find("div").addClass(css.progress);$.each("min,max,step,value".split(","),function(i,key){var val=input.attr(key);parseFloat(val)&&(conf[key]=parseFloat(val,10))});var range=conf.max-conf.min,step="any"==conf.step?0:conf.step,precision=conf.precision;if(void 0===precision&&(precision=step.toString().split("."),precision=2===precision.length?precision[1].length:0),"range"==input.attr("type")){var def=input.clone().wrap("<div/>").parent().html(),clone=$(def.replace(/type/i,"type=text data-orig-type"));clone.val(conf.value),input.replaceWith(clone),input=clone}input.addClass(css.input);var fire=$(self).add(input),fireOnSlide=!0;$.extend(self,{getValue:function(){return value},setValue:function(val,e){return init(),slide(e||$.Event("api"),void 0,val,!0)},getConf:function(){return conf},getProgress:function(){return progress},getHandle:function(){return handle},getInput:function(){return input},step:function(am,e){e=e||$.Event();var step="any"==conf.step?1:conf.step;self.setValue(value+step*(am||1),e)},stepUp:function(am){return self.step(am||1)},stepDown:function(am){return self.step(-am||-1)}}),$.each("onSlide,change".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),handle.drag({drag:!1}).on("dragStart",function(){init(),fireOnSlide=hasEvent($(self))||hasEvent(input)}).on("drag",function(e,y,x){return input.is(":disabled")?!1:void slide(e,vertical?y:x)}).on("dragEnd",function(e){e.isDefaultPrevented()||(e.type="change",fire.trigger(e,[value]))}).click(function(e){return e.preventDefault()}),root.click(function(e){if(input.is(":disabled")||e.target==handle[0])return e.preventDefault();init();var fix=vertical?handle.height()/2:handle.width()/2;slide(e,vertical?len-origo-fix+e.pageY:e.pageX-origo-fix)}),conf.keyboard&&input.keydown(function(e){if(!input.attr("readonly")){var key=e.keyCode,up=-1!=$([75,76,38,33,39]).index(key),down=-1!=$([74,72,40,34,37]).index(key);return!up&&!down||e.shiftKey||e.altKey||e.ctrlKey?void 0:(up?self.step(33==key?10:1,e):down&&self.step(34==key?-10:-1,e),e.preventDefault())}}),input.blur(function(e){var val=$(this).val();val!==value&&self.setValue(val,e)}),$.extend(input[0],{stepUp:self.stepUp,stepDown:self.stepDown}),begin(),len||$(window).load(begin)}$.tools=$.tools||{version:"@VERSION"};var tool;tool=$.tools.rangeinput={conf:{min:0,max:100,step:"any",steps:0,value:0,precision:void 0,vertical:0,keyboard:!0,progress:!1,speed:100,css:{input:"range",slider:"slider",progress:"progress",handle:"handle"}}};var doc,draggable;$.fn.drag=function(conf){return document.ondragstart=function(){return!1},conf=$.extend({x:!0,y:!0,drag:!0},conf),doc=doc||$(document).on("mousedown mouseup",function(e){var el=$(e.target);if("mousedown"==e.type&&el.data("drag")){var offset=el.position(),x0=e.pageX-offset.left,y0=e.pageY-offset.top,start=!0;doc.on("mousemove.drag",function(e){var x=e.pageX-x0,y=e.pageY-y0,props={};conf.x&&(props.left=x),conf.y&&(props.top=y),start&&(el.trigger("dragStart"),start=!1),conf.drag&&el.css(props),el.trigger("drag",[y,x]),draggable=el}),e.preventDefault()}else try{draggable&&draggable.trigger("dragEnd")}finally{doc.off("mousemove.drag"),draggable=null}}),this.data("drag",!0)},$.expr[":"].range=function(el){var type=el.getAttribute("type");return type&&"range"==type||!!$(el).filter("input").data("rangeinput")},$.fn.rangeinput=function(conf){if(this.data("rangeinput"))return this;conf=$.extend(!0,{},tool.conf,conf);var els;return this.each(function(){var el=new RangeInput($(this),$.extend(!0,{},conf)),input=el.getInput().data("rangeinput",el);els=els?els.add(input):input}),els?els:this}}(jQuery);
\ No newline at end of file
+var oldFnData=jQuery.fn.data;jQuery.fn.data=function(name){var ret,evt,elem=this[0];return elem&&"events"===name&&1===arguments.length&&(ret=jQuery.data(elem,name),evt=jQuery._data(elem,name)),oldFnData.apply(this,arguments)},function($){function round(value,precision){var n=Math.pow(10,precision);return Math.round(value*n)/n}function dim(el,key){var v=parseInt(el.css(key),10);if(v)return v;var s=el[0].currentStyle;return s&&s.width&&parseInt(s.width,10)}function hasEvent(el){var e=el.data("events");return e&&e.onSlide}function RangeInput(input,conf){function slide(evt,x,val,isSetValue){if(void 0===val?val=x/len*range:isSetValue&&(val-=conf.min),step&&(val=Math.round(val/step)*step),(void 0===x||step)&&(x=val*len/range),isNaN(val))return self;x=Math.max(0,Math.min(x,len)),val=x/len*range,!isSetValue&&vertical||(val+=conf.min),vertical&&(isSetValue?x=len-x:val=conf.max-val),val=round(val,precision);var isClick="click"==evt.type;if(fireOnSlide&&void 0!==value&&!isClick&&(evt.type="onSlide",fire.trigger(evt,[val,x]),evt.isDefaultPrevented()))return self;var speed=isClick?conf.speed:0,callback=isClick?function(){evt.type="change",fire.trigger(evt,[val])}:null;return vertical?(handle.animate({top:x},speed,callback),conf.progress&&progress.animate({height:len-x+handle.height()/2},speed)):(handle.animate({left:x},speed,callback),conf.progress&&progress.animate({width:x+handle.width()/2},speed)),value=val,pos=x,input.val(val),self}function init(){vertical=conf.vertical||dim(root,"height")>dim(root,"width"),vertical?(len=dim(root,"height")-dim(handle,"height"),origo=root.offset().top+len):(len=dim(root,"width")-dim(handle,"width"),origo=root.offset().left)}function begin(){init(),self.setValue(void 0!==conf.value?conf.value:conf.min)}var vertical,value,origo,len,pos,self=this,css=conf.css,root=$("<div><div/><a href='#'/></div>").data("rangeinput",self);input.before(root);var handle=root.addClass(css.slider).find("a").addClass(css.handle),progress=root.find("div").addClass(css.progress);$.each("min,max,step,value".split(","),function(i,key){var val=input.attr(key);parseFloat(val)&&(conf[key]=parseFloat(val,10))});var range=conf.max-conf.min,step="any"==conf.step?0:conf.step,precision=conf.precision;if(void 0===precision&&(precision=step.toString().split("."),precision=2===precision.length?precision[1].length:0),"range"==input.attr("type")){var def=input.clone().wrap("<div/>").parent().html(),clone=$(def.replace(/type/i,"type=text data-orig-type"));clone.val(conf.value),input.replaceWith(clone),input=clone}input.addClass(css.input);var fire=$(self).add(input),fireOnSlide=!0;$.extend(self,{getValue:function(){return value},setValue:function(val,e){return init(),slide(e||$.Event("api"),void 0,val,!0)},getConf:function(){return conf},getProgress:function(){return progress},getHandle:function(){return handle},getInput:function(){return input},step:function(am,e){e=e||$.Event();var step="any"==conf.step?1:conf.step;self.setValue(value+step*(am||1),e)},stepUp:function(am){return self.step(am||1)},stepDown:function(am){return self.step(-am||-1)}}),$.each("onSlide,change".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),handle.drag({drag:!1}).on("dragStart",function(){init(),fireOnSlide=hasEvent($(self))||hasEvent(input)}).on("drag",function(e,y,x){return!input.is(":disabled")&&void slide(e,vertical?y:x)}).on("dragEnd",function(e){e.isDefaultPrevented()||(e.type="change",fire.trigger(e,[value]))}).click(function(e){return e.preventDefault()}),root.click(function(e){if(input.is(":disabled")||e.target==handle[0])return e.preventDefault();init();var fix=vertical?handle.height()/2:handle.width()/2;slide(e,vertical?len-origo-fix+e.pageY:e.pageX-origo-fix)}),conf.keyboard&&input.keydown(function(e){if(!input.attr("readonly")){var key=e.keyCode,up=$([75,76,38,33,39]).index(key)!=-1,down=$([74,72,40,34,37]).index(key)!=-1;return!up&&!down||e.shiftKey||e.altKey||e.ctrlKey?void 0:(up?self.step(33==key?10:1,e):down&&self.step(34==key?-10:-1,e),e.preventDefault())}}),input.blur(function(e){var val=$(this).val();val!==value&&self.setValue(val,e)}),$.extend(input[0],{stepUp:self.stepUp,stepDown:self.stepDown}),begin(),len||$(window).load(begin)}$.tools=$.tools||{version:"@VERSION"};var tool;tool=$.tools.rangeinput={conf:{min:0,max:100,step:"any",steps:0,value:0,precision:void 0,vertical:0,keyboard:!0,progress:!1,speed:100,css:{input:"range",slider:"slider",progress:"progress",handle:"handle"}}};var doc,draggable;$.fn.drag=function(conf){return document.ondragstart=function(){return!1},conf=$.extend({x:!0,y:!0,drag:!0},conf),doc=doc||$(document).on("mousedown mouseup",function(e){var el=$(e.target);if("mousedown"==e.type&&el.data("drag")){var offset=el.position(),x0=e.pageX-offset.left,y0=e.pageY-offset.top,start=!0;doc.on("mousemove.drag",function(e){var x=e.pageX-x0,y=e.pageY-y0,props={};conf.x&&(props.left=x),conf.y&&(props.top=y),start&&(el.trigger("dragStart"),start=!1),conf.drag&&el.css(props),el.trigger("drag",[y,x]),draggable=el}),e.preventDefault()}else try{draggable&&draggable.trigger("dragEnd")}finally{doc.off("mousemove.drag"),draggable=null}}),this.data("drag",!0)},$.expr[":"].range=function(el){var type=el.getAttribute("type");return type&&"range"==type||!!$(el).filter("input").data("rangeinput")},$.fn.rangeinput=function(conf){if(this.data("rangeinput"))return this;conf=$.extend(!0,{},tool.conf,conf);var els;return this.each(function(){var el=new RangeInput($(this),$.extend(!0,{},conf)),input=el.getInput().data("rangeinput",el);els=els?els.add(input):input}),els?els:this}}(jQuery);
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.tooltip.min.js b/plone/app/jquerytools/browser/jquery.tools.tooltip.min.js
index e933be2..88eb5b1 100644
--- a/plone/app/jquerytools/browser/jquery.tools.tooltip.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.tooltip.min.js
@@ -1 +1 @@
-!function($){function getPosition(trigger,tip,conf){var top=conf.relative?trigger.position().top:trigger.offset().top,left=conf.relative?trigger.position().left:trigger.offset().left,pos=conf.position[0];top-=tip.outerHeight()-conf.offset[0],left+=trigger.outerWidth()+conf.offset[1],/iPad/i.test(navigator.userAgent)&&(top-=$(window).scrollTop());var height=tip.outerHeight()+trigger.outerHeight();"center"==pos&&(top+=height/2),"bottom"==pos&&(top+=height),pos=conf.position[1];var width=tip.outerWidth()+trigger.outerWidth();return"center"==pos&&(left-=width/2),"left"==pos&&(left-=width),{top:top,left:left}}function Tooltip(trigger,conf){var tip,shown,self=this,fire=trigger.add(self),timer=0,pretimer=0,title=trigger.attr("title"),tipAttr=trigger.attr("data-tooltip"),effect=effects[conf.effect],isInput=trigger.is(":input"),isWidget=isInput&&trigger.is(":checkbox, :radio, select, :button, :submit"),type=trigger.attr("type"),evt=conf.events[type]||conf.events[isInput?isWidget?"widget":"input":"def"];if(!effect)throw'Nonexistent effect "'+conf.effect+'"';if(evt=evt.split(/,\s*/),2!=evt.length)throw"Tooltip: bad events configuration for "+type;trigger.on(evt[0],function(e){clearTimeout(timer),conf.predelay?pretimer=setTimeout(function(){self.show(e)},conf.predelay):self.show(e)}).on(evt[1],function(e){clearTimeout(pretimer),conf.delay?timer=setTimeout(function(){self.hide(e)},conf.delay):self.hide(e)}),title&&conf.cancelDefault&&(trigger.removeAttr("title"),trigger.data("title",title)),$.extend(self,{show:function(e){if(!tip&&(tipAttr?tip=$(tipAttr):conf.tip?tip=$(conf.tip).eq(0):title?tip=$(conf.layout).addClass(conf.tipClass).appendTo(document.body).hide().append(title):(tip=trigger.find("."+conf.tipClass),tip.length||(tip=trigger.next()),tip.length||(tip=trigger.parent().next())),!tip.length))throw"Cannot find tooltip for "+trigger;if(self.isShown())return self;tip.stop(!0,!0);var pos=getPosition(trigger,tip,conf);if(conf.tip&&tip.html(trigger.data("title")),e=$.Event(),e.type="onBeforeShow",fire.trigger(e,[pos]),e.isDefaultPrevented())return self;pos=getPosition(trigger,tip,conf),tip.css({position:"absolute",top:pos.top,left:pos.left}),shown=!0,effect[0].call(self,function(){e.type="onShow",shown="full",fire.trigger(e)});var event=conf.events.tooltip.split(/,\s*/);return tip.data("__set")||(tip.off(event[0]).on(event[0],function(){clearTimeout(timer),clearTimeout(pretimer)}),event[1]&&!trigger.is("input:not(:checkbox, :radio), textarea")&&tip.off(event[1]).on(event[1],function(e){e.relatedTarget!=trigger[0]&&trigger.trigger(evt[1].split(" ")[0])}),conf.tip||tip.data("__set",!0)),self},hide:function(e){return tip&&self.isShown()?(e=$.Event(),e.type="onBeforeHide",fire.trigger(e),e.isDefaultPrevented()?void 0:(shown=!1,effects[conf.effect][1].call(self,function(){e.type="onHide",fire.trigger(e)}),self)):self},isShown:function(fully){return fully?"full"==shown:shown},getConf:function(){return conf},getTip:function(){return tip},getTrigger:function(){return trigger}}),$.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}})}$.tools=$.tools||{version:"@VERSION"},$.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(name,loadFn,hideFn){effects[name]=[loadFn,hideFn]}};var effects={toggle:[function(done){var conf=this.getConf(),tip=this.getTip(),o=conf.opacity;1>o&&tip.css({opacity:o}),tip.show(),done.call()},function(done){this.getTip().hide(),done.call()}],fade:[function(done){var conf=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||conf.fadeIE?this.getTip().fadeTo(conf.fadeInSpeed,conf.opacity,done):(this.getTip().show(),done())},function(done){var conf=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||conf.fadeIE?this.getTip().fadeOut(conf.fadeOutSpeed,done):(this.getTip().hide(),done())}]};$.fn.tooltip=function(conf){var api=this.data("tooltip");return api?api:(conf=$.extend(!0,{},$.tools.tooltip.conf,conf),"string"==typeof conf.position&&(conf.position=conf.position.split(/,?\s/)),this.each(function(){api=new Tooltip($(this),conf),$(this).data("tooltip",api)}),conf.api?api:this)}}(jQuery);
\ No newline at end of file
+!function($){function getPosition(trigger,tip,conf){var top=conf.relative?trigger.position().top:trigger.offset().top,left=conf.relative?trigger.position().left:trigger.offset().left,pos=conf.position[0];top-=tip.outerHeight()-conf.offset[0],left+=trigger.outerWidth()+conf.offset[1],/iPad/i.test(navigator.userAgent)&&(top-=$(window).scrollTop());var height=tip.outerHeight()+trigger.outerHeight();"center"==pos&&(top+=height/2),"bottom"==pos&&(top+=height),pos=conf.position[1];var width=tip.outerWidth()+trigger.outerWidth();return"center"==pos&&(left-=width/2),"left"==pos&&(left-=width),{top:top,left:left}}function Tooltip(trigger,conf){var tip,shown,self=this,fire=trigger.add(self),timer=0,pretimer=0,title=trigger.attr("title"),tipAttr=trigger.attr("data-tooltip"),effect=effects[conf.effect],isInput=trigger.is(":input"),isWidget=isInput&&trigger.is(":checkbox, :radio, select, :button, :submit"),type=trigger.attr("type"),evt=conf.events[type]||conf.events[isInput?isWidget?"widget":"input":"def"];if(!effect)throw'Nonexistent effect "'+conf.effect+'"';if(evt=evt.split(/,\s*/),2!=evt.length)throw"Tooltip: bad events configuration for "+type;trigger.on(evt[0],function(e){clearTimeout(timer),conf.predelay?pretimer=setTimeout(function(){self.show(e)},conf.predelay):self.show(e)}).on(evt[1],function(e){clearTimeout(pretimer),conf.delay?timer=setTimeout(function(){self.hide(e)},conf.delay):self.hide(e)}),title&&conf.cancelDefault&&(trigger.removeAttr("title"),trigger.data("title",title)),$.extend(self,{show:function(e){if(!tip&&(tipAttr?tip=$(tipAttr):conf.tip?tip=$(conf.tip).eq(0):title?tip=$(conf.layout).addClass(conf.tipClass).appendTo(document.body).hide().append(title):(tip=trigger.find("."+conf.tipClass),tip.length||(tip=trigger.next()),tip.length||(tip=trigger.parent().next())),!tip.length))throw"Cannot find tooltip for "+trigger;if(self.isShown())return self;tip.stop(!0,!0);var pos=getPosition(trigger,tip,conf);if(conf.tip&&tip.html(trigger.data("title")),e=$.Event(),e.type="onBeforeShow",fire.trigger(e,[pos]),e.isDefaultPrevented())return self;pos=getPosition(trigger,tip,conf),tip.css({position:"absolute",top:pos.top,left:pos.left}),shown=!0,effect[0].call(self,function(){e.type="onShow",shown="full",fire.trigger(e)});var event=conf.events.tooltip.split(/,\s*/);return tip.data("__set")||(tip.off(event[0]).on(event[0],function(){clearTimeout(timer),clearTimeout(pretimer)}),event[1]&&!trigger.is("input:not(:checkbox, :radio), textarea")&&tip.off(event[1]).on(event[1],function(e){e.relatedTarget!=trigger[0]&&trigger.trigger(evt[1].split(" ")[0])}),conf.tip||tip.data("__set",!0)),self},hide:function(e){return tip&&self.isShown()?(e=$.Event(),e.type="onBeforeHide",fire.trigger(e),e.isDefaultPrevented()?void 0:(shown=!1,effects[conf.effect][1].call(self,function(){e.type="onHide",fire.trigger(e)}),self)):self},isShown:function(fully){return fully?"full"==shown:shown},getConf:function(){return conf},getTip:function(){return tip},getTrigger:function(){return trigger}}),$.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}})}$.tools=$.tools||{version:"@VERSION"},$.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(name,loadFn,hideFn){effects[name]=[loadFn,hideFn]}};var effects={toggle:[function(done){var conf=this.getConf(),tip=this.getTip(),o=conf.opacity;o<1&&tip.css({opacity:o}),tip.show(),done.call()},function(done){this.getTip().hide(),done.call()}],fade:[function(done){var conf=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||conf.fadeIE?this.getTip().fadeTo(conf.fadeInSpeed,conf.opacity,done):(this.getTip().show(),done())},function(done){var conf=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||conf.fadeIE?this.getTip().fadeOut(conf.fadeOutSpeed,done):(this.getTip().hide(),done())}]};$.fn.tooltip=function(conf){var api=this.data("tooltip");return api?api:(conf=$.extend(!0,{},$.tools.tooltip.conf,conf),"string"==typeof conf.position&&(conf.position=conf.position.split(/,?\s/)),this.each(function(){api=new Tooltip($(this),conf),$(this).data("tooltip",api)}),conf.api?api:this)}}(jQuery);
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.tooltip.plugins.min.js b/plone/app/jquerytools/browser/jquery.tools.tooltip.plugins.min.js
index 607c200..d6c82aa 100644
--- a/plone/app/jquerytools/browser/jquery.tools.tooltip.plugins.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.tooltip.plugins.min.js
@@ -1 +1 @@
-!function($){function getCropping(el){var w=$(window),right=w.width()+w.scrollLeft(),bottom=w.height()+w.scrollTop();return[el.offset().top<=w.scrollTop(),right<=el.offset().left+el.width(),bottom<=el.offset().top+el.height(),w.scrollLeft()>=el.offset().left]}function isVisible(crop){for(var i=crop.length;i--;)if(crop[i])return!1;return!0}var t=$.tools.tooltip;t.dynamic={conf:{classNames:"top right bottom left"}},$.fn.dynamic=function(conf){"number"==typeof conf&&(conf={speed:conf}),conf=$.extend({},t.dynamic.conf,conf);var orig,ret,confOrigin=$.extend(!0,{},conf),cls=conf.classNames.split(/\s/);return this.each(function(){var api=$(this).tooltip().onBeforeShow(function(e,pos){var tip=this.getTip(),tipConf=this.getConf();orig||(orig=[tipConf.position[0],tipConf.position[1],tipConf.offset[0],tipConf.offset[1],$.extend({},tipConf)]),$.extend(tipConf,orig[4]),tipConf.position=[orig[0],orig[1]],tipConf.offset=[orig[2],orig[3]],tip.css({visibility:"hidden",position:"absolute",top:pos.top,left:pos.left}).show();var conf=$.extend(!0,{},confOrigin),crop=getCropping(tip);isVisible(crop)||(crop[2]&&($.extend(tipConf,conf.top),tipConf.position[0]="top",tip.addClass(cls[0])),crop[3]&&($.extend(tipConf,conf.right),tipConf.position[1]="right",tip.addClass(cls[1])),crop[0]&&($.extend(tipConf,conf.bottom),tipConf.position[0]="bottom",tip.addClass(cls[2])),crop[1]&&($.extend(tipConf,conf.left),tipConf.position[1]="left",tip.addClass(cls[3])),(crop[0]||crop[2])&&(tipConf.offset[0]*=-1),(crop[1]||crop[3])&&(tipConf.offset[1]*=-1)),tip.css({visibility:"visible"}).hide()});api.onBeforeShow(function(){{var c=this.getConf();this.getTip()}setTimeout(function(){c.position=[orig[0],orig[1]],c.offset=[orig[2],orig[3]]},0)}),api.onHide(function(){var tip=this.getTip();tip.removeClass(conf.classNames)}),ret=api}),conf.api?ret:this}}(jQuery),function($){var t=$.tools.tooltip;$.extend(t.conf,{direction:"up",bounce:!1,slideOffset:10,slideInSpeed:200,slideOutSpeed:200,slideFade:!/msie/.test(navigator.userAgent.toLowerCase())});var dirs={up:["-","top"],down:["+","top"],left:["-","left"],right:["+","left"]};t.addEffect("slide",function(done){var conf=this.getConf(),tip=this.getTip(),params=conf.slideFade?{opacity:conf.opacity}:{},dir=dirs[conf.direction]||dirs.up;params[dir[1]]=dir[0]+"="+conf.slideOffset,conf.slideFade&&tip.css({opacity:0}),tip.show().animate(params,conf.slideInSpeed,done)},function(done){var conf=this.getConf(),offset=conf.slideOffset,params=conf.slideFade?{opacity:0}:{},dir=dirs[conf.direction]||dirs.up,sign=""+dir[0];conf.bounce&&(sign="+"==sign?"-":"+"),params[dir[1]]=sign+"="+offset,this.getTip().animate(params,conf.slideOutSpeed,function(){$(this).hide(),done.call()})})}(jQuery);
\ No newline at end of file
+!function($){function getCropping(el){var w=$(window),right=w.width()+w.scrollLeft(),bottom=w.height()+w.scrollTop();return[el.offset().top<=w.scrollTop(),right<=el.offset().left+el.width(),bottom<=el.offset().top+el.height(),w.scrollLeft()>=el.offset().left]}function isVisible(crop){for(var i=crop.length;i--;)if(crop[i])return!1;return!0}var t=$.tools.tooltip;t.dynamic={conf:{classNames:"top right bottom left"}},$.fn.dynamic=function(conf){"number"==typeof conf&&(conf={speed:conf}),conf=$.extend({},t.dynamic.conf,conf);var orig,ret,confOrigin=$.extend(!0,{},conf),cls=conf.classNames.split(/\s/);return this.each(function(){var api=$(this).tooltip().onBeforeShow(function(e,pos){var tip=this.getTip(),tipConf=this.getConf();orig||(orig=[tipConf.position[0],tipConf.position[1],tipConf.offset[0],tipConf.offset[1],$.extend({},tipConf)]),$.extend(tipConf,orig[4]),tipConf.position=[orig[0],orig[1]],tipConf.offset=[orig[2],orig[3]],tip.css({visibility:"hidden",position:"absolute",top:pos.top,left:pos.left}).show();var conf=$.extend(!0,{},confOrigin),crop=getCropping(tip);isVisible(crop)||(crop[2]&&($.extend(tipConf,conf.top),tipConf.position[0]="top",tip.addClass(cls[0])),crop[3]&&($.extend(tipConf,conf.right),tipConf.position[1]="right",tip.addClass(cls[1])),crop[0]&&($.extend(tipConf,conf.bottom),tipConf.position[0]="bottom",tip.addClass(cls[2])),crop[1]&&($.extend(tipConf,conf.left),tipConf.position[1]="left",tip.addClass(cls[3])),(crop[0]||crop[2])&&(tipConf.offset[0]*=-1),(crop[1]||crop[3])&&(tipConf.offset[1]*=-1)),tip.css({visibility:"visible"}).hide()});api.onBeforeShow(function(){var c=this.getConf();this.getTip();setTimeout(function(){c.position=[orig[0],orig[1]],c.offset=[orig[2],orig[3]]},0)}),api.onHide(function(){var tip=this.getTip();tip.removeClass(conf.classNames)}),ret=api}),conf.api?ret:this}}(jQuery),function($){var t=$.tools.tooltip;$.extend(t.conf,{direction:"up",bounce:!1,slideOffset:10,slideInSpeed:200,slideOutSpeed:200,slideFade:!/msie/.test(navigator.userAgent.toLowerCase())});var dirs={up:["-","top"],down:["+","top"],left:["-","left"],right:["+","left"]};t.addEffect("slide",function(done){var conf=this.getConf(),tip=this.getTip(),params=conf.slideFade?{opacity:conf.opacity}:{},dir=dirs[conf.direction]||dirs.up;params[dir[1]]=dir[0]+"="+conf.slideOffset,conf.slideFade&&tip.css({opacity:0}),tip.show().animate(params,conf.slideInSpeed,done)},function(done){var conf=this.getConf(),offset=conf.slideOffset,params=conf.slideFade?{opacity:0}:{},dir=dirs[conf.direction]||dirs.up,sign=""+dir[0];conf.bounce&&(sign="+"==sign?"-":"+"),params[dir[1]]=sign+"="+offset,this.getTip().animate(params,conf.slideOutSpeed,function(){$(this).hide(),done.call()})})}(jQuery);
\ No newline at end of file
diff --git a/plone/app/jquerytools/browser/jquery.tools.validator.min.js b/plone/app/jquerytools/browser/jquery.tools.validator.min.js
index 7c6953a..47fa188 100644
--- a/plone/app/jquerytools/browser/jquery.tools.validator.min.js
+++ b/plone/app/jquerytools/browser/jquery.tools.validator.min.js
@@ -1 +1 @@
-!function($){function getPosition(trigger,el,conf){el=$(el).first()||el;var top=trigger.offset().top,left=trigger.offset().left,pos=conf.position.split(/,?\s+/),y=pos[0],x=pos[1];top-=el.outerHeight()-conf.offset[0],left+=trigger.outerWidth()+conf.offset[1],/iPad/i.test(navigator.userAgent)&&(top-=$(window).scrollTop());var height=el.outerHeight()+trigger.outerHeight();"center"==y&&(top+=height/2),"bottom"==y&&(top+=height);var width=trigger.outerWidth();return"center"==x&&(left-=(width+el.outerWidth())/2),"left"==x&&(left-=width),{top:top,left:left}}function isType(type){function fn(){return this.getAttribute("type")==type}return fn.key='[type="'+type+'"]',fn}function Validator(inputs,form,conf){function pushMessage(to,matcher,returnValue){if(conf.grouped||!to.length){var msg;if(returnValue===!1||$.isArray(returnValue)){msg=v.messages[matcher.key||matcher]||v.messages["*"],msg=msg[conf.lang]||v.messages["*"].en;var matches=msg.match(/\$\d/g);matches&&$.isArray(returnValue)&&$.each(matches,function(i){msg=msg.replace(this,returnValue[i])})}else msg=returnValue[conf.lang]||returnValue;to.push(msg)}}var self=this,fire=form.add(self);inputs=inputs.not(":button, :image, :reset, :submit"),form.attr("novalidate","novalidate"),$.extend(self,{getConf:function(){return conf},getForm:function(){return form},getInputs:function(){return inputs},reflow:function(){return inputs.each(function(){var input=$(this),msg=input.data("msg.el");if(msg){var pos=getPosition(input,msg,conf);msg.css({top:pos.top,left:pos.left})}}),self},invalidate:function(errs,e){if(!e){var errors=[];$.each(errs,function(key,val){var input=inputs.filter("[name='"+key+"']");input.length&&(input.trigger("OI",[val]),errors.push({input:input,messages:[val]}))}),errs=errors,e=$.Event()}return e.type="onFail",fire.trigger(e,[errs]),e.isDefaultPrevented()||effects[conf.effect][0].call(self,errs,e),self},reset:function(els){return els=els||inputs,els.removeClass(conf.errorClass).each(function(){var msg=$(this).data("msg.el");msg&&(msg.remove(),$(this).data("msg.el",null))}).off(conf.errorInputEvent+".v"||""),self},destroy:function(){return form.off(conf.formEvent+".V reset.V"),inputs.off(conf.inputEvent+".V change.V"),self.reset()},checkValidity:function(els,e){els=els||inputs,els=els.not(":disabled");var names={};if(els=els.filter(function(){var name=$(this).attr("name");return names[name]?void 0:(names[name]=!0,$(this))}),!els.length)return!0;if(e=e||$.Event(),e.type="onBeforeValidate",fire.trigger(e,[els]),e.isDefaultPrevented())return e.result;var errs=[];els.each(function(){var msgs=[],el=$(this).data("messages",msgs),event=dateInput&&el.is(":date")?"onHide.v":conf.errorInputEvent+".v";return el.off(event),$.each(fns,function(){var fn=this,match=fn[0];if(el.filter(match).length){var returnValue=fn[1].call(self,el,el.val());if(returnValue!==!0){if(e.type="onBeforeFail",fire.trigger(e,[el,match]),e.isDefaultPrevented())return!1;var msg=el.attr(conf.messageAttr);if(msg)return msgs=[msg],!1;pushMessage(msgs,match,returnValue)}}}),msgs.length&&(errs.push({input:el,messages:msgs}),el.trigger("OI",[msgs]),conf.errorInputEvent&&el.on(event,function(e){self.checkValidity(el,e)})),conf.singleError&&errs.length?!1:void 0});var eff=effects[conf.effect];if(!eff)throw'Validator: cannot find effect "'+conf.effect+'"';return errs.length?(self.invalidate(errs,e),!1):(eff[1].call(self,els,e),e.type="onSuccess",fire.trigger(e,[els]),els.off(conf.errorInputEvent+".v"),!0)}}),$.each("onBeforeValidate,onBeforeFail,onFail,onSuccess".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.formEvent&&form.on(conf.formEvent+".V",function(e){return self.checkValidity(null,e)?(e.target=form,void(e.type=conf.formEvent)):e.preventDefault()}),form.on("reset.V",function(){self.reset()}),inputs[0]&&inputs[0].validity&&inputs.each(function(){this.oninvalid=function(){return!1}}),form[0]&&(form[0].checkValidity=self.checkValidity),conf.inputEvent&&inputs.on(conf.inputEvent+".V",function(e){self.checkValidity($(this),e)}),inputs.filter(":checkbox, select").filter("[required]").on("change.V",function(e){var el=$(this);(this.checked||el.is("select")&&$(this).val())&&effects[conf.effect][1].call(self,el,e)}),inputs.filter(":radio[required]").on("change.V",function(e){var els=$("[name='"+$(e.srcElement).attr("name")+"']");null!=els&&0!=els.length&&self.checkValidity(els,e)}),$(window).resize(function(){self.reflow()})}$.tools=$.tools||{version:"@VERSION"};var v,typeRe=/\[type=([a-z]+)\]/,numRe=/^-?[0-9]*(\.[0-9]+)?$/,dateInput=$.tools.dateinput,emailRe=/^([a-z0-9_\.\-\+]+)@([\da-z\.\-]+)\.([a-z\.]{2,6})$/i,urlRe=/^(https?:\/\/)?[\da-z\.\-]+\.[a-z\.]{2,6}[#&+_\?\/\w \.\-=]*$/i;v=$.tools.validator={conf:{grouped:!1,effect:"default",errorClass:"invalid",inputEvent:null,errorInputEvent:"keyup",formEvent:"submit",lang:"en",message:"<div/>",messageAttr:"data-message",messageClass:"error",offset:[0,0],position:"center right",singleError:!1,speed:"normal"},messages:{"*":{en:"Please correct this value"}},localize:function(lang,messages){$.each(messages,function(key,msg){v.messages[key]=v.messages[key]||{},v.messages[key][lang]=msg})},localizeFn:function(key,messages){v.messages[key]=v.messages[key]||{},$.extend(v.messages[key],messages)},fn:function(matcher,msg,fn){$.isFunction(msg)?fn=msg:("string"==typeof msg&&(msg={en:msg}),this.messages[matcher.key||matcher]=msg);var test=typeRe.exec(matcher);test&&(matcher=isType(test[1])),fns.push([matcher,fn])},addEffect:function(name,showFn,closeFn){effects[name]=[showFn,closeFn]}};var fns=[],effects={"default":[function(errs){var conf=this.getConf();$.each(errs,function(i,err){var input=err.input;input.addClass(conf.errorClass);var msg=input.data("msg.el");msg||(msg=$(conf.message).addClass(conf.messageClass).appendTo(document.body),input.data("msg.el",msg)),msg.css({visibility:"hidden"}).find("p").remove(),$.each(err.messages,function(i,m){$("<p/>").html(m).appendTo(msg)}),msg.outerWidth()==msg.parent().width()&&msg.add(msg.find("p")).css({display:"inline"});var pos=getPosition(input,msg,conf);msg.css({visibility:"visible",position:"absolute",top:pos.top,left:pos.left}).fadeIn(conf.speed)})},function(inputs){var conf=this.getConf();inputs.removeClass(conf.errorClass).each(function(){var msg=$(this).data("msg.el");msg&&msg.css({visibility:"hidden"})})}]};$.each("email,url,number".split(","),function(i,key){$.expr[":"][key]=function(el){return el.getAttribute("type")===key}}),$.fn.oninvalid=function(fn){return this[fn?"on":"trigger"]("OI",fn)},v.fn(":email","Please enter a valid email address",function(el,v){return!v||emailRe.test(v)}),v.fn(":url","Please enter a valid URL",function(el,v){return!v||urlRe.test(v)}),v.fn(":number","Please enter a numeric value.",function(el,v){return numRe.test(v)}),v.fn("[max]","Please enter a value no larger than $1",function(el,v){if(""===v||dateInput&&el.is(":date"))return!0;var max=el.attr("max");return parseFloat(v)<=parseFloat(max)?!0:[max]}),v.fn("[min]","Please enter a value of at least $1",function(el,v){if(""===v||dateInput&&el.is(":date"))return!0;var min=el.attr("min");return parseFloat(v)>=parseFloat(min)?!0:[min]}),v.fn("[required]","Please complete this mandatory field.",function(el,v){return el.is(":checkbox")?el.is(":checked"):!!v}),v.fn("[pattern]",function(el,v){return""===v||new RegExp("^"+el.attr("pattern")+"$").test(v)}),v.fn(":radio[required]","Please select an option.",function(el){{var checked=!1;$("[name='"+el.attr("name")+"']").each(function(i,el){($(el).is(":checked")||checked)&&(checked=!0)})}return checked?!0:!1}),$.fn.validator=function(conf){var instance=this.data("validator");return instance&&(instance.destroy(),this.removeData("validator")),conf=$.extend(!0,{},v.conf,conf),this.is("form")?this.each(function(){var form=$(this);instance=new Validator(form.find(":input"),form,conf),form.data("validator",instance)}):(instance=new Validator(this,this.eq(0).closest("form"),conf),this.data("validator",instance))}}(jQuery);
\ No newline at end of file
+!function($){function getPosition(trigger,el,conf){el=$(el).first()||el;var top=trigger.offset().top,left=trigger.offset().left,pos=conf.position.split(/,?\s+/),y=pos[0],x=pos[1];top-=el.outerHeight()-conf.offset[0],left+=trigger.outerWidth()+conf.offset[1],/iPad/i.test(navigator.userAgent)&&(top-=$(window).scrollTop());var height=el.outerHeight()+trigger.outerHeight();"center"==y&&(top+=height/2),"bottom"==y&&(top+=height);var width=trigger.outerWidth();return"center"==x&&(left-=(width+el.outerWidth())/2),"left"==x&&(left-=width),{top:top,left:left}}function isType(type){function fn(){return this.getAttribute("type")==type}return fn.key='[type="'+type+'"]',fn}function Validator(inputs,form,conf){function pushMessage(to,matcher,returnValue){if(conf.grouped||!to.length){var msg;if(returnValue===!1||$.isArray(returnValue)){msg=v.messages[matcher.key||matcher]||v.messages["*"],msg=msg[conf.lang]||v.messages["*"].en;var matches=msg.match(/\$\d/g);matches&&$.isArray(returnValue)&&$.each(matches,function(i){msg=msg.replace(this,returnValue[i])})}else msg=returnValue[conf.lang]||returnValue;to.push(msg)}}var self=this,fire=form.add(self);inputs=inputs.not(":button, :image, :reset, :submit"),form.attr("novalidate","novalidate"),$.extend(self,{getConf:function(){return conf},getForm:function(){return form},getInputs:function(){return inputs},reflow:function(){return inputs.each(function(){var input=$(this),msg=input.data("msg.el");if(msg){var pos=getPosition(input,msg,conf);msg.css({top:pos.top,left:pos.left})}}),self},invalidate:function(errs,e){if(!e){var errors=[];$.each(errs,function(key,val){var input=inputs.filter("[name='"+key+"']");input.length&&(input.trigger("OI",[val]),errors.push({input:input,messages:[val]}))}),errs=errors,e=$.Event()}return e.type="onFail",fire.trigger(e,[errs]),e.isDefaultPrevented()||effects[conf.effect][0].call(self,errs,e),self},reset:function(els){return els=els||inputs,els.removeClass(conf.errorClass).each(function(){var msg=$(this).data("msg.el");msg&&(msg.remove(),$(this).data("msg.el",null))}).off(conf.errorInputEvent+".v"||""),self},destroy:function(){return form.off(conf.formEvent+".V reset.V"),inputs.off(conf.inputEvent+".V change.V"),self.reset()},checkValidity:function(els,e){els=els||inputs,els=els.not(":disabled");var names={};if(els=els.filter(function(){var name=$(this).attr("name");if(!names[name])return names[name]=!0,$(this)}),!els.length)return!0;if(e=e||$.Event(),e.type="onBeforeValidate",fire.trigger(e,[els]),e.isDefaultPrevented())return e.result;var errs=[];els.each(function(){var msgs=[],el=$(this).data("messages",msgs),event=dateInput&&el.is(":date")?"onHide.v":conf.errorInputEvent+".v";if(el.off(event),$.each(fns,function(){var fn=this,match=fn[0];if(el.filter(match).length){var returnValue=fn[1].call(self,el,el.val());if(returnValue!==!0){if(e.type="onBeforeFail",fire.trigger(e,[el,match]),e.isDefaultPrevented())return!1;var msg=el.attr(conf.messageAttr);if(msg)return msgs=[msg],!1;pushMessage(msgs,match,returnValue)}}}),msgs.length&&(errs.push({input:el,messages:msgs}),el.trigger("OI",[msgs]),conf.errorInputEvent&&el.on(event,function(e){self.checkValidity(el,e)})),conf.singleError&&errs.length)return!1});var eff=effects[conf.effect];if(!eff)throw'Validator: cannot find effect "'+conf.effect+'"';return errs.length?(self.invalidate(errs,e),!1):(eff[1].call(self,els,e),e.type="onSuccess",fire.trigger(e,[els]),els.off(conf.errorInputEvent+".v"),!0)}}),$.each("onBeforeValidate,onBeforeFail,onFail,onSuccess".split(","),function(i,name){$.isFunction(conf[name])&&$(self).on(name,conf[name]),self[name]=function(fn){return fn&&$(self).on(name,fn),self}}),conf.formEvent&&form.on(conf.formEvent+".V",function(e){return self.checkValidity(null,e)?(e.target=form,void(e.type=conf.formEvent)):e.preventDefault()}),form.on("reset.V",function(){self.reset()}),inputs[0]&&inputs[0].validity&&inputs.each(function(){this.oninvalid=function(){return!1}}),form[0]&&(form[0].checkValidity=self.checkValidity),conf.inputEvent&&inputs.on(conf.inputEvent+".V",function(e){self.checkValidity($(this),e)}),inputs.filter(":checkbox, select").filter("[required]").on("change.V",function(e){var el=$(this);(this.checked||el.is("select")&&$(this).val())&&effects[conf.effect][1].call(self,el,e)}),inputs.filter(":radio[required]").on("change.V",function(e){var els=$("[name='"+$(e.srcElement).attr("name")+"']");null!=els&&0!=els.length&&self.checkValidity(els,e)}),$(window).resize(function(){self.reflow()})}$.tools=$.tools||{version:"@VERSION"};var v,typeRe=/\[type=([a-z]+)\]/,numRe=/^-?[0-9]*(\.[0-9]+)?$/,dateInput=$.tools.dateinput,emailRe=/^([a-z0-9_\.\-\+]+)@([\da-z\.\-]+)\.([a-z\.]{2,6})$/i,urlRe=/^(https?:\/\/)?[\da-z\.\-]+\.[a-z\.]{2,6}[#&+_\?\/\w \.\-=]*$/i;v=$.tools.validator={conf:{grouped:!1,effect:"default",errorClass:"invalid",inputEvent:null,errorInputEvent:"keyup",formEvent:"submit",lang:"en",message:"<div/>",messageAttr:"data-message",messageClass:"error",offset:[0,0],position:"center right",singleError:!1,speed:"normal"},messages:{"*":{en:"Please correct this value"}},localize:function(lang,messages){$.each(messages,function(key,msg){v.messages[key]=v.messages[key]||{},v.messages[key][lang]=msg})},localizeFn:function(key,messages){v.messages[key]=v.messages[key]||{},$.extend(v.messages[key],messages)},fn:function(matcher,msg,fn){$.isFunction(msg)?fn=msg:("string"==typeof msg&&(msg={en:msg}),this.messages[matcher.key||matcher]=msg);var test=typeRe.exec(matcher);test&&(matcher=isType(test[1])),fns.push([matcher,fn])},addEffect:function(name,showFn,closeFn){effects[name]=[showFn,closeFn]}};var fns=[],effects={default:[function(errs){var conf=this.getConf();$.each(errs,function(i,err){var input=err.input;input.addClass(conf.errorClass);var msg=input.data("msg.el");msg||(msg=$(conf.message).addClass(conf.messageClass).appendTo(document.body),input.data("msg.el",msg)),msg.css({visibility:"hidden"}).find("p").remove(),$.each(err.messages,function(i,m){$("<p/>").html(m).appendTo(msg)}),msg.outerWidth()==msg.parent().width()&&msg.add(msg.find("p")).css({display:"inline"});var pos=getPosition(input,msg,conf);msg.css({visibility:"visible",position:"absolute",top:pos.top,left:pos.left}).fadeIn(conf.speed)})},function(inputs){var conf=this.getConf();inputs.removeClass(conf.errorClass).each(function(){var msg=$(this).data("msg.el");msg&&msg.css({visibility:"hidden"})})}]};$.each("email,url,number".split(","),function(i,key){$.expr[":"][key]=function(el){return el.getAttribute("type")===key}}),$.fn.oninvalid=function(fn){return this[fn?"on":"trigger"]("OI",fn)},v.fn(":email","Please enter a valid email address",function(el,v){return!v||emailRe.test(v)}),v.fn(":url","Please enter a valid URL",function(el,v){return!v||urlRe.test(v)}),v.fn(":number","Please enter a numeric value.",function(el,v){return numRe.test(v)}),v.fn("[max]","Please enter a value no larger than $1",function(el,v){if(""===v||dateInput&&el.is(":date"))return!0;var max=el.attr("max");return parseFloat(v)<=parseFloat(max)||[max]}),v.fn("[min]","Please enter a value of at least $1",function(el,v){if(""===v||dateInput&&el.is(":date"))return!0;var min=el.attr("min");return parseFloat(v)>=parseFloat(min)||[min]}),v.fn("[required]","Please complete this mandatory field.",function(el,v){return el.is(":checkbox")?el.is(":checked"):!!v}),v.fn("[pattern]",function(el,v){return""===v||new RegExp("^"+el.attr("pattern")+"$").test(v)}),v.fn(":radio[required]","Please select an option.",function(el){var checked=!1;$("[name='"+el.attr("name")+"']").each(function(i,el){($(el).is(":checked")||checked)&&(checked=!0)});return!!checked}),$.fn.validator=function(conf){var instance=this.data("validator");return instance&&(instance.destroy(),this.removeData("validator")),conf=$.extend(!0,{},v.conf,conf),this.is("form")?this.each(function(){var form=$(this);instance=new Validator(form.find(":input"),form,conf),form.data("validator",instance)}):(instance=new Validator(this,this.eq(0).closest("form"),conf),this.data("validator",instance))}}(jQuery);
\ No newline at end of file


