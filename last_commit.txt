Repository: Products.CMFPlone


Branch: refs/heads/5.0.x
Date: 2017-02-01T09:41:23+01:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/3137c9889f32b40c035bdd057b45c3bc5443d23d

fix wrong portal_url in TinyMCE in multilingual sites. Refs #1513

Files changed:
M Products/CMFPlone/patterns/__init__.py

diff --git a/Products/CMFPlone/patterns/__init__.py b/Products/CMFPlone/patterns/__init__.py
index 4a5cbc8..cb872eb 100644
--- a/Products/CMFPlone/patterns/__init__.py
+++ b/Products/CMFPlone/patterns/__init__.py
@@ -26,7 +26,7 @@ def __init__(self, context, request):
         registry = getUtility(IRegistry)
         self.settings = registry.forInterface(
             ITinyMCESchema, prefix="plone", check=False)
-        self.portal_url = get_portal_url(self.portal)
+        self.portal_url = get_portal_url(self.context)
 
     def get_theme(self):
         return theming_policy().get_theme()


Repository: Products.CMFPlone


Branch: refs/heads/5.0.x
Date: 2017-02-01T09:47:35+01:00
Author: Mikel Larreategi (erral) <mlarreategi@codesyntax.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/522b5d4a0126a4e51afc7e18eb597a49057416bd

add changelog entry

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 235575c..a44d327 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -30,6 +30,8 @@ New features:
 
 Bug fixes:
 
+- Fix wrong TinyMCE configuration for multilingual sites [erral]
+
 - Added security checks for ``str.format``.  Part of PloneHotfix20170117.  [maurits]
 
 - Load some patches earlier, instead of in our initialize method.  [maurits]


Repository: Products.CMFPlone


Branch: refs/heads/5.0.x
Date: 2017-02-03T11:19:23+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/a9e7617eba66f78696165d785ec2a16ba2dc06f8

Merge pull request #1919 from erral/issue1513-plone-5.0.x

fix wrong portal_url in TinyMCE in multilingual sites. Refs #1513

Files changed:
M CHANGES.rst
M Products/CMFPlone/patterns/__init__.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 235575c..a44d327 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -30,6 +30,8 @@ New features:
 
 Bug fixes:
 
+- Fix wrong TinyMCE configuration for multilingual sites [erral]
+
 - Added security checks for ``str.format``.  Part of PloneHotfix20170117.  [maurits]
 
 - Load some patches earlier, instead of in our initialize method.  [maurits]
diff --git a/Products/CMFPlone/patterns/__init__.py b/Products/CMFPlone/patterns/__init__.py
index 4a5cbc8..cb872eb 100644
--- a/Products/CMFPlone/patterns/__init__.py
+++ b/Products/CMFPlone/patterns/__init__.py
@@ -26,7 +26,7 @@ def __init__(self, context, request):
         registry = getUtility(IRegistry)
         self.settings = registry.forInterface(
             ITinyMCESchema, prefix="plone", check=False)
-        self.portal_url = get_portal_url(self.portal)
+        self.portal_url = get_portal_url(self.context)
 
     def get_theme(self):
         return theming_policy().get_theme()


