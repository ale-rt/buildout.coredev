Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2017-12-14T10:21:45+01:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.contenttypes/commit/20918209d5847dc7e51d2676d079ec365b24817d

Rename post_handlers to prevent them to be run as old importSteps. Fixes https://github.com/plone/Products.CMFPlone/issues/2238

Files changed:
M CHANGES.rst
M plone/app/contenttypes/profiles.zcml
M plone/app/contenttypes/setuphandlers.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 00693854..e17c50f7 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Rename post_handlers. Fixes https://github.com/plone/Products.CMFPlone/issues/2238
+  [pbauer]
 
 
 1.4.6 (2017-11-26)
diff --git a/plone/app/contenttypes/profiles.zcml b/plone/app/contenttypes/profiles.zcml
index e1b837a8..f3aba88d 100644
--- a/plone/app/contenttypes/profiles.zcml
+++ b/plone/app/contenttypes/profiles.zcml
@@ -9,7 +9,7 @@
     directory="profiles/content"
     description="Plone default content-types (plone.app.contenttypes)"
     provides="Products.GenericSetup.interfaces.EXTENSION"
-    post_handler=".setuphandlers.step_import_content"
+    post_handler=".setuphandlers.import_content"
     />
 
   <!-- All types, no sample content. -->
@@ -19,7 +19,7 @@
     directory="profiles/default"
     description="Plone default content-types (plone.app.contenttypes)"
     provides="Products.GenericSetup.interfaces.EXTENSION"
-    post_handler=".setuphandlers.step_setup_various"
+    post_handler=".setuphandlers.setup_various"
     />
 
   <!-- Uninstall -->
diff --git a/plone/app/contenttypes/setuphandlers.py b/plone/app/contenttypes/setuphandlers.py
index deb9320f..15a80fb8 100644
--- a/plone/app/contenttypes/setuphandlers.py
+++ b/plone/app/contenttypes/setuphandlers.py
@@ -324,7 +324,7 @@ def configure_members_folder(portal, target_language):
             assignable.setBlacklistStatus('content_type', True)
 
 
-def step_import_content(context):
+def import_content(context):
     """Create default content."""
     portal = getSite()
     target_language, is_combined_language, locale = _get_locales_info(portal)
@@ -334,7 +334,7 @@ def step_import_content(context):
     configure_members_folder(portal, target_language)
 
 
-def step_setup_various(context):
+def setup_various(context):
     portal = getSite()
     target_language, is_combined_language, locale = _get_locales_info(portal)
     _setup_calendar(portal, locale)


Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2017-12-14T22:06:09+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.contenttypes/commit/71ad5d8863c856cbb8b6fa0bda35740ba22b37fe

Merge pull request #445 from plone/rename_post_handlers

Rename post_handlers to prevent them to be run as old importSteps.

Files changed:
M CHANGES.rst
M plone/app/contenttypes/profiles.zcml
M plone/app/contenttypes/setuphandlers.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 00693854..e17c50f7 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Rename post_handlers. Fixes https://github.com/plone/Products.CMFPlone/issues/2238
+  [pbauer]
 
 
 1.4.6 (2017-11-26)
diff --git a/plone/app/contenttypes/profiles.zcml b/plone/app/contenttypes/profiles.zcml
index e1b837a8..f3aba88d 100644
--- a/plone/app/contenttypes/profiles.zcml
+++ b/plone/app/contenttypes/profiles.zcml
@@ -9,7 +9,7 @@
     directory="profiles/content"
     description="Plone default content-types (plone.app.contenttypes)"
     provides="Products.GenericSetup.interfaces.EXTENSION"
-    post_handler=".setuphandlers.step_import_content"
+    post_handler=".setuphandlers.import_content"
     />
 
   <!-- All types, no sample content. -->
@@ -19,7 +19,7 @@
     directory="profiles/default"
     description="Plone default content-types (plone.app.contenttypes)"
     provides="Products.GenericSetup.interfaces.EXTENSION"
-    post_handler=".setuphandlers.step_setup_various"
+    post_handler=".setuphandlers.setup_various"
     />
 
   <!-- Uninstall -->
diff --git a/plone/app/contenttypes/setuphandlers.py b/plone/app/contenttypes/setuphandlers.py
index deb9320f..15a80fb8 100644
--- a/plone/app/contenttypes/setuphandlers.py
+++ b/plone/app/contenttypes/setuphandlers.py
@@ -324,7 +324,7 @@ def configure_members_folder(portal, target_language):
             assignable.setBlacklistStatus('content_type', True)
 
 
-def step_import_content(context):
+def import_content(context):
     """Create default content."""
     portal = getSite()
     target_language, is_combined_language, locale = _get_locales_info(portal)
@@ -334,7 +334,7 @@ def step_import_content(context):
     configure_members_folder(portal, target_language)
 
 
-def step_setup_various(context):
+def setup_various(context):
     portal = getSite()
     target_language, is_combined_language, locale = _get_locales_info(portal)
     _setup_calendar(portal, locale)


