Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2017-10-22T14:08:49+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/Products.Archetypes/commit/18b50d7878bfb6e99bcf078b4c1895bb31e2f4ee

Do not redefine 'set' in a macro

Files changed:
M CHANGES.rst
M Products/Archetypes/skins/archetypes/edit_macros.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index 3d751823..e94aae95 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -17,6 +17,9 @@ Bug fixes:
 - Test fixes for changes in plone.app.widgets querystring options.
   [thet]
 
+- Remove redefinition of builtin 'set' in a macro.
+  [pbauer]
+
 1.14.2 (2017-08-27)
 -------------------
 
diff --git a/Products/Archetypes/skins/archetypes/edit_macros.pt b/Products/Archetypes/skins/archetypes/edit_macros.pt
index 4c01ee86..b12a197c 100644
--- a/Products/Archetypes/skins/archetypes/edit_macros.pt
+++ b/Products/Archetypes/skins/archetypes/edit_macros.pt
@@ -49,13 +49,13 @@
 
       <div id="archetypes-schemata-links"
            tal:condition="python: fieldsets and not allow_tabbing">
-        <tal:block repeat="set fieldsets">
-          <tal:current condition="python:set == fieldset and fieldsets != ['default']">
-            <strong>[<span tal:content="set" i18n:translate="" />]</strong>
+        <tal:block repeat="fieldset fieldsets">
+          <tal:current condition="python:fieldset == fieldset and fieldsets != ['default']">
+            <strong>[<span tal:content="fieldset" i18n:translate="" />]</strong>
           </tal:current>
-          <tal:others condition="python:set != fieldset">
-            <a href="#" tal:attributes="href string:${context/absolute_url}/${template/getId}?fieldset=${set}">
-            [<span tal:content="set" i18n:translate="" />]</a>
+          <tal:others condition="python:fieldset != fieldset">
+            <a href="#" tal:attributes="href string:${context/absolute_url}/${template/getId}?fieldset=${fieldset}">
+            [<span tal:content="fieldset" i18n:translate="" />]</a>
           </tal:others>
         </tal:block>
       </div>


