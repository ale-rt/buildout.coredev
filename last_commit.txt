Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2017-01-13T15:16:42+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.contenttypes/commit/958cd3e3618d0006e647ad2d9e5dd7de5005e11b

Revert "Revert "String needs to be unicode when format parameter is unicode""

This reverts commit c518908f9159887c109a188555cf5b3dfad45d2c.

This commit was a suspect of breaking the build, but that is not true.
So this reverts my revert.
See https://github.com/plone/buildout.coredev/commit/2f8b37c314a3c33fffddbe6f5bc8760dd15a3927

Files changed:
M plone/app/contenttypes/migration/field_migrators.py

diff --git a/plone/app/contenttypes/migration/field_migrators.py b/plone/app/contenttypes/migration/field_migrators.py
index 269b5d0..fad4c1d 100644
--- a/plone/app/contenttypes/migration/field_migrators.py
+++ b/plone/app/contenttypes/migration/field_migrators.py
@@ -92,7 +92,7 @@ def migrate_imagefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
                 ('{0}_caption'.format(dst_fieldname)),
                 safe_unicode(caption_field.get(src_obj)))
 
-    logger.info('Migrating image {0}'.format(filename))
+    logger.info(u'Migrating image {0}'.format(filename))
 
 
 def migrate_blobimagefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
@@ -122,7 +122,7 @@ def migrate_blobimagefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
                 ('{0}_caption'.format(dst_fieldname)),
                 safe_unicode(old_image_caption))
 
-    logger.info('Migrating image {0}'.format(filename))
+    logger.info(u'Migrating image {0}'.format(filename))
 
 
 def migrate_filefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
@@ -142,7 +142,7 @@ def migrate_filefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
         data=old_file_data,
         filename=filename)
     setattr(dst_obj, dst_fieldname, namedblobfile)
-    logger.info('Migrating file {0}'.format(filename))
+    logger.info(u'Migrating file {0}'.format(filename))
 
 
 def migrate_datetimefield(src_obj, dst_obj, src_fieldname, dst_fieldname):


Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2017-01-13T15:17:39+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.contenttypes/commit/a8d051bc6d7b6c36f339f7171e13622bb7768492

Revert "Revert "Update changelog""

This reverts commit c4863b38c20a5b2427b7d806a2f01a93f408d1de.

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index df672f0..2aba884 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -6,7 +6,8 @@ Changelog
 
 Bug fixes:
 
-- *add item here*
+- Use unicode string when .format() parameter is unicode for the field migrator
+  [frapell]
 
 
 1.2.19 (2016-12-02)


