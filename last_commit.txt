Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2016-12-02T09:23:43+01:00
Author: Peter Holzer (agitator) <hpeter@agitator.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/1fb2e930a065e4302d49936959adc66c75b14fa5

fix SearchableText indexer

Files changed:
M CHANGES.rst
M plone/app/contenttypes/indexers.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 9d22fa2..22217d0 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,9 @@ New features:
 
 Bug fixes:
 
+- Fix SearchableText indexer, using textvalue.mimeType
+  [agitator]
+
 - Fix Mimetype icon path. With the removal of the skins folder in
   https://github.com/plone/Products.MimetypesRegistry/pull/8/commits/61acf8327e5c844bff9e5c5676170aaf0ee2c323
   we need the full resourcepath now
diff --git a/plone/app/contenttypes/indexers.py b/plone/app/contenttypes/indexers.py
index d78565c..9e22b21 100644
--- a/plone/app/contenttypes/indexers.py
+++ b/plone/app/contenttypes/indexers.py
@@ -46,7 +46,7 @@ def SearchableText(obj):
             text = transforms.convertTo(
                 'text/plain',
                 safe_unicode(textvalue.output).encode('utf8'),
-                mimetype=textvalue.outputMimeType,
+                mimetype=textvalue.mimeType,
             ).getData().strip()
 
     subject = u' '.join(


Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2016-12-02T11:18:17+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.contenttypes/commit/d571b359c865cd24616619c707931e68272b9dba

Merge pull request #380 from plone/fix-searchabletextindexer

fix SearchableText indexer

Files changed:
M CHANGES.rst
M plone/app/contenttypes/indexers.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 9d22fa2..22217d0 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,9 @@ New features:
 
 Bug fixes:
 
+- Fix SearchableText indexer, using textvalue.mimeType
+  [agitator]
+
 - Fix Mimetype icon path. With the removal of the skins folder in
   https://github.com/plone/Products.MimetypesRegistry/pull/8/commits/61acf8327e5c844bff9e5c5676170aaf0ee2c323
   we need the full resourcepath now
diff --git a/plone/app/contenttypes/indexers.py b/plone/app/contenttypes/indexers.py
index d78565c..9e22b21 100644
--- a/plone/app/contenttypes/indexers.py
+++ b/plone/app/contenttypes/indexers.py
@@ -46,7 +46,7 @@ def SearchableText(obj):
             text = transforms.convertTo(
                 'text/plain',
                 safe_unicode(textvalue.output).encode('utf8'),
-                mimetype=textvalue.outputMimeType,
+                mimetype=textvalue.mimeType,
             ).getData().strip()
 
     subject = u' '.join(


