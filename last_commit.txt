Repository: Products.CMFPlacefulWorkflow


Branch: refs/heads/1.5.x
Date: 2015-12-17T09:53:15-06:00
Author: Chrissy Wainwright (cdw9) <chrissy@sixfeetup.com>
Commit: https://github.com/plone/Products.CMFPlacefulWorkflow/commit/231a6c53a4ee3c0f2e7f9c98cce2f5bd402a3bb8

ignore Topic if it does not exist, since plone.app.collection might be installed

Files changed:
M Products/CMFPlacefulWorkflow/DefaultWorkflowPolicy.py

diff --git a/Products/CMFPlacefulWorkflow/DefaultWorkflowPolicy.py b/Products/CMFPlacefulWorkflow/DefaultWorkflowPolicy.py
index b9b6d43..a5bdcd9 100644
--- a/Products/CMFPlacefulWorkflow/DefaultWorkflowPolicy.py
+++ b/Products/CMFPlacefulWorkflow/DefaultWorkflowPolicy.py
@@ -276,7 +276,8 @@ def setChain(self, portal_type, chain, REQUEST=None):
         """
         # Verify input data
         if portal_type not in [pt.id for pt in self._listTypeInfo()]:
-            raise ValueError, ("'%s' is not a valid portal type." % portal_type)
+            if portal_type != 'Topic':
+                raise ValueError, ("'%s' is not a valid portal type." % portal_type)
 
         if type(chain) is type(''):
             chain = map( lambda x: x.strip(), chain.split(',') )


Repository: Products.CMFPlacefulWorkflow


Branch: refs/heads/1.5.x
Date: 2015-12-21T13:40:39-06:00
Author: Chrissy Wainwright (cdw9) <chrissy@sixfeetup.com>
Commit: https://github.com/plone/Products.CMFPlacefulWorkflow/commit/7d919ffa158720d7aa45f6efba7048c3c320697b

add entry to changelog for ignoring the Topic type

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 93a46ef..3d5e061 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,9 @@ New:
 
 Fixes:
 
-- *add item here*
+- Ignore the Topic content type, since it may not be available if
+  plone.app.collection is installed
+  [cdw9]
 
 
 1.5.12 (2015-10-28)


Repository: Products.CMFPlacefulWorkflow


Branch: refs/heads/1.5.x
Date: 2015-12-21T21:31:56+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlacefulWorkflow/commit/76f5f996f3e155ed80ada63b02c1cb787f638f3e

Merge pull request #8 from sixfeetup/1.5.x

ignore Topic if it does not exist, since plone.app.collection might be installed

Files changed:
M CHANGES.rst
M Products/CMFPlacefulWorkflow/DefaultWorkflowPolicy.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 93a46ef..3d5e061 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,9 @@ New:
 
 Fixes:
 
-- *add item here*
+- Ignore the Topic content type, since it may not be available if
+  plone.app.collection is installed
+  [cdw9]
 
 
 1.5.12 (2015-10-28)
diff --git a/Products/CMFPlacefulWorkflow/DefaultWorkflowPolicy.py b/Products/CMFPlacefulWorkflow/DefaultWorkflowPolicy.py
index b9b6d43..a5bdcd9 100644
--- a/Products/CMFPlacefulWorkflow/DefaultWorkflowPolicy.py
+++ b/Products/CMFPlacefulWorkflow/DefaultWorkflowPolicy.py
@@ -276,7 +276,8 @@ def setChain(self, portal_type, chain, REQUEST=None):
         """
         # Verify input data
         if portal_type not in [pt.id for pt in self._listTypeInfo()]:
-            raise ValueError, ("'%s' is not a valid portal type." % portal_type)
+            if portal_type != 'Topic':
+                raise ValueError, ("'%s' is not a valid portal type." % portal_type)
 
         if type(chain) is type(''):
             chain = map( lambda x: x.strip(), chain.split(',') )


