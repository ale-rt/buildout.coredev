Repository: Products.CMFPlone


Branch: refs/heads/5.0.x
Date: 2016-05-04T14:37:43+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/062756a117e59d62ce1572c4e243bb6c09c53d68

Removed docstrings from some methods to avoid publishing them.

From Products.PloneHotfix20160419.

Files changed:
M CHANGES.rst
M Products/CMFPlone/DublinCore.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 0ae1618..3b99285 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -22,6 +22,8 @@ Fixes:
   ``render_body`` is switched on in the Syndication settings.
   [maurits]
 
+- Removed docstrings from some methods to avoid publishing them.  From
+  Products.PloneHotfix20160419.  [maurits]
 
 - Ensured front-page is English when creating an English site.
   Previously, when creating an English site with a browser that
diff --git a/Products/CMFPlone/DublinCore.py b/Products/CMFPlone/DublinCore.py
index ea10cea..182bb7c 100644
--- a/Products/CMFPlone/DublinCore.py
+++ b/Products/CMFPlone/DublinCore.py
@@ -224,8 +224,7 @@ def CreationDate(self, zone=None):
     security.declareProtected(View, 'EffectiveDate')
 
     def EffectiveDate(self, zone=None):
-        """ Dublin Core Date element - date resource becomes effective.
-        """
+        # Dublin Core Date element - date resource becomes effective.
         if zone is None:
             zone = _zone
         ed = getattr(self, 'effective_date', None)
@@ -234,8 +233,7 @@ def EffectiveDate(self, zone=None):
     security.declareProtected(View, 'ExpirationDate')
 
     def ExpirationDate(self, zone=None):
-        """ Dublin Core Date element - date resource expires.
-        """
+        # Dublin Core Date element - date resource expires.
         if zone is None:
             zone = _zone
         ed = getattr(self, 'expiration_date', None)
@@ -253,8 +251,7 @@ def ModificationDate(self, zone=None):
     security.declareProtected(View, 'Type')
 
     def Type(self):
-        """ Dublin Core Type element - resource type.
-        """
+        # Dublin Core Type element - resource type.
         ti = self.getTypeInfo()
         return ti is not None and ti.Title() or 'Unknown'
 


Repository: Products.CMFPlone


Branch: refs/heads/5.0.x
Date: 2016-05-04T14:37:43+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/df95432101ccffbf593838d9890dbded98930faf

Removed more docstrings.

Files changed:
M Products/CMFPlone/ActionsTool.py
M Products/CMFPlone/CatalogTool.py
M Products/CMFPlone/DublinCore.py
M Products/CMFPlone/MigrationTool.py
M Products/CMFPlone/PloneBatch.py
M Products/CMFPlone/PloneControlPanel.py
M Products/CMFPlone/PloneFolder.py
M Products/CMFPlone/PloneTool.py
M Products/CMFPlone/Portal.py
M Products/CMFPlone/PropertiesTool.py
M Products/CMFPlone/QuickInstallerTool.py
M Products/CMFPlone/RegistrationTool.py
M Products/CMFPlone/SkinsTool.py
M Products/CMFPlone/TypesTool.py
M Products/CMFPlone/URLTool.py
M Products/CMFPlone/WorkflowTool.py
M Products/CMFPlone/utils.py

diff --git a/Products/CMFPlone/ActionsTool.py b/Products/CMFPlone/ActionsTool.py
index 8334160..7d96671 100644
--- a/Products/CMFPlone/ActionsTool.py
+++ b/Products/CMFPlone/ActionsTool.py
@@ -94,8 +94,7 @@ def listActionInfos(self, action_chain=None, object=None,
     def listFilteredActionsFor(self, object=None,
                                ignore_providers=(),
                                ignore_categories=None):
-        """ List all actions available to the user.
-        """
+        # List all actions available to the user.
         actions = []
 
         providers = [name for name in self.listActionProviders()
diff --git a/Products/CMFPlone/CatalogTool.py b/Products/CMFPlone/CatalogTool.py
index 93d1036..f66ca10 100644
--- a/Products/CMFPlone/CatalogTool.py
+++ b/Products/CMFPlone/CatalogTool.py
@@ -301,16 +301,14 @@ def __init__(self):
         ZCatalog.__init__(self, self.getId())
 
     def _removeIndex(self, index):
-        """Safe removal of an index.
-        """
+        # Safe removal of an index.
         try:
             self.manage_delIndex(index)
         except:
             pass
 
     def _listAllowedRolesAndUsers(self, user):
-        """Makes sure the list includes the user's groups.
-        """
+        # Makes sure the list includes the user's groups.
         result = user.getRoles()
         if 'Anonymous' in result:
             # The anonymous user has no further roles
@@ -327,11 +325,9 @@ def _listAllowedRolesAndUsers(self, user):
 
     @security.private
     def indexObject(self, object, idxs=None):
-        """Add object to catalog.
-
-        The optional idxs argument is a list of specific indexes
-        to populate (all of them by default).
-        """
+        # Add object to catalog.
+        # The optional idxs argument is a list of specific indexes
+        # to populate (all of them by default).
         if idxs is None:
             idxs = []
         self.reindexObject(object, idxs)
@@ -370,15 +366,15 @@ def getCounter(self):
 
     @security.protected(SearchZCatalog)
     def searchResults(self, REQUEST=None, **kw):
-        """Calls ZCatalog.searchResults with extra arguments that
-        limit the results to what the user is allowed to see.
+        # Calls ZCatalog.searchResults with extra arguments that
+        # limit the results to what the user is allowed to see.
+        #
+        # This version uses the 'effectiveRange' DateRangeIndex.
+        #
+        # It also accepts a keyword argument show_inactive to disable
+        # effectiveRange checking entirely even for those without portal
+        # wide AccessInactivePortalContent permission.
 
-        This version uses the 'effectiveRange' DateRangeIndex.
-
-        It also accepts a keyword argument show_inactive to disable
-        effectiveRange checking entirely even for those without portal
-        wide AccessInactivePortalContent permission.
-        """
         kw = kw.copy()
         show_inactive = kw.get('show_inactive', False)
         if isinstance(REQUEST, dict) and not show_inactive:
@@ -418,10 +414,10 @@ def search(self, *args, **kw):
 
     @security.protected(ManageZCatalogEntries)
     def clearFindAndRebuild(self):
-        """Empties catalog, then finds all contentish objects (i.e. objects
-           with an indexObject method), and reindexes them.
-           This may take a long time.
-        """
+        # Empties catalog, then finds all contentish objects (i.e. objects
+        # with an indexObject method), and reindexes them.
+        # This may take a long time.
+
         def indexObject(obj, path):
             if (base_hasattr(obj, 'indexObject') and
                     safe_callable(obj.indexObject)):
diff --git a/Products/CMFPlone/DublinCore.py b/Products/CMFPlone/DublinCore.py
index 182bb7c..1e541cc 100644
--- a/Products/CMFPlone/DublinCore.py
+++ b/Products/CMFPlone/DublinCore.py
@@ -91,18 +91,15 @@ def __init__(self, title='', subject=(), description='', contributors=(), effect
     security.declarePrivate('notifyModified')
 
     def notifyModified(self):
-        """ Take appropriate action after the resource has been modified.
-
-        Update creators and modification_date.
-        """
+        # Take appropriate action after the resource has been modified.
+        # Update creators and modification_date.
         self.addCreator()
         self.setModificationDate()
 
     security.declareProtected(ModifyPortalContent, 'addCreator')
 
     def addCreator(self, creator=None):
-        """ Add creator to Dublin Core creators.
-        """
+        # Add creator to Dublin Core creators.
         if creator is None:
             user = getSecurityManager().getUser()
             creator = user and user.getId()
@@ -114,10 +111,8 @@ def addCreator(self, creator=None):
     security.declareProtected(ModifyPortalContent, 'setModificationDate')
 
     def setModificationDate(self, modification_date=None):
-        """ Set the date when the resource was last modified.
-
-        When called without an argument, sets the date to now.
-        """
+        # Set the date when the resource was last modified.
+        # When called without an argument, sets the date to now.
         if modification_date is None:
             self.modification_date = DateTime()
         else:
@@ -129,15 +124,13 @@ def setModificationDate(self, modification_date=None):
     security.declareProtected(View, 'Title')
 
     def Title(self):
-        """ Dublin Core Title element - resource name.
-        """
+        # Dublin Core Title element - resource name.
         return self.title
 
     security.declareProtected(View, 'listCreators')
 
     def listCreators(self):
-        """ List Dublin Core Creator elements - resource authors.
-        """
+        # List Dublin Core Creator elements - resource authors.
         if not hasattr(aq_base(self), 'creators'):
             # for content created with CMF versions before 1.5
             owner_tuple = self.getOwnerTuple()
@@ -150,30 +143,26 @@ def listCreators(self):
     security.declareProtected(View, 'Creator')
 
     def Creator(self):
-        """ Dublin Core Creator element - resource author.
-        """
+        # Dublin Core Creator element - resource author.
         creators = self.listCreators()
         return creators and creators[0] or ''
 
     security.declareProtected(View, 'Subject')
 
     def Subject(self):
-        """ Dublin Core Subject element - resource keywords.
-        """
+        # Dublin Core Subject element - resource keywords.
         return getattr(self, 'subject', ())  # compensate for *old* content
 
     security.declareProtected(View, 'Description')
 
     def Description(self):
-        """ Dublin Core Description element - resource summary.
-        """
+        # Dublin Core Description element - resource summary.
         return self.description
 
     security.declareProtected(View, 'Publisher')
 
     def Publisher(self):
-        """ Dublin Core Publisher element - resource publisher.
-        """
+        # Dublin Core Publisher element - resource publisher.
         tool = getToolByName(self, 'portal_metadata', None)
 
         if tool is not None:
@@ -184,22 +173,19 @@ def Publisher(self):
     security.declareProtected(View, 'listContributors')
 
     def listContributors(self):
-        """ Dublin Core Contributor elements - resource collaborators.
-        """
+        # Dublin Core Contributor elements - resource collaborators.
         return self.contributors
 
     security.declareProtected(View, 'Contributors')
 
     def Contributors(self):
-        """ Deprecated alias of listContributors.
-        """
+        # Deprecated alias of listContributors.
         return self.listContributors()
 
     security.declareProtected(View, 'Date')
 
     def Date(self, zone=None):
-        """ Dublin Core Date element - default date.
-        """
+        # Dublin Core Date element - default date.
         if zone is None:
             zone = _zone
         # Return effective_date if set, modification date otherwise
@@ -211,8 +197,7 @@ def Date(self, zone=None):
     security.declareProtected(View, 'CreationDate')
 
     def CreationDate(self, zone=None):
-        """ Dublin Core Date element - date resource created.
-        """
+        # Dublin Core Date element - date resource created.
         if zone is None:
             zone = _zone
         # return unknown if never set properly
@@ -242,8 +227,7 @@ def ExpirationDate(self, zone=None):
     security.declareProtected(View, 'ModificationDate')
 
     def ModificationDate(self, zone=None):
-        """ Dublin Core Date element - date resource last modified.
-        """
+        # Dublin Core Date element - date resource last modified.
         if zone is None:
             zone = _zone
         return self.modified().toZone(zone).ISO()
@@ -258,15 +242,13 @@ def Type(self):
     security.declareProtected(View, 'Format')
 
     def Format(self):
-        """ Dublin Core Format element - resource format.
-        """
+        # Dublin Core Format element - resource format.
         return self.format
 
     security.declareProtected(View, 'Identifier')
 
     def Identifier(self):
-        """ Dublin Core Identifier element - resource ID.
-        """
+        # Dublin Core Identifier element - resource ID.
         # XXX: fixme using 'portal_metadata' (we need to prepend the
         #      right prefix to self.getPhysicalPath().
         return self.absolute_url()
@@ -274,15 +256,13 @@ def Identifier(self):
     security.declareProtected(View, 'Language')
 
     def Language(self):
-        """ Dublin Core Language element - resource language.
-        """
+        # Dublin Core Language element - resource language.
         return self.language
 
     security.declareProtected(View, 'Rights')
 
     def Rights(self):
-        """ Dublin Core Rights element - resource copyright.
-        """
+        # Dublin Core Rights element - resource copyright.
         return self.rights
 
     #
@@ -298,8 +278,7 @@ def content_type(self):
     security.declareProtected(View, 'isEffective')
 
     def isEffective(self, date):
-        """ Is the date within the resource's effective range?
-        """
+        # Is the date within the resource's effective range?
         pastEffective = (self.effective_date is None
                          or self.effective_date <= date)
         beforeExpiration = (self.expiration_date is None
@@ -312,8 +291,7 @@ def isEffective(self, date):
     security.declareProtected(View, 'created')
 
     def created(self):
-        """ Dublin Core Date element - date resource created.
-        """
+        # Dublin Core Date element - date resource created.
         # allow for non-existent creation_date, existed always
         date = getattr(self, 'creation_date', None)
         return date is None and self.__FLOOR_DATE or date
@@ -321,8 +299,7 @@ def created(self):
     security.declareProtected(View, 'effective')
 
     def effective(self):
-        """ Dublin Core Date element - date resource becomes effective.
-        """
+        # Dublin Core Date element - date resource becomes effective.
         marker = []
         date = getattr(self, 'effective_date', marker)
         if date is marker:
@@ -334,16 +311,14 @@ def effective(self):
     security.declareProtected(View, 'expires')
 
     def expires(self):
-        """ Dublin Core Date element - date resource expires.
-        """
+        # Dublin Core Date element - date resource expires.
         date = getattr(self, 'expiration_date', None)
         return date is None and self.__CEILING_DATE or date
 
     security.declareProtected(View, 'modified')
 
     def modified(self):
-        """ Dublin Core Date element - date resource last modified.
-        """
+        # Dublin Core Date element - date resource last modified.
         date = self.modification_date
         if date is None:
             # Upgrade.
@@ -354,8 +329,7 @@ def modified(self):
     security.declareProtected(View, 'getMetadataHeaders')
 
     def getMetadataHeaders(self):
-        """ Return RFC-822-style headers.
-        """
+        # Return RFC-822-style headers.
         hdrlist = []
         hdrlist.append(('Title', self.Title()))
         hdrlist.append(('Subject', ', '.join(self.Subject())))
@@ -386,72 +360,62 @@ def _datify(self, attrib):
     security.declareProtected(ModifyPortalContent, 'setTitle')
 
     def setTitle(self, title):
-        """ Set Dublin Core Title element - resource name.
-        """
+        # Set Dublin Core Title element - resource name.
         self.title = title
 
     security.declareProtected(ModifyPortalContent, 'setCreators')
 
     def setCreators(self, creators):
-        """ Set Dublin Core Creator elements - resource authors.
-        """
+        # Set Dublin Core Creator elements - resource authors.
         self.creators = tuplize('creators', creators)
 
     security.declareProtected(ModifyPortalContent, 'setSubject')
 
     def setSubject(self, subject):
-        """ Set Dublin Core Subject element - resource keywords.
-        """
+        # Set Dublin Core Subject element - resource keywords.
         self.subject = tuplize('subject', subject)
 
     security.declareProtected(ModifyPortalContent, 'setDescription')
 
     def setDescription(self, description):
-        """ Set Dublin Core Description element - resource summary.
-        """
+        # Set Dublin Core Description element - resource summary.
         self.description = description
 
     security.declareProtected(ModifyPortalContent, 'setContributors')
 
     def setContributors(self, contributors):
-        """ Set Dublin Core Contributor elements - resource collaborators.
-        """
+        # Set Dublin Core Contributor elements - resource collaborators.
         semi_split = lambda s: map(lambda x: x.strip(), s.split(';'))
         self.contributors = tuplize('contributors', contributors, semi_split)
 
     security.declareProtected(ModifyPortalContent, 'setEffectiveDate')
 
     def setEffectiveDate(self, effective_date):
-        """ Set Dublin Core Date element - date resource becomes effective.
-        """
+        # Set Dublin Core Date element - date resource becomes effective.
         self.effective_date = self._datify(effective_date)
 
     security.declareProtected(ModifyPortalContent, 'setExpirationDate')
 
     def setExpirationDate(self, expiration_date):
-        """ Set Dublin Core Date element - date resource expires.
-        """
+        # Set Dublin Core Date element - date resource expires.
         self.expiration_date = self._datify(expiration_date)
 
     security.declareProtected(ModifyPortalContent, 'setFormat')
 
     def setFormat(self, format):
-        """ Set Dublin Core Format element - resource format.
-        """
+        # Set Dublin Core Format element - resource format.
         self.format = format
 
     security.declareProtected(ModifyPortalContent, 'setLanguage')
 
     def setLanguage(self, language):
-        """ Set Dublin Core Language element - resource language.
-        """
+        # Set Dublin Core Language element - resource language.
         self.language = language
 
     security.declareProtected(ModifyPortalContent, 'setRights')
 
     def setRights(self, rights):
-        """ Set Dublin Core Rights element - resource copyright.
-        """
+        # Set Dublin Core Rights element - resource copyright.
         self.rights = rights
 
     #
@@ -462,8 +426,7 @@ def setRights(self, rights):
 
     def _editMetadata(self, title=_marker, subject=_marker, description=_marker, contributors=_marker, effective_date=_marker, expiration_date=_marker, format=_marker, language=_marker, rights=_marker
                       ):
-        """ Update the editable metadata for this resource.
-        """
+        # Update the editable metadata for this resource.
         if title is not _marker:
             self.setTitle(title)
         if subject is not _marker:
@@ -502,11 +465,9 @@ def manage_editMetadata(self, title, subject, description, contributors, effecti
 
     def editMetadata(self, title='', subject=(), description='', contributors=(), effective_date=None, expiration_date=None, format='text/html', language='en-US', rights=''
                      ):
-        """
-        Need to add check for webDAV locked resource for TTW methods.
-        """
-        # as per bug #69, we cant assume they use the webdav
-        # locking interface, and fail gracefully if they dont
+        # Need to add check for webDAV locked resource for TTW methods.
+        # As per bug #69, we can't assume they use the webdav
+        # locking interface, and fail gracefully if they don't.
         if hasattr(self, 'failIfLocked'):
             self.failIfLocked()
 
diff --git a/Products/CMFPlone/MigrationTool.py b/Products/CMFPlone/MigrationTool.py
index ce53f6c..afb3754 100644
--- a/Products/CMFPlone/MigrationTool.py
+++ b/Products/CMFPlone/MigrationTool.py
@@ -53,16 +53,16 @@ def __repr__(self):
             self.__class__.__name__, self.profile_id)
 
     def safe(self):
-        """Is this addon safe to upgrade?
+        # Is this addon safe to upgrade?
 
-        Is it safe to pass its profile id to
-        portal_setup.upgradeProfile?  That method checks if the
-        profile is 'unknown' and in this case does nothing.
+        # Is it safe to pass its profile id to
+        # portal_setup.upgradeProfile?  That method checks if the
+        # profile is 'unknown' and in this case does nothing.
+
+        # But in some cases the profile may have been applied, but the
+        # package is gone.  For that case, you can set
+        # self.check_module.
 
-        But in some cases the profile may have been applied, but the
-        package is gone.  For that case, you can set
-        self.check_module.
-        """
         if self.check_module:
             # Can we import a module, as evidence that the code is
             # available?  Note that some modules may have been faked,
@@ -125,7 +125,7 @@ class MigrationTool(PloneBaseTool, UniqueObject, SimpleItem):
     security.declareProtected(ManagePortal, 'getInstanceVersion')
 
     def getInstanceVersion(self):
-        """ The version this instance of plone is on """
+        # The version this instance of plone is on.
         setup = getToolByName(self, 'portal_setup')
         version = setup.getLastVersionForProfile(_DEFAULT_PROFILE)
         if isinstance(version, tuple):
@@ -153,7 +153,7 @@ def getInstanceVersion(self):
     security.declareProtected(ManagePortal, 'setInstanceVersion')
 
     def setInstanceVersion(self, version):
-        """ The version this instance of plone is on """
+        # The version this instance of plone is on.
         setup = getToolByName(self, 'portal_setup')
         setup.setLastVersionForProfile(_DEFAULT_PROFILE, version)
         self._version = False
@@ -161,7 +161,7 @@ def setInstanceVersion(self, version):
     security.declareProtected(ManagePortal, 'getFileSystemVersion')
 
     def getFileSystemVersion(self):
-        """ The version this instance of plone is on """
+        # The version this instance of plone is on.
         setup = getToolByName(self, 'portal_setup')
         try:
             return setup.getVersionForProfile(_DEFAULT_PROFILE)
@@ -172,20 +172,20 @@ def getFileSystemVersion(self):
     security.declareProtected(ManagePortal, 'getSoftwareVersion')
 
     def getSoftwareVersion(self):
-        """ The software version."""
+        # The software version.
         dist = pkg_resources.get_distribution('Products.CMFPlone')
         return dist.version
 
     security.declareProtected(ManagePortal, 'needUpgrading')
 
     def needUpgrading(self):
-        """ Need upgrading? """
+        # Need upgrading?
         return self.getInstanceVersion() != self.getFileSystemVersion()
 
     security.declareProtected(ManagePortal, 'coreVersions')
 
     def coreVersions(self):
-        """ Useful core information """
+        # Useful core information.
         vars = {}
         get_dist = pkg_resources.get_distribution
         vars['Zope'] = get_dist('Zope2').version
@@ -217,7 +217,7 @@ def coreVersions(self):
     security.declareProtected(ManagePortal, 'coreVersionsList')
 
     def coreVersionsList(self):
-        """ Useful core information """
+        # Useful core information.
         res = self.coreVersions().items()
         res.sort()
         return res
@@ -225,19 +225,19 @@ def coreVersionsList(self):
     security.declareProtected(ManagePortal, 'needUpdateRole')
 
     def needUpdateRole(self):
-        """ Do roles need to be updated? """
+        # Do roles need to be updated?
         return self._needUpdateRole
 
     security.declareProtected(ManagePortal, 'needRecatalog')
 
     def needRecatalog(self):
-        """ Does this thing now need recataloging? """
+        # Does this thing now need recataloging?
         return self._needRecatalog
 
     security.declareProtected(ManagePortal, 'upgrade')
 
     def upgrade(self, REQUEST=None, dry_run=None, swallow_errors=True):
-        """ perform the upgrade """
+        # Perform the upgrade.
         setup = getToolByName(self, 'portal_setup')
 
         # This sets the profile version if it wasn't set yet
diff --git a/Products/CMFPlone/PloneBatch.py b/Products/CMFPlone/PloneBatch.py
index 48b396e..bc05dfa 100644
--- a/Products/CMFPlone/PloneBatch.py
+++ b/Products/CMFPlone/PloneBatch.py
@@ -37,14 +37,14 @@ def initialize(self, start, end, size):
             calculate_pagerange(self.pagenumber, self.numpages, self.pagerange)
 
     def pageurl(self, formvariables, pagenumber=-1):
-        """ Makes the url for a given page """
+        # Makes the url for a given page.
         if pagenumber == -1:
             pagenumber = self.pagenumber
         b_start = pagenumber * (self.pagesize - self.overlap) - self.pagesize
         return make_query(formvariables, {self.b_start_str: b_start})
 
     def navurls(self, formvariables, navlist=None):
-        """ Returns the page number and url for the navigation quick links """
+        # Returns the page number and url for the navigation quick links.
         if navlist is None:
             navlist = []
         if not navlist:
@@ -53,11 +53,11 @@ def navurls(self, formvariables, navlist=None):
                    (x, self.pageurl(formvariables, x)), navlist)
 
     def prevurls(self, formvariables):
-        """ Helper method to get prev navigation list from templates """
+        # Helper method to get prev navigation list from templates.
         return self.navurls(formvariables, self.previous_pages)
 
     def nexturls(self, formvariables):
-        """ Helper method to get next navigation list from templates """
+        # Helper method to get next navigation list from templates.
         return self.navurls(formvariables, self.next_pages)
 
     prevlist = QuantumBatch.previous_pages
diff --git a/Products/CMFPlone/PloneControlPanel.py b/Products/CMFPlone/PloneControlPanel.py
index c939db7..73ccf97 100644
--- a/Products/CMFPlone/PloneControlPanel.py
+++ b/Products/CMFPlone/PloneControlPanel.py
@@ -164,8 +164,7 @@ def unregisterApplication(self, appId):
         self.deleteActions(selection)
 
     def _extractAction(self, properties, index):
-        """ Extract an ActionInformation from the funky form properties.
-        """
+        # Extract an ActionInformation from the funky form properties.
         id = str(properties.get('id_%d' % index, ''))
         name = str(properties.get('name_%d' % index, ''))
         action = str(properties.get('action_%d' % index, ''))
@@ -225,8 +224,7 @@ def addAction(self,
                   description='',
                   REQUEST=None,
                   ):
-        """ Add an action to our list.
-        """
+        # Add an action to our list.
         if not name:
             raise ValueError('A name is required.')
 
diff --git a/Products/CMFPlone/PloneFolder.py b/Products/CMFPlone/PloneFolder.py
index c0a64d1..84f8eca 100644
--- a/Products/CMFPlone/PloneFolder.py
+++ b/Products/CMFPlone/PloneFolder.py
@@ -61,7 +61,7 @@ def moveObject(self, id, position):
     security.declarePrivate('getIdsSubset')
 
     def getIdsSubset(self, objs):
-        """Get the ids of only cmf objects (used for moveObjectsByDelta)."""
+        # Get the ids of only cmf objects (used for moveObjectsByDelta).
         ttool = getToolByName(self, 'portal_types')
         cmf_meta_types = [ti.Metatype() for ti in ttool.listTypeInfo()]
         return [obj['id'] for obj in objs
@@ -195,7 +195,7 @@ def __browser_default__(self, request):
     security.declarePublic('contentValues')
 
     def contentValues(self, filter=None, sort_on=None, reverse=0):
-        """Able to sort on field."""
+        # Able to sort on field.
         values = PortalFolderBase.contentValues(self, filter=filter)
         if sort_on is not None:
             values.sort(lambda x, y,
@@ -210,9 +210,8 @@ def contentValues(self, filter=None, sort_on=None, reverse=0):
 
     def listFolderContents(self, contentFilter=None,
                            suppressHiddenFiles=0):
-        """Optionally you can suppress "hidden" files, or files that
-        begin with .
-        """
+        # Optionally you can suppress "hidden" files, or files that
+        # begin with '.'
         contents = PortalFolderBase.listFolderContents(self,
                                                        contentFilter=contentFilter)
         if suppressHiddenFiles:
@@ -224,9 +223,8 @@ def listFolderContents(self, contentFilter=None,
 
     def folderlistingFolderContents(self, contentFilter=None,
                                     suppressHiddenFiles=0):
-        """Calls listFolderContents in protected only by ACI so that
-        folder_listing can work without the List folder contents permission
-        """
+        # Calls listFolderContents in protected only by ACI so that
+        # folder_listing can work without the List folder contents permission.
         return self.listFolderContents(contentFilter, suppressHiddenFiles)
 
     # Override CMFCore's invokeFactory to return the id returned by the
@@ -234,7 +232,7 @@ def folderlistingFolderContents(self, contentFilter=None,
     security.declareProtected(AddPortalContent, 'invokeFactory')
 
     def invokeFactory(self, type_name, id, RESPONSE=None, *args, **kw):
-        """Invokes the portal_types tool."""
+        # Invokes the portal_types tool.
         pt = getToolByName(self, 'portal_types')
         myType = pt.getTypeInfo(self)
         if myType is not None:
diff --git a/Products/CMFPlone/PloneTool.py b/Products/CMFPlone/PloneTool.py
index 5e59bc4..84152cf 100644
--- a/Products/CMFPlone/PloneTool.py
+++ b/Products/CMFPlone/PloneTool.py
@@ -160,9 +160,8 @@ def getMailHost(self):
 
     @security.public
     def validateSingleNormalizedEmailAddress(self, address):
-        """Lower-level function to validate a single normalized email address,
-        see validateEmailAddress.
-        """
+        # Lower-level function to validate a single normalized email address,
+        # see validateEmailAddress.
         if not isinstance(address, basestring):
             return False
 
@@ -179,7 +178,7 @@ def validateSingleNormalizedEmailAddress(self, address):
 
     @security.public
     def validateSingleEmailAddress(self, address):
-        """Validate a single email address, see also validateEmailAddresses."""
+        # Validate a single email address, see also validateEmailAddresses.
         if not isinstance(address, basestring):
             return False
 
@@ -201,9 +200,8 @@ def validateSingleEmailAddress(self, address):
 
     @security.public
     def validateEmailAddresses(self, addresses):
-        """Validate a list of possibly several email addresses, see also
-        validateSingleEmailAddress.
-        """
+        # Validate a list of possibly several email addresses, see also
+        # validateSingleEmailAddress.
         if not isinstance(addresses, basestring):
             return False
 
@@ -224,10 +222,8 @@ def editMetadata(self, obj, allowDiscussion=None, title=None,
                      subject=None, description=None, contributors=None,
                      effective_date=None, expiration_date=None, format=None,
                      language=None, rights=None, **kwargs):
-        """Responsible for setting metadata on a content object.
-
-        We assume the obj implements IDublinCoreMetadata.
-        """
+        # Responsible for setting metadata on a content object.
+        # We assume the obj implements IDublinCoreMetadata.
         mt = getToolByName(self, 'portal_membership')
         if not mt.checkPermission(ModifyPortalContent, obj):
             # FIXME: Some scripts rely on this being string?
@@ -313,7 +309,7 @@ def _makeTransactionNote(self, obj, msg=''):
 
     @security.public
     def contentEdit(self, obj, **kwargs):
-        """Encapsulates how the editing of content occurs."""
+        # Encapsulates how the editing of content occurs.
         try:
             self.editMetadata(obj, **kwargs)
         except AttributeError, msg:
@@ -325,18 +321,15 @@ def contentEdit(self, obj, **kwargs):
 
     @security.public
     def availableMIMETypes(self):
-        """Returns a map of mimetypes.
-
-        Requires mimetype registry from Archetypes >= 1.3.
-        """
+        # Returns a map of mimetypes.
+        # Requires mimetype registry from Archetypes >= 1.3.
         mtr = getToolByName(self, 'mimetypes_registry')
         return mtr.list_mimetypes()
 
     @security.protected(View)
     def getWorkflowChainFor(self, object):
-        """Proxy the request for the chain to the workflow tool, as
-        this method is private there.
-        """
+        # Proxy the request for the chain to the workflow tool, as
+        # this method is private there.
         wftool = getToolByName(self, 'portal_workflow')
         wfs = ()
         try:
@@ -349,8 +342,7 @@ def getWorkflowChainFor(self, object):
 
     @security.protected(View)
     def getIconFor(self, category, id, default=_marker, context=None):
-        """Get an icon for an action, from its icon_expr.
-        """
+        # Get an icon for an action, from its icon_expr.
         if context is None:
             context = aq_parent(self)
         action_chain = '%s/%s' % (category, id)
@@ -498,21 +490,18 @@ def exceptionString(self):
     # Provide a way of dumping an exception to the log even if we
     # catch it and otherwise ignore it
     def logException(self):
-        """Dumps most recent exception to the log.
-        """
+        # Dumps most recent exception to the log.
         log_exc()
 
     @security.public
     def createSitemap(self, context, request=None):
-        """Returns a sitemap navtree structure.
-        """
+        # Returns a sitemap navtree structure.
         if request is None:
             request = self.REQUEST
         return utils.createSiteMap(context, request)
 
     def _addToNavTreeResult(self, result, data):
-        """Adds a piece of content to the result tree.
-        """
+        # Adds a piece of content to the result tree.
         return utils.addToNavTreeResult(result, data)
 
     @security.protected(AccessContentsInformation)
@@ -521,15 +510,14 @@ def typesToList(self):
 
     @security.public
     def createBreadCrumbs(self, context, request=None):
-        """Returns a structure for the portal breadcumbs.
-        """
+        # Returns a structure for the portal breadcumbs.
         if request is None:
             request = self.REQUEST
         return utils.createBreadCrumbs(context, request)
 
     @security.public
     def good_id(self, id):
-        """Exposes ObjectManager's bad_id test to skin scripts."""
+        # Exposes ObjectManager's bad_id test to skin scripts.
         m = bad_id(id)
         if m is not None:
             return 0
@@ -537,12 +525,12 @@ def good_id(self, id):
 
     @security.public
     def bad_chars(self, id):
-        """Returns a list of the Bad characters."""
+        # Returns a list of the Bad characters.
         return BAD_CHARS(id)
 
     @security.public
     def getInheritedLocalRoles(self, context):
-        """Returns a tuple with the acquired local roles."""
+        # Returns a tuple with the acquired local roles.
         portal = getToolByName(context, 'portal_url').getPortalObject()
         result = []
         cont = 1
@@ -596,21 +584,19 @@ def getInheritedLocalRoles(self, context):
 
     @security.public
     def isDefaultPage(self, obj, request=None):
-        """Finds out if the given obj is the default page in its parent folder.
-        Uses the lookup rules of Plone.  Lookup happens over a view, for which
-        in theory a different implementation may exist.
-        """
+        # Finds out if the given obj is the default page in its parent folder.
+        # Uses the lookup rules of Plone.  Lookup happens over a view, for which
+        # in theory a different implementation may exist.
         if request is None:
             request = self.REQUEST
         return check_default_page_via_view(obj, request)
 
     @security.public
     def getDefaultPage(self, obj, request=None):
-        """Given a folderish item, find out if it has a default-page using
-        the lookup rules of Plone (see Products.CMFPlone/defaultpage.py).
-        Lookup happens over a view, for which in theory a different
-        implementation may be used.
-        """
+        # Given a folderish item, find out if it has a default-page using
+        # the lookup rules of Plone (see Products.CMFPlone/defaultpage.py).
+        # Lookup happens over a view, for which in theory a different
+        # implementation may be used.
         if request is None:
             if hasattr(self, 'REQUEST'):
                 request = self.REQUEST
@@ -658,14 +644,11 @@ def addPortalMessage(self, message, type='info', request=None):
 
     @security.public
     def showPortalMessages(self, request=None):
-        """\
-        Return portal status messages that will be displayed when the
-        response web page is rendered. Portal status messages are by default
-        rendered by the global_statusmessage.pt page template. They will be
-        removed after they have been shown.
-
-        See addPortalMessages for examples.
-        """
+        # Return portal status messages that will be displayed when the
+        # response web page is rendered. Portal status messages are by default
+        # rendered by the global_statusmessage.pt page template. They will be
+        # removed after they have been shown.
+        # See addPortalMessages for examples.
         if request is None:
             request = self.REQUEST
         return IStatusMessage(request).show()
@@ -841,12 +824,10 @@ def isStructuralFolder(self, obj):
 
     @security.public
     def acquireLocalRoles(self, obj, status=1, REQUEST=None):
-        """If status is 1, allow acquisition of local roles (regular
-        behaviour).
-
-        If it's 0, prohibit it (it will allow some kind of local role
-        blacklisting).
-        """
+        # If status is 1, allow acquisition of local roles (regular
+        # behaviour).
+        # If it's 0, prohibit it (it will allow some kind of local role
+        # blacklisting).
         mt = getToolByName(self, 'portal_membership')
         if not mt.checkPermission(ModifyPortalContent, obj):
             raise Unauthorized
@@ -865,10 +846,8 @@ def acquireLocalRoles(self, obj, status=1, REQUEST=None):
 
     @security.public
     def isLocalRoleAcquired(self, obj):
-        """Returns local role acquisition blocking status.
-
-        True if normal, false if blocked.
-        """
+        # Returns local role acquisition blocking status.
+        # True if normal, false if blocked.
         if getattr(obj, '__ac_local_roles_block__', None):
             return False
         return True
@@ -947,10 +926,8 @@ def normalizeString(self, text):
 
     @security.public
     def listMetaTags(self, context):
-        """Lists meta tags helper.
-
-        Creates a mapping of meta tags -> values for the listMetaTags script.
-        """
+        # Lists meta tags helper.
+        # Creates a mapping of meta tags -> values for the listMetaTags script.
         result = {}
         mt = getToolByName(self, 'portal_membership')
 
@@ -1066,15 +1043,15 @@ def listMetaTags(self, context):
 
     @security.public
     def getUserFriendlyTypes(self, typesList=None):
-        """Get a list of types which are considered "user friendly" for search
-        and selection purposes.
-
-        This is the list of types available in the portal, minus those defined
-        in the types_not_searched property in site_properties, if it exists.
-
-        If typesList is given, this is used as the base list; else all types
-        from portal_types are used.
-        """
+        # Get a list of types which are considered "user friendly" for search
+        # and selection purposes.
+        #
+        # This is the list of types available in the portal, minus those
+        # defined in the types_not_searched property in site_properties, if it
+        # exists.
+        #
+        # If typesList is given, this is used as the base list; else all types
+        # from portal_types are used.
         if typesList is None:
             typesList = []
         registry = getUtility(IRegistry)
@@ -1093,13 +1070,13 @@ def getUserFriendlyTypes(self, typesList=None):
 
     @security.public
     def reindexOnReorder(self, parent):
-        """ reindexing of "gopip" isn't needed any longer,
-        but some extensions might need the info anyway :("""
+        # Reindexing of "gopip" isn't needed any longer,
+        # but some extensions might need the info anyway. :(
         notify(ReorderedEvent(parent))
 
     @security.public
     def isIDAutoGenerated(self, id):
-        """Determine if an id is autogenerated"""
+        # Determine if an id is autogenerated.
         return utils.isIDAutoGenerated(self, id)
 
     @security.public
@@ -1115,17 +1092,16 @@ def getEmptyTitle(self, translated=True):
 
     @security.public
     def pretty_title_or_id(self, obj, empty_value=_marker):
-        """Return the best possible title or id of an item, regardless
-        of whether obj is a catalog brain or an object, but returning an
-        empty title marker if the id is not set (i.e. it's auto-generated).
-        """
+        # Return the best possible title or id of an item, regardless
+        # of whether obj is a catalog brain or an object, but returning an
+        # empty title marker if the id is not set (i.e. it's auto-generated).
         return utils.pretty_title_or_id(self, obj, empty_value=empty_value)
 
     @security.public
     def getMethodAliases(self, typeInfo):
-        """Given an FTI, return the dict of method aliases defined on that
-        FTI. If there are no method aliases (i.e. this FTI doesn't support it),
-        return None"""
+        # Given an FTI, return the dict of method aliases defined on that
+        # FTI. If there are no method aliases (i.e. this FTI doesn't support
+        # it), return None.
         getMethodAliases = getattr(typeInfo, 'getMethodAliases', None)
         if getMethodAliases is not None \
                 and utils.safe_callable(getMethodAliases):
diff --git a/Products/CMFPlone/Portal.py b/Products/CMFPlone/Portal.py
index d4ad75f..92133cc 100644
--- a/Products/CMFPlone/Portal.py
+++ b/Products/CMFPlone/Portal.py
@@ -101,7 +101,7 @@ def index_html(self):
     index_html = ComputedAttribute(index_html, 1)
 
     def manage_beforeDelete(self, container, item):
-        """ Should send out an Event before Site is being deleted """
+        # Should send out an Event before Site is being deleted.
         self.removal_inprogress = 1
         PloneSite.inheritedAttribute('manage_beforeDelete')(self, container,
                                                             item)
@@ -151,8 +151,7 @@ def availableLanguages(self):
         return languages
 
     def isEffective(self, date):
-        """ Override DefaultDublinCoreImpl's test, since we are always viewable.
-        """
+        # Override DefaultDublinCoreImpl's test, since we are always viewable.
         return 1
 
     # Ensure portals don't get cataloged.
diff --git a/Products/CMFPlone/PropertiesTool.py b/Products/CMFPlone/PropertiesTool.py
index 6450cba..0acbe9e 100644
--- a/Products/CMFPlone/PropertiesTool.py
+++ b/Products/CMFPlone/PropertiesTool.py
@@ -55,8 +55,7 @@ def all_meta_types(self, interfaces=None):
     security.declareProtected(ManagePortal, 'addPropertySheet')
 
     def addPropertySheet(self, id, title='', propertysheet=None):
-        """ Add a new PropertySheet
-        """
+        # Add a new PropertySheet.
         o = SimpleItemWithProperties(id, title)
 
         # copy the propertysheet values onto the new instance
@@ -91,8 +90,7 @@ def manage_addPropertySheet(self, id, title='',
     security.declareProtected(ManagePortal, 'editProperties')
 
     def editProperties(self, props):
-        """Change portal settings
-        """
+        # Change portal settings.
         aq_parent(aq_inner(self)).manage_changeProperties(props)
         if hasattr(self, 'propertysheets'):
             ps = self.propertysheets
diff --git a/Products/CMFPlone/QuickInstallerTool.py b/Products/CMFPlone/QuickInstallerTool.py
index c04f8d6..700364c 100644
--- a/Products/CMFPlone/QuickInstallerTool.py
+++ b/Products/CMFPlone/QuickInstallerTool.py
@@ -20,9 +20,8 @@ class QuickInstallerTool(PloneBaseTool, BaseTool):
     security.declareProtected(ManagePortal, 'upgradeInfo')
 
     def upgradeInfo(self, pid):
-        """Returns a dict with two booleans values, stating if an upgrade
-        is required and available.
-        """
+        # Returns a dict with two booleans values, stating if an upgrade
+        # required and available.
         available = self.isProductAvailable(pid)
         if not available:
             return False
diff --git a/Products/CMFPlone/RegistrationTool.py b/Products/CMFPlone/RegistrationTool.py
index ca8108b..d1babb7 100644
--- a/Products/CMFPlone/RegistrationTool.py
+++ b/Products/CMFPlone/RegistrationTool.py
@@ -152,7 +152,7 @@ def getPassword(self, length=5, s=None):
     security.declarePublic('isValidEmail')
 
     def isValidEmail(self, email):
-        """ checks for valid email """
+        # Checks for valid email.
         if EMAIL_RE.search(email) == None:
             return 0
         try:
@@ -168,11 +168,10 @@ def isValidEmail(self, email):
     security.declarePublic('testPasswordValidity')
 
     def testPasswordValidity(self, password, confirm=None):
-        """ Verify that the password satisfies the portal's requirements.
-
-        o If the password is valid, return None.
-        o If not, return a string explaining why.
-        """
+        # Verify that the password satisfies the portal's requirements.
+        #
+        # o If the password is valid, return None.
+        # o If not, return a string explaining why.
         err = self.pasValidation('password', password)
         if err and (password == '' or not _checkPermission(ManagePortal, self)):
             return err
@@ -183,7 +182,7 @@ def testPasswordValidity(self, password, confirm=None):
         return None
 
     def pasValidation(self, property, password):
-        """ @return None if no PAS password validators exist or a list of errors """
+        # @return None if no PAS password validators exist or a list of errors.
         portal = getUtility(ISiteRoot)
         pas_instance = portal.acl_users
         validators = pas_instance.plugins.listPlugins(IValidationPlugin)
@@ -214,13 +213,13 @@ def pasValidation(self, property, password):
     security.declarePublic('testPropertiesValidity')
 
     def testPropertiesValidity(self, props, member=None):
-        """ Verify that the properties supplied satisfy portal's requirements.
+        # Verify that the properties supplied satisfy portal's requirements.
 
-        o If the properties are valid, return None.
-        o If not, return a string explaining why.
+        # o If the properties are valid, return None.
+        # o If not, return a string explaining why.
+
+        # We also check if the email property is writable before verifying it.
 
-        We also check if the email property is writable before verifying it.
-        """
         if member is None:  # New member.
 
             username = props.get('username', '')
@@ -305,16 +304,16 @@ def isMemberIdAllowed(self, id):
     security.declarePublic('generatePassword')
 
     def generatePassword(self):
-        """Generate a strong default password. The user never gets sent
-        this so we can make it very long."""
+        # Generate a strong default password. The user never gets sent
+        # this so we can make it very long.
 
         return self.getPassword(56)
 
     security.declarePublic('generateResetCode')
 
     def generateResetCode(self, salt, length=14):
-        """Generates a reset code which is guaranteed to return the
-        same value for a given length and salt, every time."""
+        # Generates a reset code which is guaranteed to return the
+        # same value for a given length and salt, every time.
         return self.getPassword(length, salt)
 
     security.declarePublic('mailPassword')
@@ -398,7 +397,7 @@ def mailPassword(self, login, REQUEST, immediate=False):
     security.declarePublic('registeredNotify')
 
     def registeredNotify(self, new_member_id):
-        """ Wrapper around registeredNotify """
+        # Wrapper around registeredNotify.
         membership = getToolByName(self, 'portal_membership')
         utils = getToolByName(self, 'plone_utils')
         member = membership.getMemberById(new_member_id)
diff --git a/Products/CMFPlone/SkinsTool.py b/Products/CMFPlone/SkinsTool.py
index f9dc8aa..6cb1cdd 100644
--- a/Products/CMFPlone/SkinsTool.py
+++ b/Products/CMFPlone/SkinsTool.py
@@ -20,8 +20,7 @@ class SkinsTool(PloneBaseTool, BaseTool):
     security.declareProtected(ManagePortal, 'addSkinSelection')
 
     def addSkinSelection(self, skinname, skinpath, test=0, make_default=0):
-        """ adds a skin selection
-        """
+        # Adds a skin selection.
         super(SkinsTool, self).addSkinSelection(skinname, skinpath,
                                                 test=test, make_default=make_default)
         # when adding a new skin, we need to tell RR about it
diff --git a/Products/CMFPlone/TypesTool.py b/Products/CMFPlone/TypesTool.py
index 5fe4de9..88bdef2 100644
--- a/Products/CMFPlone/TypesTool.py
+++ b/Products/CMFPlone/TypesTool.py
@@ -17,7 +17,7 @@ class TypesTool(PloneBaseTool, BaseTool):
     security.declarePublic('listTypeTitles')
 
     def listTypeTitles(self, container=None):
-        """ Return a dictionary of id/Title combinations """
+        # Return a dictionary of id/Title combinations.
         typenames = {}
         for t in self.listTypeInfo(container):
             name = t.getId()
@@ -29,8 +29,7 @@ def listTypeTitles(self, container=None):
     security.declarePrivate('listActions')
 
     def listActions(self, info=None, object=None, category=None):
-        """ List all the actions defined by a provider.
-        """
+        # List all the actions defined by a provider.
         actions = []
         if object is None and info is not None:
             object = info.object
diff --git a/Products/CMFPlone/URLTool.py b/Products/CMFPlone/URLTool.py
index eb38ece..13cc40a 100644
--- a/Products/CMFPlone/URLTool.py
+++ b/Products/CMFPlone/URLTool.py
@@ -19,17 +19,17 @@ class URLTool(PloneBaseTool, BaseTool):
     security.declarePublic('isURLInPortal')
 
     def isURLInPortal(self, url, context=None):
-        """ Check if a given url is on the same host and contains the portal
-            path.  Used to ensure that login forms can determine relevant
-            referrers (i.e. in portal).  Also return true for some relative
-            urls if context is passed in to allow for url parsing. When context
-            is not provided, assume that relative urls are in the portal. It is
-            assumed that http://portal is the same portal as https://portal.
+        # Check if a given url is on the same host and contains the portal
+        # path.  Used to ensure that login forms can determine relevant
+        # referrers (i.e. in portal).  Also return true for some relative
+        # urls if context is passed in to allow for url parsing. When context
+        # is not provided, assume that relative urls are in the portal. It is
+        # assumed that http://portal is the same portal as https://portal.
+
+        # External sites listed in 'allow_external_login_sites' of
+        # site_properties are also considered within the portal to allow for
+        # single sign on.
 
-            External sites listed in 'allow_external_login_sites' of
-            site_properties are also considered within the portal to allow for
-            single sign on.
-        """
         # sanitize url
         url = re.sub('^[\x00-\x20]+', '', url).strip()
         if ('<script' in url or '%3Cscript' in url or 'javascript:' in url or
diff --git a/Products/CMFPlone/WorkflowTool.py b/Products/CMFPlone/WorkflowTool.py
index 5527f96..de911f2 100644
--- a/Products/CMFPlone/WorkflowTool.py
+++ b/Products/CMFPlone/WorkflowTool.py
@@ -23,7 +23,7 @@ class WorkflowTool(PloneBaseTool, BaseTool):
     # TODO this should not make it into 1.0
     # Refactor me, my maker was tired
     def flattenTransitions(self, objs, container=None):
-        """ this is really hokey - hold on!!"""
+        # This is really hokey - hold on!!
         if hasattr(objs, 'startswith'):
             return ()
 
@@ -52,7 +52,7 @@ def flattenTransitions(self, objs, container=None):
         return tuple(transitions[:])
 
     def flattenTransitionsForPaths(self, paths):
-        """ this is even more hokey!!"""
+        # This is even more hokey!!
         if hasattr(paths, 'startswith'):
             return ()
 
@@ -108,9 +108,8 @@ def getTransitionsFor(self, obj=None, container=None, REQUEST=None):
         return tuple(result.values())
 
     def workflows_in_use(self):
-        """ gathers all the available workflow chains (sequence
-        of workflow ids).
-        """
+        # Gathers all the available workflow chains (sequence
+        # of workflow ids).
         in_use = []
 
         in_use.append(self._default_chain)
@@ -124,17 +123,17 @@ def workflows_in_use(self):
     security.declarePublic('getWorklists')
 
     def getWorklists(self):
-        """ instead of manually scraping actions_box, lets:
-            query for all worklists in all workflow definitions.
-            Returns a dictionary whos value is sequence of dictionaries
-
-            i.e. map[workflow_id]=(workflow definition map, )
-            each workflow defintion map contains the following:
-            (worklist)id, guard (Guard instance), guard_permissions (permission
-            of Guard instance), guard_roles (roles of Guard instance),
-            catalog_vars (mapping), actbox_name (actions box label),
-            actbox_url (actions box url) and types (list of portal types)
-        """
+        # Instead of manually scraping actions_box, let's
+        # query for all worklists in all workflow definitions.
+        # Returns a dictionary whose value is a sequence of dictionaries.
+
+        # i.e. map[workflow_id]=(workflow definition map, )
+        # each workflow defintion map contains the following:
+        # (worklist)id, guard (Guard instance), guard_permissions (permission
+        # of Guard instance), guard_roles (roles of Guard instance),
+        # catalog_vars (mapping), actbox_name (actions box label),
+        # actbox_url (actions box url) and types (list of portal types)
+
         # We want to know which types use the workflows with worklists
         # This for example avoids displaying 'pending' of multiple workflows in
         # the same worklist
@@ -189,13 +188,12 @@ def getWorklists(self):
     security.declarePublic('getWorklistsResults')
 
     def getWorklistsResults(self):
-        """Return all the objects concerned by one or more worklists
-
-        This method replace 'getWorklists' by implementing the whole worklists
-        work for the script.
-        An object is returned only once, even if is return by several
-        worklists. Make the whole work as expensive it is.
-        """
+        # Return all the objects concerned by one or more worklists.
+        #
+        # This method replace 'getWorklists' by implementing the whole
+        # worklists work for the script.  An object is returned only once, even
+        # if is return by several worklists. Make the whole work as expensive
+        # it is.
         sm = getSecurityManager()
         # We want to know which types use the workflows with worklists
         # This for example avoids displaying 'pending' of multiple workflows in
@@ -249,8 +247,7 @@ def getWorklistsResults(self):
     security.declareProtected(ManagePortal, 'getChainForPortalType')
 
     def getChainForPortalType(self, pt_name, managescreen=0):
-        """ Get a chain for a specific portal type.
-        """
+        # Get a chain for a specific portal type.
         if pt_name in self._chains_by_type:
             return self._chains_by_type[pt_name]
         else:
@@ -264,16 +261,14 @@ def getChainForPortalType(self, pt_name, managescreen=0):
     security.declareProtected(ManagePortal, 'listWorkflows')
 
     def listWorkflows(self):
-        """ Return the list of workflows
-        """
+        # Return the list of workflows.
         return self.keys()
 
     security.declarePublic('getTitleForStateOnType')
 
     def getTitleForStateOnType(self, state_name, p_type):
-        """Returns the workflow state title for a given state name,
-           uses a portal_type to determine which workflow to use
-        """
+        # Returns the workflow state title for a given state name,
+        # uses a portal_type to determine which workflow to use.
         if state_name and p_type is not None:
             chain = self.getChainForPortalType(p_type)
             for wf_id in chain:
@@ -289,9 +284,8 @@ def getTitleForStateOnType(self, state_name, p_type):
     security.declarePublic('getTitleForTransitionOnType')
 
     def getTitleForTransitionOnType(self, trans_name, p_type):
-        """Returns the workflow transition title for a given transition name,
-           uses a portal_type to determine which workflow to use
-        """
+        # Returns the workflow transition title for a given transition name,
+        # uses a portal_type to determine which workflow to use.
         if trans_name and p_type is not None:
             chain = self.getChainForPortalType(p_type)
             for wf_id in chain:
@@ -307,8 +301,8 @@ def getTitleForTransitionOnType(self, trans_name, p_type):
     security.declarePublic('listWFStatesByTitle')
 
     def listWFStatesByTitle(self, filter_similar=False):
-        """Returns the states of all available workflows, optionally filtering
-           out states with matching title and id"""
+        # Returns the states of all available workflows, optionally filtering
+        # out states with matching title and id.
         states = []
         dup_list = {}
         for wf in self.values():
@@ -326,11 +320,9 @@ def listWFStatesByTitle(self, filter_similar=False):
 
     # PLIP 217 Workflow by adaptation
     def getChainFor(self, ob):
-        """
-        Returns the chain that applies to the given object.
-        If we get a string as the ob parameter, use it as
-        the portal_type.
-        """
+        # Returns the chain that applies to the given object.
+        # If we get a string as the ob parameter, use it as
+        # the portal_type.
         return getMultiAdapter((ob, self), IWorkflowChain)
 
     security.declarePrivate('listActions')
diff --git a/Products/CMFPlone/utils.py b/Products/CMFPlone/utils.py
index 60c51ab..4ffbb75 100644
--- a/Products/CMFPlone/utils.py
+++ b/Products/CMFPlone/utils.py
@@ -266,7 +266,7 @@ def getIcon(self, context, path):
         return icon
 
     def initialize(self, context):
-        """ Wrap the CMFCore Tool Init method """
+        # Wrap the CMFCore Tool Init method.
         CMFCoreToolInit.initialize(self, context)
         for tool in self.tools:
             # Get the icon path from the tool


Repository: Products.CMFPlone


Branch: refs/heads/5.0.x
Date: 2016-05-04T14:38:09+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/09b0a0ca059eaafa30098c865d7a5f367bbd034b

Fixed one security test.

Files changed:
M Products/CMFPlone/tests/testSecurity.py

diff --git a/Products/CMFPlone/tests/testSecurity.py b/Products/CMFPlone/tests/testSecurity.py
index 1e25d5e..e31e15c 100644
--- a/Products/CMFPlone/tests/testSecurity.py
+++ b/Products/CMFPlone/tests/testSecurity.py
@@ -78,8 +78,7 @@ def test_widget_traversal_2(self):
     def test_registerConfiglet_1(self):
         VECTOR = "/plone/portal_controlpanel/registerConfiglet?id=cake&name=Cakey&action=woo&permission=View&icon_expr="
         res = self.publish(VECTOR)
-        self.assertTrue(res.headers['location'].startswith(
-            'http://nohost/plone/acl_users/credentials_cookie_auth/require_login'))
+        self.assertEqual(404, res.status)
 
     def test_registerConfiglet_2(self):
         VECTOR = "/plone/portal_controlpanel/registerConfiglet?id=cake&name=Cakey&action=woo&permission=View&icon_expr="


Repository: Products.CMFPlone


Branch: refs/heads/5.0.x
Date: 2016-05-04T14:37:43+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/06e96975a6f90bbb704bde7831ba6c9909619f7e

Merge pull request #1538 from plone/apply-hotfix-20160419

Apply hotfix 20160419

Files changed:
M CHANGES.rst
M Products/CMFPlone/ActionsTool.py
M Products/CMFPlone/CatalogTool.py
M Products/CMFPlone/DublinCore.py
M Products/CMFPlone/MigrationTool.py
M Products/CMFPlone/PloneBatch.py
M Products/CMFPlone/PloneControlPanel.py
M Products/CMFPlone/PloneFolder.py
M Products/CMFPlone/PloneTool.py
M Products/CMFPlone/Portal.py
M Products/CMFPlone/PropertiesTool.py
M Products/CMFPlone/QuickInstallerTool.py
M Products/CMFPlone/RegistrationTool.py
M Products/CMFPlone/SkinsTool.py
M Products/CMFPlone/TypesTool.py
M Products/CMFPlone/URLTool.py
M Products/CMFPlone/WorkflowTool.py
M Products/CMFPlone/tests/testSecurity.py
M Products/CMFPlone/utils.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 0ae1618..3b99285 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -22,6 +22,8 @@ Fixes:
   ``render_body`` is switched on in the Syndication settings.
   [maurits]
 
+- Removed docstrings from some methods to avoid publishing them.  From
+  Products.PloneHotfix20160419.  [maurits]
 
 - Ensured front-page is English when creating an English site.
   Previously, when creating an English site with a browser that
diff --git a/Products/CMFPlone/ActionsTool.py b/Products/CMFPlone/ActionsTool.py
index 8334160..7d96671 100644
--- a/Products/CMFPlone/ActionsTool.py
+++ b/Products/CMFPlone/ActionsTool.py
@@ -94,8 +94,7 @@ def listActionInfos(self, action_chain=None, object=None,
     def listFilteredActionsFor(self, object=None,
                                ignore_providers=(),
                                ignore_categories=None):
-        """ List all actions available to the user.
-        """
+        # List all actions available to the user.
         actions = []
 
         providers = [name for name in self.listActionProviders()
diff --git a/Products/CMFPlone/CatalogTool.py b/Products/CMFPlone/CatalogTool.py
index 93d1036..f66ca10 100644
--- a/Products/CMFPlone/CatalogTool.py
+++ b/Products/CMFPlone/CatalogTool.py
@@ -301,16 +301,14 @@ def __init__(self):
         ZCatalog.__init__(self, self.getId())
 
     def _removeIndex(self, index):
-        """Safe removal of an index.
-        """
+        # Safe removal of an index.
         try:
             self.manage_delIndex(index)
         except:
             pass
 
     def _listAllowedRolesAndUsers(self, user):
-        """Makes sure the list includes the user's groups.
-        """
+        # Makes sure the list includes the user's groups.
         result = user.getRoles()
         if 'Anonymous' in result:
             # The anonymous user has no further roles
@@ -327,11 +325,9 @@ def _listAllowedRolesAndUsers(self, user):
 
     @security.private
     def indexObject(self, object, idxs=None):
-        """Add object to catalog.
-
-        The optional idxs argument is a list of specific indexes
-        to populate (all of them by default).
-        """
+        # Add object to catalog.
+        # The optional idxs argument is a list of specific indexes
+        # to populate (all of them by default).
         if idxs is None:
             idxs = []
         self.reindexObject(object, idxs)
@@ -370,15 +366,15 @@ def getCounter(self):
 
     @security.protected(SearchZCatalog)
     def searchResults(self, REQUEST=None, **kw):
-        """Calls ZCatalog.searchResults with extra arguments that
-        limit the results to what the user is allowed to see.
+        # Calls ZCatalog.searchResults with extra arguments that
+        # limit the results to what the user is allowed to see.
+        #
+        # This version uses the 'effectiveRange' DateRangeIndex.
+        #
+        # It also accepts a keyword argument show_inactive to disable
+        # effectiveRange checking entirely even for those without portal
+        # wide AccessInactivePortalContent permission.
 
-        This version uses the 'effectiveRange' DateRangeIndex.
-
-        It also accepts a keyword argument show_inactive to disable
-        effectiveRange checking entirely even for those without portal
-        wide AccessInactivePortalContent permission.
-        """
         kw = kw.copy()
         show_inactive = kw.get('show_inactive', False)
         if isinstance(REQUEST, dict) and not show_inactive:
@@ -418,10 +414,10 @@ def search(self, *args, **kw):
 
     @security.protected(ManageZCatalogEntries)
     def clearFindAndRebuild(self):
-        """Empties catalog, then finds all contentish objects (i.e. objects
-           with an indexObject method), and reindexes them.
-           This may take a long time.
-        """
+        # Empties catalog, then finds all contentish objects (i.e. objects
+        # with an indexObject method), and reindexes them.
+        # This may take a long time.
+
         def indexObject(obj, path):
             if (base_hasattr(obj, 'indexObject') and
                     safe_callable(obj.indexObject)):
diff --git a/Products/CMFPlone/DublinCore.py b/Products/CMFPlone/DublinCore.py
index ea10cea..1e541cc 100644
--- a/Products/CMFPlone/DublinCore.py
+++ b/Products/CMFPlone/DublinCore.py
@@ -91,18 +91,15 @@ def __init__(self, title='', subject=(), description='', contributors=(), effect
     security.declarePrivate('notifyModified')
 
     def notifyModified(self):
-        """ Take appropriate action after the resource has been modified.
-
-        Update creators and modification_date.
-        """
+        # Take appropriate action after the resource has been modified.
+        # Update creators and modification_date.
         self.addCreator()
         self.setModificationDate()
 
     security.declareProtected(ModifyPortalContent, 'addCreator')
 
     def addCreator(self, creator=None):
-        """ Add creator to Dublin Core creators.
-        """
+        # Add creator to Dublin Core creators.
         if creator is None:
             user = getSecurityManager().getUser()
             creator = user and user.getId()
@@ -114,10 +111,8 @@ def addCreator(self, creator=None):
     security.declareProtected(ModifyPortalContent, 'setModificationDate')
 
     def setModificationDate(self, modification_date=None):
-        """ Set the date when the resource was last modified.
-
-        When called without an argument, sets the date to now.
-        """
+        # Set the date when the resource was last modified.
+        # When called without an argument, sets the date to now.
         if modification_date is None:
             self.modification_date = DateTime()
         else:
@@ -129,15 +124,13 @@ def setModificationDate(self, modification_date=None):
     security.declareProtected(View, 'Title')
 
     def Title(self):
-        """ Dublin Core Title element - resource name.
-        """
+        # Dublin Core Title element - resource name.
         return self.title
 
     security.declareProtected(View, 'listCreators')
 
     def listCreators(self):
-        """ List Dublin Core Creator elements - resource authors.
-        """
+        # List Dublin Core Creator elements - resource authors.
         if not hasattr(aq_base(self), 'creators'):
             # for content created with CMF versions before 1.5
             owner_tuple = self.getOwnerTuple()
@@ -150,30 +143,26 @@ def listCreators(self):
     security.declareProtected(View, 'Creator')
 
     def Creator(self):
-        """ Dublin Core Creator element - resource author.
-        """
+        # Dublin Core Creator element - resource author.
         creators = self.listCreators()
         return creators and creators[0] or ''
 
     security.declareProtected(View, 'Subject')
 
     def Subject(self):
-        """ Dublin Core Subject element - resource keywords.
-        """
+        # Dublin Core Subject element - resource keywords.
         return getattr(self, 'subject', ())  # compensate for *old* content
 
     security.declareProtected(View, 'Description')
 
     def Description(self):
-        """ Dublin Core Description element - resource summary.
-        """
+        # Dublin Core Description element - resource summary.
         return self.description
 
     security.declareProtected(View, 'Publisher')
 
     def Publisher(self):
-        """ Dublin Core Publisher element - resource publisher.
-        """
+        # Dublin Core Publisher element - resource publisher.
         tool = getToolByName(self, 'portal_metadata', None)
 
         if tool is not None:
@@ -184,22 +173,19 @@ def Publisher(self):
     security.declareProtected(View, 'listContributors')
 
     def listContributors(self):
-        """ Dublin Core Contributor elements - resource collaborators.
-        """
+        # Dublin Core Contributor elements - resource collaborators.
         return self.contributors
 
     security.declareProtected(View, 'Contributors')
 
     def Contributors(self):
-        """ Deprecated alias of listContributors.
-        """
+        # Deprecated alias of listContributors.
         return self.listContributors()
 
     security.declareProtected(View, 'Date')
 
     def Date(self, zone=None):
-        """ Dublin Core Date element - default date.
-        """
+        # Dublin Core Date element - default date.
         if zone is None:
             zone = _zone
         # Return effective_date if set, modification date otherwise
@@ -211,8 +197,7 @@ def Date(self, zone=None):
     security.declareProtected(View, 'CreationDate')
 
     def CreationDate(self, zone=None):
-        """ Dublin Core Date element - date resource created.
-        """
+        # Dublin Core Date element - date resource created.
         if zone is None:
             zone = _zone
         # return unknown if never set properly
@@ -224,8 +209,7 @@ def CreationDate(self, zone=None):
     security.declareProtected(View, 'EffectiveDate')
 
     def EffectiveDate(self, zone=None):
-        """ Dublin Core Date element - date resource becomes effective.
-        """
+        # Dublin Core Date element - date resource becomes effective.
         if zone is None:
             zone = _zone
         ed = getattr(self, 'effective_date', None)
@@ -234,8 +218,7 @@ def EffectiveDate(self, zone=None):
     security.declareProtected(View, 'ExpirationDate')
 
     def ExpirationDate(self, zone=None):
-        """ Dublin Core Date element - date resource expires.
-        """
+        # Dublin Core Date element - date resource expires.
         if zone is None:
             zone = _zone
         ed = getattr(self, 'expiration_date', None)
@@ -244,8 +227,7 @@ def ExpirationDate(self, zone=None):
     security.declareProtected(View, 'ModificationDate')
 
     def ModificationDate(self, zone=None):
-        """ Dublin Core Date element - date resource last modified.
-        """
+        # Dublin Core Date element - date resource last modified.
         if zone is None:
             zone = _zone
         return self.modified().toZone(zone).ISO()
@@ -253,23 +235,20 @@ def ModificationDate(self, zone=None):
     security.declareProtected(View, 'Type')
 
     def Type(self):
-        """ Dublin Core Type element - resource type.
-        """
+        # Dublin Core Type element - resource type.
         ti = self.getTypeInfo()
         return ti is not None and ti.Title() or 'Unknown'
 
     security.declareProtected(View, 'Format')
 
     def Format(self):
-        """ Dublin Core Format element - resource format.
-        """
+        # Dublin Core Format element - resource format.
         return self.format
 
     security.declareProtected(View, 'Identifier')
 
     def Identifier(self):
-        """ Dublin Core Identifier element - resource ID.
-        """
+        # Dublin Core Identifier element - resource ID.
         # XXX: fixme using 'portal_metadata' (we need to prepend the
         #      right prefix to self.getPhysicalPath().
         return self.absolute_url()
@@ -277,15 +256,13 @@ def Identifier(self):
     security.declareProtected(View, 'Language')
 
     def Language(self):
-        """ Dublin Core Language element - resource language.
-        """
+        # Dublin Core Language element - resource language.
         return self.language
 
     security.declareProtected(View, 'Rights')
 
     def Rights(self):
-        """ Dublin Core Rights element - resource copyright.
-        """
+        # Dublin Core Rights element - resource copyright.
         return self.rights
 
     #
@@ -301,8 +278,7 @@ def content_type(self):
     security.declareProtected(View, 'isEffective')
 
     def isEffective(self, date):
-        """ Is the date within the resource's effective range?
-        """
+        # Is the date within the resource's effective range?
         pastEffective = (self.effective_date is None
                          or self.effective_date <= date)
         beforeExpiration = (self.expiration_date is None
@@ -315,8 +291,7 @@ def isEffective(self, date):
     security.declareProtected(View, 'created')
 
     def created(self):
-        """ Dublin Core Date element - date resource created.
-        """
+        # Dublin Core Date element - date resource created.
         # allow for non-existent creation_date, existed always
         date = getattr(self, 'creation_date', None)
         return date is None and self.__FLOOR_DATE or date
@@ -324,8 +299,7 @@ def created(self):
     security.declareProtected(View, 'effective')
 
     def effective(self):
-        """ Dublin Core Date element - date resource becomes effective.
-        """
+        # Dublin Core Date element - date resource becomes effective.
         marker = []
         date = getattr(self, 'effective_date', marker)
         if date is marker:
@@ -337,16 +311,14 @@ def effective(self):
     security.declareProtected(View, 'expires')
 
     def expires(self):
-        """ Dublin Core Date element - date resource expires.
-        """
+        # Dublin Core Date element - date resource expires.
         date = getattr(self, 'expiration_date', None)
         return date is None and self.__CEILING_DATE or date
 
     security.declareProtected(View, 'modified')
 
     def modified(self):
-        """ Dublin Core Date element - date resource last modified.
-        """
+        # Dublin Core Date element - date resource last modified.
         date = self.modification_date
         if date is None:
             # Upgrade.
@@ -357,8 +329,7 @@ def modified(self):
     security.declareProtected(View, 'getMetadataHeaders')
 
     def getMetadataHeaders(self):
-        """ Return RFC-822-style headers.
-        """
+        # Return RFC-822-style headers.
         hdrlist = []
         hdrlist.append(('Title', self.Title()))
         hdrlist.append(('Subject', ', '.join(self.Subject())))
@@ -389,72 +360,62 @@ def _datify(self, attrib):
     security.declareProtected(ModifyPortalContent, 'setTitle')
 
     def setTitle(self, title):
-        """ Set Dublin Core Title element - resource name.
-        """
+        # Set Dublin Core Title element - resource name.
         self.title = title
 
     security.declareProtected(ModifyPortalContent, 'setCreators')
 
     def setCreators(self, creators):
-        """ Set Dublin Core Creator elements - resource authors.
-        """
+        # Set Dublin Core Creator elements - resource authors.
         self.creators = tuplize('creators', creators)
 
     security.declareProtected(ModifyPortalContent, 'setSubject')
 
     def setSubject(self, subject):
-        """ Set Dublin Core Subject element - resource keywords.
-        """
+        # Set Dublin Core Subject element - resource keywords.
         self.subject = tuplize('subject', subject)
 
     security.declareProtected(ModifyPortalContent, 'setDescription')
 
     def setDescription(self, description):
-        """ Set Dublin Core Description element - resource summary.
-        """
+        # Set Dublin Core Description element - resource summary.
         self.description = description
 
     security.declareProtected(ModifyPortalContent, 'setContributors')
 
     def setContributors(self, contributors):
-        """ Set Dublin Core Contributor elements - resource collaborators.
-        """
+        # Set Dublin Core Contributor elements - resource collaborators.
         semi_split = lambda s: map(lambda x: x.strip(), s.split(';'))
         self.contributors = tuplize('contributors', contributors, semi_split)
 
     security.declareProtected(ModifyPortalContent, 'setEffectiveDate')
 
     def setEffectiveDate(self, effective_date):
-        """ Set Dublin Core Date element - date resource becomes effective.
-        """
+        # Set Dublin Core Date element - date resource becomes effective.
         self.effective_date = self._datify(effective_date)
 
     security.declareProtected(ModifyPortalContent, 'setExpirationDate')
 
     def setExpirationDate(self, expiration_date):
-        """ Set Dublin Core Date element - date resource expires.
-        """
+        # Set Dublin Core Date element - date resource expires.
         self.expiration_date = self._datify(expiration_date)
 
     security.declareProtected(ModifyPortalContent, 'setFormat')
 
     def setFormat(self, format):
-        """ Set Dublin Core Format element - resource format.
-        """
+        # Set Dublin Core Format element - resource format.
         self.format = format
 
     security.declareProtected(ModifyPortalContent, 'setLanguage')
 
     def setLanguage(self, language):
-        """ Set Dublin Core Language element - resource language.
-        """
+        # Set Dublin Core Language element - resource language.
         self.language = language
 
     security.declareProtected(ModifyPortalContent, 'setRights')
 
     def setRights(self, rights):
-        """ Set Dublin Core Rights element - resource copyright.
-        """
+        # Set Dublin Core Rights element - resource copyright.
         self.rights = rights
 
     #
@@ -465,8 +426,7 @@ def setRights(self, rights):
 
     def _editMetadata(self, title=_marker, subject=_marker, description=_marker, contributors=_marker, effective_date=_marker, expiration_date=_marker, format=_marker, language=_marker, rights=_marker
                       ):
-        """ Update the editable metadata for this resource.
-        """
+        # Update the editable metadata for this resource.
         if title is not _marker:
             self.setTitle(title)
         if subject is not _marker:
@@ -505,11 +465,9 @@ def manage_editMetadata(self, title, subject, description, contributors, effecti
 
     def editMetadata(self, title='', subject=(), description='', contributors=(), effective_date=None, expiration_date=None, format='text/html', language='en-US', rights=''
                      ):
-        """
-        Need to add check for webDAV locked resource for TTW methods.
-        """
-        # as per bug #69, we cant assume they use the webdav
-        # locking interface, and fail gracefully if they dont
+        # Need to add check for webDAV locked resource for TTW methods.
+        # As per bug #69, we can't assume they use the webdav
+        # locking interface, and fail gracefully if they don't.
         if hasattr(self, 'failIfLocked'):
             self.failIfLocked()
 
diff --git a/Products/CMFPlone/MigrationTool.py b/Products/CMFPlone/MigrationTool.py
index ce53f6c..afb3754 100644
--- a/Products/CMFPlone/MigrationTool.py
+++ b/Products/CMFPlone/MigrationTool.py
@@ -53,16 +53,16 @@ def __repr__(self):
             self.__class__.__name__, self.profile_id)
 
     def safe(self):
-        """Is this addon safe to upgrade?
+        # Is this addon safe to upgrade?
 
-        Is it safe to pass its profile id to
-        portal_setup.upgradeProfile?  That method checks if the
-        profile is 'unknown' and in this case does nothing.
+        # Is it safe to pass its profile id to
+        # portal_setup.upgradeProfile?  That method checks if the
+        # profile is 'unknown' and in this case does nothing.
+
+        # But in some cases the profile may have been applied, but the
+        # package is gone.  For that case, you can set
+        # self.check_module.
 
-        But in some cases the profile may have been applied, but the
-        package is gone.  For that case, you can set
-        self.check_module.
-        """
         if self.check_module:
             # Can we import a module, as evidence that the code is
             # available?  Note that some modules may have been faked,
@@ -125,7 +125,7 @@ class MigrationTool(PloneBaseTool, UniqueObject, SimpleItem):
     security.declareProtected(ManagePortal, 'getInstanceVersion')
 
     def getInstanceVersion(self):
-        """ The version this instance of plone is on """
+        # The version this instance of plone is on.
         setup = getToolByName(self, 'portal_setup')
         version = setup.getLastVersionForProfile(_DEFAULT_PROFILE)
         if isinstance(version, tuple):
@@ -153,7 +153,7 @@ def getInstanceVersion(self):
     security.declareProtected(ManagePortal, 'setInstanceVersion')
 
     def setInstanceVersion(self, version):
-        """ The version this instance of plone is on """
+        # The version this instance of plone is on.
         setup = getToolByName(self, 'portal_setup')
         setup.setLastVersionForProfile(_DEFAULT_PROFILE, version)
         self._version = False
@@ -161,7 +161,7 @@ def setInstanceVersion(self, version):
     security.declareProtected(ManagePortal, 'getFileSystemVersion')
 
     def getFileSystemVersion(self):
-        """ The version this instance of plone is on """
+        # The version this instance of plone is on.
         setup = getToolByName(self, 'portal_setup')
         try:
             return setup.getVersionForProfile(_DEFAULT_PROFILE)
@@ -172,20 +172,20 @@ def getFileSystemVersion(self):
     security.declareProtected(ManagePortal, 'getSoftwareVersion')
 
     def getSoftwareVersion(self):
-        """ The software version."""
+        # The software version.
         dist = pkg_resources.get_distribution('Products.CMFPlone')
         return dist.version
 
     security.declareProtected(ManagePortal, 'needUpgrading')
 
     def needUpgrading(self):
-        """ Need upgrading? """
+        # Need upgrading?
         return self.getInstanceVersion() != self.getFileSystemVersion()
 
     security.declareProtected(ManagePortal, 'coreVersions')
 
     def coreVersions(self):
-        """ Useful core information """
+        # Useful core information.
         vars = {}
         get_dist = pkg_resources.get_distribution
         vars['Zope'] = get_dist('Zope2').version
@@ -217,7 +217,7 @@ def coreVersions(self):
     security.declareProtected(ManagePortal, 'coreVersionsList')
 
     def coreVersionsList(self):
-        """ Useful core information """
+        # Useful core information.
         res = self.coreVersions().items()
         res.sort()
         return res
@@ -225,19 +225,19 @@ def coreVersionsList(self):
     security.declareProtected(ManagePortal, 'needUpdateRole')
 
     def needUpdateRole(self):
-        """ Do roles need to be updated? """
+        # Do roles need to be updated?
         return self._needUpdateRole
 
     security.declareProtected(ManagePortal, 'needRecatalog')
 
     def needRecatalog(self):
-        """ Does this thing now need recataloging? """
+        # Does this thing now need recataloging?
         return self._needRecatalog
 
     security.declareProtected(ManagePortal, 'upgrade')
 
     def upgrade(self, REQUEST=None, dry_run=None, swallow_errors=True):
-        """ perform the upgrade """
+        # Perform the upgrade.
         setup = getToolByName(self, 'portal_setup')
 
         # This sets the profile version if it wasn't set yet
diff --git a/Products/CMFPlone/PloneBatch.py b/Products/CMFPlone/PloneBatch.py
index 48b396e..bc05dfa 100644
--- a/Products/CMFPlone/PloneBatch.py
+++ b/Products/CMFPlone/PloneBatch.py
@@ -37,14 +37,14 @@ def initialize(self, start, end, size):
             calculate_pagerange(self.pagenumber, self.numpages, self.pagerange)
 
     def pageurl(self, formvariables, pagenumber=-1):
-        """ Makes the url for a given page """
+        # Makes the url for a given page.
         if pagenumber == -1:
             pagenumber = self.pagenumber
         b_start = pagenumber * (self.pagesize - self.overlap) - self.pagesize
         return make_query(formvariables, {self.b_start_str: b_start})
 
     def navurls(self, formvariables, navlist=None):
-        """ Returns the page number and url for the navigation quick links """
+        # Returns the page number and url for the navigation quick links.
         if navlist is None:
             navlist = []
         if not navlist:
@@ -53,11 +53,11 @@ def navurls(self, formvariables, navlist=None):
                    (x, self.pageurl(formvariables, x)), navlist)
 
     def prevurls(self, formvariables):
-        """ Helper method to get prev navigation list from templates """
+        # Helper method to get prev navigation list from templates.
         return self.navurls(formvariables, self.previous_pages)
 
     def nexturls(self, formvariables):
-        """ Helper method to get next navigation list from templates """
+        # Helper method to get next navigation list from templates.
         return self.navurls(formvariables, self.next_pages)
 
     prevlist = QuantumBatch.previous_pages
diff --git a/Products/CMFPlone/PloneControlPanel.py b/Products/CMFPlone/PloneControlPanel.py
index c939db7..73ccf97 100644
--- a/Products/CMFPlone/PloneControlPanel.py
+++ b/Products/CMFPlone/PloneControlPanel.py
@@ -164,8 +164,7 @@ def unregisterApplication(self, appId):
         self.deleteActions(selection)
 
     def _extractAction(self, properties, index):
-        """ Extract an ActionInformation from the funky form properties.
-        """
+        # Extract an ActionInformation from the funky form properties.
         id = str(properties.get('id_%d' % index, ''))
         name = str(properties.get('name_%d' % index, ''))
         action = str(properties.get('action_%d' % index, ''))
@@ -225,8 +224,7 @@ def addAction(self,
                   description='',
                   REQUEST=None,
                   ):
-        """ Add an action to our list.
-        """
+        # Add an action to our list.
         if not name:
             raise ValueError('A name is required.')
 
diff --git a/Products/CMFPlone/PloneFolder.py b/Products/CMFPlone/PloneFolder.py
index c0a64d1..84f8eca 100644
--- a/Products/CMFPlone/PloneFolder.py
+++ b/Products/CMFPlone/PloneFolder.py
@@ -61,7 +61,7 @@ def moveObject(self, id, position):
     security.declarePrivate('getIdsSubset')
 
     def getIdsSubset(self, objs):
-        """Get the ids of only cmf objects (used for moveObjectsByDelta)."""
+        # Get the ids of only cmf objects (used for moveObjectsByDelta).
         ttool = getToolByName(self, 'portal_types')
         cmf_meta_types = [ti.Metatype() for ti in ttool.listTypeInfo()]
         return [obj['id'] for obj in objs
@@ -195,7 +195,7 @@ def __browser_default__(self, request):
     security.declarePublic('contentValues')
 
     def contentValues(self, filter=None, sort_on=None, reverse=0):
-        """Able to sort on field."""
+        # Able to sort on field.
         values = PortalFolderBase.contentValues(self, filter=filter)
         if sort_on is not None:
             values.sort(lambda x, y,
@@ -210,9 +210,8 @@ def contentValues(self, filter=None, sort_on=None, reverse=0):
 
     def listFolderContents(self, contentFilter=None,
                            suppressHiddenFiles=0):
-        """Optionally you can suppress "hidden" files, or files that
-        begin with .
-        """
+        # Optionally you can suppress "hidden" files, or files that
+        # begin with '.'
         contents = PortalFolderBase.listFolderContents(self,
                                                        contentFilter=contentFilter)
         if suppressHiddenFiles:
@@ -224,9 +223,8 @@ def listFolderContents(self, contentFilter=None,
 
     def folderlistingFolderContents(self, contentFilter=None,
                                     suppressHiddenFiles=0):
-        """Calls listFolderContents in protected only by ACI so that
-        folder_listing can work without the List folder contents permission
-        """
+        # Calls listFolderContents in protected only by ACI so that
+        # folder_listing can work without the List folder contents permission.
         return self.listFolderContents(contentFilter, suppressHiddenFiles)
 
     # Override CMFCore's invokeFactory to return the id returned by the
@@ -234,7 +232,7 @@ def folderlistingFolderContents(self, contentFilter=None,
     security.declareProtected(AddPortalContent, 'invokeFactory')
 
     def invokeFactory(self, type_name, id, RESPONSE=None, *args, **kw):
-        """Invokes the portal_types tool."""
+        # Invokes the portal_types tool.
         pt = getToolByName(self, 'portal_types')
         myType = pt.getTypeInfo(self)
         if myType is not None:
diff --git a/Products/CMFPlone/PloneTool.py b/Products/CMFPlone/PloneTool.py
index 5e59bc4..84152cf 100644
--- a/Products/CMFPlone/PloneTool.py
+++ b/Products/CMFPlone/PloneTool.py
@@ -160,9 +160,8 @@ def getMailHost(self):
 
     @security.public
     def validateSingleNormalizedEmailAddress(self, address):
-        """Lower-level function to validate a single normalized email address,
-        see validateEmailAddress.
-        """
+        # Lower-level function to validate a single normalized email address,
+        # see validateEmailAddress.
         if not isinstance(address, basestring):
             return False
 
@@ -179,7 +178,7 @@ def validateSingleNormalizedEmailAddress(self, address):
 
     @security.public
     def validateSingleEmailAddress(self, address):
-        """Validate a single email address, see also validateEmailAddresses."""
+        # Validate a single email address, see also validateEmailAddresses.
         if not isinstance(address, basestring):
             return False
 
@@ -201,9 +200,8 @@ def validateSingleEmailAddress(self, address):
 
     @security.public
     def validateEmailAddresses(self, addresses):
-        """Validate a list of possibly several email addresses, see also
-        validateSingleEmailAddress.
-        """
+        # Validate a list of possibly several email addresses, see also
+        # validateSingleEmailAddress.
         if not isinstance(addresses, basestring):
             return False
 
@@ -224,10 +222,8 @@ def editMetadata(self, obj, allowDiscussion=None, title=None,
                      subject=None, description=None, contributors=None,
                      effective_date=None, expiration_date=None, format=None,
                      language=None, rights=None, **kwargs):
-        """Responsible for setting metadata on a content object.
-
-        We assume the obj implements IDublinCoreMetadata.
-        """
+        # Responsible for setting metadata on a content object.
+        # We assume the obj implements IDublinCoreMetadata.
         mt = getToolByName(self, 'portal_membership')
         if not mt.checkPermission(ModifyPortalContent, obj):
             # FIXME: Some scripts rely on this being string?
@@ -313,7 +309,7 @@ def _makeTransactionNote(self, obj, msg=''):
 
     @security.public
     def contentEdit(self, obj, **kwargs):
-        """Encapsulates how the editing of content occurs."""
+        # Encapsulates how the editing of content occurs.
         try:
             self.editMetadata(obj, **kwargs)
         except AttributeError, msg:
@@ -325,18 +321,15 @@ def contentEdit(self, obj, **kwargs):
 
     @security.public
     def availableMIMETypes(self):
-        """Returns a map of mimetypes.
-
-        Requires mimetype registry from Archetypes >= 1.3.
-        """
+        # Returns a map of mimetypes.
+        # Requires mimetype registry from Archetypes >= 1.3.
         mtr = getToolByName(self, 'mimetypes_registry')
         return mtr.list_mimetypes()
 
     @security.protected(View)
     def getWorkflowChainFor(self, object):
-        """Proxy the request for the chain to the workflow tool, as
-        this method is private there.
-        """
+        # Proxy the request for the chain to the workflow tool, as
+        # this method is private there.
         wftool = getToolByName(self, 'portal_workflow')
         wfs = ()
         try:
@@ -349,8 +342,7 @@ def getWorkflowChainFor(self, object):
 
     @security.protected(View)
     def getIconFor(self, category, id, default=_marker, context=None):
-        """Get an icon for an action, from its icon_expr.
-        """
+        # Get an icon for an action, from its icon_expr.
         if context is None:
             context = aq_parent(self)
         action_chain = '%s/%s' % (category, id)
@@ -498,21 +490,18 @@ def exceptionString(self):
     # Provide a way of dumping an exception to the log even if we
     # catch it and otherwise ignore it
     def logException(self):
-        """Dumps most recent exception to the log.
-        """
+        # Dumps most recent exception to the log.
         log_exc()
 
     @security.public
     def createSitemap(self, context, request=None):
-        """Returns a sitemap navtree structure.
-        """
+        # Returns a sitemap navtree structure.
         if request is None:
             request = self.REQUEST
         return utils.createSiteMap(context, request)
 
     def _addToNavTreeResult(self, result, data):
-        """Adds a piece of content to the result tree.
-        """
+        # Adds a piece of content to the result tree.
         return utils.addToNavTreeResult(result, data)
 
     @security.protected(AccessContentsInformation)
@@ -521,15 +510,14 @@ def typesToList(self):
 
     @security.public
     def createBreadCrumbs(self, context, request=None):
-        """Returns a structure for the portal breadcumbs.
-        """
+        # Returns a structure for the portal breadcumbs.
         if request is None:
             request = self.REQUEST
         return utils.createBreadCrumbs(context, request)
 
     @security.public
     def good_id(self, id):
-        """Exposes ObjectManager's bad_id test to skin scripts."""
+        # Exposes ObjectManager's bad_id test to skin scripts.
         m = bad_id(id)
         if m is not None:
             return 0
@@ -537,12 +525,12 @@ def good_id(self, id):
 
     @security.public
     def bad_chars(self, id):
-        """Returns a list of the Bad characters."""
+        # Returns a list of the Bad characters.
         return BAD_CHARS(id)
 
     @security.public
     def getInheritedLocalRoles(self, context):
-        """Returns a tuple with the acquired local roles."""
+        # Returns a tuple with the acquired local roles.
         portal = getToolByName(context, 'portal_url').getPortalObject()
         result = []
         cont = 1
@@ -596,21 +584,19 @@ def getInheritedLocalRoles(self, context):
 
     @security.public
     def isDefaultPage(self, obj, request=None):
-        """Finds out if the given obj is the default page in its parent folder.
-        Uses the lookup rules of Plone.  Lookup happens over a view, for which
-        in theory a different implementation may exist.
-        """
+        # Finds out if the given obj is the default page in its parent folder.
+        # Uses the lookup rules of Plone.  Lookup happens over a view, for which
+        # in theory a different implementation may exist.
         if request is None:
             request = self.REQUEST
         return check_default_page_via_view(obj, request)
 
     @security.public
     def getDefaultPage(self, obj, request=None):
-        """Given a folderish item, find out if it has a default-page using
-        the lookup rules of Plone (see Products.CMFPlone/defaultpage.py).
-        Lookup happens over a view, for which in theory a different
-        implementation may be used.
-        """
+        # Given a folderish item, find out if it has a default-page using
+        # the lookup rules of Plone (see Products.CMFPlone/defaultpage.py).
+        # Lookup happens over a view, for which in theory a different
+        # implementation may be used.
         if request is None:
             if hasattr(self, 'REQUEST'):
                 request = self.REQUEST
@@ -658,14 +644,11 @@ def addPortalMessage(self, message, type='info', request=None):
 
     @security.public
     def showPortalMessages(self, request=None):
-        """\
-        Return portal status messages that will be displayed when the
-        response web page is rendered. Portal status messages are by default
-        rendered by the global_statusmessage.pt page template. They will be
-        removed after they have been shown.
-
-        See addPortalMessages for examples.
-        """
+        # Return portal status messages that will be displayed when the
+        # response web page is rendered. Portal status messages are by default
+        # rendered by the global_statusmessage.pt page template. They will be
+        # removed after they have been shown.
+        # See addPortalMessages for examples.
         if request is None:
             request = self.REQUEST
         return IStatusMessage(request).show()
@@ -841,12 +824,10 @@ def isStructuralFolder(self, obj):
 
     @security.public
     def acquireLocalRoles(self, obj, status=1, REQUEST=None):
-        """If status is 1, allow acquisition of local roles (regular
-        behaviour).
-
-        If it's 0, prohibit it (it will allow some kind of local role
-        blacklisting).
-        """
+        # If status is 1, allow acquisition of local roles (regular
+        # behaviour).
+        # If it's 0, prohibit it (it will allow some kind of local role
+        # blacklisting).
         mt = getToolByName(self, 'portal_membership')
         if not mt.checkPermission(ModifyPortalContent, obj):
             raise Unauthorized
@@ -865,10 +846,8 @@ def acquireLocalRoles(self, obj, status=1, REQUEST=None):
 
     @security.public
     def isLocalRoleAcquired(self, obj):
-        """Returns local role acquisition blocking status.
-
-        True if normal, false if blocked.
-        """
+        # Returns local role acquisition blocking status.
+        # True if normal, false if blocked.
         if getattr(obj, '__ac_local_roles_block__', None):
             return False
         return True
@@ -947,10 +926,8 @@ def normalizeString(self, text):
 
     @security.public
     def listMetaTags(self, context):
-        """Lists meta tags helper.
-
-        Creates a mapping of meta tags -> values for the listMetaTags script.
-        """
+        # Lists meta tags helper.
+        # Creates a mapping of meta tags -> values for the listMetaTags script.
         result = {}
         mt = getToolByName(self, 'portal_membership')
 
@@ -1066,15 +1043,15 @@ def listMetaTags(self, context):
 
     @security.public
     def getUserFriendlyTypes(self, typesList=None):
-        """Get a list of types which are considered "user friendly" for search
-        and selection purposes.
-
-        This is the list of types available in the portal, minus those defined
-        in the types_not_searched property in site_properties, if it exists.
-
-        If typesList is given, this is used as the base list; else all types
-        from portal_types are used.
-        """
+        # Get a list of types which are considered "user friendly" for search
+        # and selection purposes.
+        #
+        # This is the list of types available in the portal, minus those
+        # defined in the types_not_searched property in site_properties, if it
+        # exists.
+        #
+        # If typesList is given, this is used as the base list; else all types
+        # from portal_types are used.
         if typesList is None:
             typesList = []
         registry = getUtility(IRegistry)
@@ -1093,13 +1070,13 @@ def getUserFriendlyTypes(self, typesList=None):
 
     @security.public
     def reindexOnReorder(self, parent):
-        """ reindexing of "gopip" isn't needed any longer,
-        but some extensions might need the info anyway :("""
+        # Reindexing of "gopip" isn't needed any longer,
+        # but some extensions might need the info anyway. :(
         notify(ReorderedEvent(parent))
 
     @security.public
     def isIDAutoGenerated(self, id):
-        """Determine if an id is autogenerated"""
+        # Determine if an id is autogenerated.
         return utils.isIDAutoGenerated(self, id)
 
     @security.public
@@ -1115,17 +1092,16 @@ def getEmptyTitle(self, translated=True):
 
     @security.public
     def pretty_title_or_id(self, obj, empty_value=_marker):
-        """Return the best possible title or id of an item, regardless
-        of whether obj is a catalog brain or an object, but returning an
-        empty title marker if the id is not set (i.e. it's auto-generated).
-        """
+        # Return the best possible title or id of an item, regardless
+        # of whether obj is a catalog brain or an object, but returning an
+        # empty title marker if the id is not set (i.e. it's auto-generated).
         return utils.pretty_title_or_id(self, obj, empty_value=empty_value)
 
     @security.public
     def getMethodAliases(self, typeInfo):
-        """Given an FTI, return the dict of method aliases defined on that
-        FTI. If there are no method aliases (i.e. this FTI doesn't support it),
-        return None"""
+        # Given an FTI, return the dict of method aliases defined on that
+        # FTI. If there are no method aliases (i.e. this FTI doesn't support
+        # it), return None.
         getMethodAliases = getattr(typeInfo, 'getMethodAliases', None)
         if getMethodAliases is not None \
                 and utils.safe_callable(getMethodAliases):
diff --git a/Products/CMFPlone/Portal.py b/Products/CMFPlone/Portal.py
index d4ad75f..92133cc 100644
--- a/Products/CMFPlone/Portal.py
+++ b/Products/CMFPlone/Portal.py
@@ -101,7 +101,7 @@ def index_html(self):
     index_html = ComputedAttribute(index_html, 1)
 
     def manage_beforeDelete(self, container, item):
-        """ Should send out an Event before Site is being deleted """
+        # Should send out an Event before Site is being deleted.
         self.removal_inprogress = 1
         PloneSite.inheritedAttribute('manage_beforeDelete')(self, container,
                                                             item)
@@ -151,8 +151,7 @@ def availableLanguages(self):
         return languages
 
     def isEffective(self, date):
-        """ Override DefaultDublinCoreImpl's test, since we are always viewable.
-        """
+        # Override DefaultDublinCoreImpl's test, since we are always viewable.
         return 1
 
     # Ensure portals don't get cataloged.
diff --git a/Products/CMFPlone/PropertiesTool.py b/Products/CMFPlone/PropertiesTool.py
index 6450cba..0acbe9e 100644
--- a/Products/CMFPlone/PropertiesTool.py
+++ b/Products/CMFPlone/PropertiesTool.py
@@ -55,8 +55,7 @@ def all_meta_types(self, interfaces=None):
     security.declareProtected(ManagePortal, 'addPropertySheet')
 
     def addPropertySheet(self, id, title='', propertysheet=None):
-        """ Add a new PropertySheet
-        """
+        # Add a new PropertySheet.
         o = SimpleItemWithProperties(id, title)
 
         # copy the propertysheet values onto the new instance
@@ -91,8 +90,7 @@ def manage_addPropertySheet(self, id, title='',
     security.declareProtected(ManagePortal, 'editProperties')
 
     def editProperties(self, props):
-        """Change portal settings
-        """
+        # Change portal settings.
         aq_parent(aq_inner(self)).manage_changeProperties(props)
         if hasattr(self, 'propertysheets'):
             ps = self.propertysheets
diff --git a/Products/CMFPlone/QuickInstallerTool.py b/Products/CMFPlone/QuickInstallerTool.py
index c04f8d6..700364c 100644
--- a/Products/CMFPlone/QuickInstallerTool.py
+++ b/Products/CMFPlone/QuickInstallerTool.py
@@ -20,9 +20,8 @@ class QuickInstallerTool(PloneBaseTool, BaseTool):
     security.declareProtected(ManagePortal, 'upgradeInfo')
 
     def upgradeInfo(self, pid):
-        """Returns a dict with two booleans values, stating if an upgrade
-        is required and available.
-        """
+        # Returns a dict with two booleans values, stating if an upgrade
+        # required and available.
         available = self.isProductAvailable(pid)
         if not available:
             return False
diff --git a/Products/CMFPlone/RegistrationTool.py b/Products/CMFPlone/RegistrationTool.py
index ca8108b..d1babb7 100644
--- a/Products/CMFPlone/RegistrationTool.py
+++ b/Products/CMFPlone/RegistrationTool.py
@@ -152,7 +152,7 @@ def getPassword(self, length=5, s=None):
     security.declarePublic('isValidEmail')
 
     def isValidEmail(self, email):
-        """ checks for valid email """
+        # Checks for valid email.
         if EMAIL_RE.search(email) == None:
             return 0
         try:
@@ -168,11 +168,10 @@ def isValidEmail(self, email):
     security.declarePublic('testPasswordValidity')
 
     def testPasswordValidity(self, password, confirm=None):
-        """ Verify that the password satisfies the portal's requirements.
-
-        o If the password is valid, return None.
-        o If not, return a string explaining why.
-        """
+        # Verify that the password satisfies the portal's requirements.
+        #
+        # o If the password is valid, return None.
+        # o If not, return a string explaining why.
         err = self.pasValidation('password', password)
         if err and (password == '' or not _checkPermission(ManagePortal, self)):
             return err
@@ -183,7 +182,7 @@ def testPasswordValidity(self, password, confirm=None):
         return None
 
     def pasValidation(self, property, password):
-        """ @return None if no PAS password validators exist or a list of errors """
+        # @return None if no PAS password validators exist or a list of errors.
         portal = getUtility(ISiteRoot)
         pas_instance = portal.acl_users
         validators = pas_instance.plugins.listPlugins(IValidationPlugin)
@@ -214,13 +213,13 @@ def pasValidation(self, property, password):
     security.declarePublic('testPropertiesValidity')
 
     def testPropertiesValidity(self, props, member=None):
-        """ Verify that the properties supplied satisfy portal's requirements.
+        # Verify that the properties supplied satisfy portal's requirements.
 
-        o If the properties are valid, return None.
-        o If not, return a string explaining why.
+        # o If the properties are valid, return None.
+        # o If not, return a string explaining why.
+
+        # We also check if the email property is writable before verifying it.
 
-        We also check if the email property is writable before verifying it.
-        """
         if member is None:  # New member.
 
             username = props.get('username', '')
@@ -305,16 +304,16 @@ def isMemberIdAllowed(self, id):
     security.declarePublic('generatePassword')
 
     def generatePassword(self):
-        """Generate a strong default password. The user never gets sent
-        this so we can make it very long."""
+        # Generate a strong default password. The user never gets sent
+        # this so we can make it very long.
 
         return self.getPassword(56)
 
     security.declarePublic('generateResetCode')
 
     def generateResetCode(self, salt, length=14):
-        """Generates a reset code which is guaranteed to return the
-        same value for a given length and salt, every time."""
+        # Generates a reset code which is guaranteed to return the
+        # same value for a given length and salt, every time.
         return self.getPassword(length, salt)
 
     security.declarePublic('mailPassword')
@@ -398,7 +397,7 @@ def mailPassword(self, login, REQUEST, immediate=False):
     security.declarePublic('registeredNotify')
 
     def registeredNotify(self, new_member_id):
-        """ Wrapper around registeredNotify """
+        # Wrapper around registeredNotify.
         membership = getToolByName(self, 'portal_membership')
         utils = getToolByName(self, 'plone_utils')
         member = membership.getMemberById(new_member_id)
diff --git a/Products/CMFPlone/SkinsTool.py b/Products/CMFPlone/SkinsTool.py
index f9dc8aa..6cb1cdd 100644
--- a/Products/CMFPlone/SkinsTool.py
+++ b/Products/CMFPlone/SkinsTool.py
@@ -20,8 +20,7 @@ class SkinsTool(PloneBaseTool, BaseTool):
     security.declareProtected(ManagePortal, 'addSkinSelection')
 
     def addSkinSelection(self, skinname, skinpath, test=0, make_default=0):
-        """ adds a skin selection
-        """
+        # Adds a skin selection.
         super(SkinsTool, self).addSkinSelection(skinname, skinpath,
                                                 test=test, make_default=make_default)
         # when adding a new skin, we need to tell RR about it
diff --git a/Products/CMFPlone/TypesTool.py b/Products/CMFPlone/TypesTool.py
index 5fe4de9..88bdef2 100644
--- a/Products/CMFPlone/TypesTool.py
+++ b/Products/CMFPlone/TypesTool.py
@@ -17,7 +17,7 @@ class TypesTool(PloneBaseTool, BaseTool):
     security.declarePublic('listTypeTitles')
 
     def listTypeTitles(self, container=None):
-        """ Return a dictionary of id/Title combinations """
+        # Return a dictionary of id/Title combinations.
         typenames = {}
         for t in self.listTypeInfo(container):
             name = t.getId()
@@ -29,8 +29,7 @@ def listTypeTitles(self, container=None):
     security.declarePrivate('listActions')
 
     def listActions(self, info=None, object=None, category=None):
-        """ List all the actions defined by a provider.
-        """
+        # List all the actions defined by a provider.
         actions = []
         if object is None and info is not None:
             object = info.object
diff --git a/Products/CMFPlone/URLTool.py b/Products/CMFPlone/URLTool.py
index eb38ece..13cc40a 100644
--- a/Products/CMFPlone/URLTool.py
+++ b/Products/CMFPlone/URLTool.py
@@ -19,17 +19,17 @@ class URLTool(PloneBaseTool, BaseTool):
     security.declarePublic('isURLInPortal')
 
     def isURLInPortal(self, url, context=None):
-        """ Check if a given url is on the same host and contains the portal
-            path.  Used to ensure that login forms can determine relevant
-            referrers (i.e. in portal).  Also return true for some relative
-            urls if context is passed in to allow for url parsing. When context
-            is not provided, assume that relative urls are in the portal. It is
-            assumed that http://portal is the same portal as https://portal.
+        # Check if a given url is on the same host and contains the portal
+        # path.  Used to ensure that login forms can determine relevant
+        # referrers (i.e. in portal).  Also return true for some relative
+        # urls if context is passed in to allow for url parsing. When context
+        # is not provided, assume that relative urls are in the portal. It is
+        # assumed that http://portal is the same portal as https://portal.
+
+        # External sites listed in 'allow_external_login_sites' of
+        # site_properties are also considered within the portal to allow for
+        # single sign on.
 
-            External sites listed in 'allow_external_login_sites' of
-            site_properties are also considered within the portal to allow for
-            single sign on.
-        """
         # sanitize url
         url = re.sub('^[\x00-\x20]+', '', url).strip()
         if ('<script' in url or '%3Cscript' in url or 'javascript:' in url or
diff --git a/Products/CMFPlone/WorkflowTool.py b/Products/CMFPlone/WorkflowTool.py
index 5527f96..de911f2 100644
--- a/Products/CMFPlone/WorkflowTool.py
+++ b/Products/CMFPlone/WorkflowTool.py
@@ -23,7 +23,7 @@ class WorkflowTool(PloneBaseTool, BaseTool):
     # TODO this should not make it into 1.0
     # Refactor me, my maker was tired
     def flattenTransitions(self, objs, container=None):
-        """ this is really hokey - hold on!!"""
+        # This is really hokey - hold on!!
         if hasattr(objs, 'startswith'):
             return ()
 
@@ -52,7 +52,7 @@ def flattenTransitions(self, objs, container=None):
         return tuple(transitions[:])
 
     def flattenTransitionsForPaths(self, paths):
-        """ this is even more hokey!!"""
+        # This is even more hokey!!
         if hasattr(paths, 'startswith'):
             return ()
 
@@ -108,9 +108,8 @@ def getTransitionsFor(self, obj=None, container=None, REQUEST=None):
         return tuple(result.values())
 
     def workflows_in_use(self):
-        """ gathers all the available workflow chains (sequence
-        of workflow ids).
-        """
+        # Gathers all the available workflow chains (sequence
+        # of workflow ids).
         in_use = []
 
         in_use.append(self._default_chain)
@@ -124,17 +123,17 @@ def workflows_in_use(self):
     security.declarePublic('getWorklists')
 
     def getWorklists(self):
-        """ instead of manually scraping actions_box, lets:
-            query for all worklists in all workflow definitions.
-            Returns a dictionary whos value is sequence of dictionaries
-
-            i.e. map[workflow_id]=(workflow definition map, )
-            each workflow defintion map contains the following:
-            (worklist)id, guard (Guard instance), guard_permissions (permission
-            of Guard instance), guard_roles (roles of Guard instance),
-            catalog_vars (mapping), actbox_name (actions box label),
-            actbox_url (actions box url) and types (list of portal types)
-        """
+        # Instead of manually scraping actions_box, let's
+        # query for all worklists in all workflow definitions.
+        # Returns a dictionary whose value is a sequence of dictionaries.
+
+        # i.e. map[workflow_id]=(workflow definition map, )
+        # each workflow defintion map contains the following:
+        # (worklist)id, guard (Guard instance), guard_permissions (permission
+        # of Guard instance), guard_roles (roles of Guard instance),
+        # catalog_vars (mapping), actbox_name (actions box label),
+        # actbox_url (actions box url) and types (list of portal types)
+
         # We want to know which types use the workflows with worklists
         # This for example avoids displaying 'pending' of multiple workflows in
         # the same worklist
@@ -189,13 +188,12 @@ def getWorklists(self):
     security.declarePublic('getWorklistsResults')
 
     def getWorklistsResults(self):
-        """Return all the objects concerned by one or more worklists
-
-        This method replace 'getWorklists' by implementing the whole worklists
-        work for the script.
-        An object is returned only once, even if is return by several
-        worklists. Make the whole work as expensive it is.
-        """
+        # Return all the objects concerned by one or more worklists.
+        #
+        # This method replace 'getWorklists' by implementing the whole
+        # worklists work for the script.  An object is returned only once, even
+        # if is return by several worklists. Make the whole work as expensive
+        # it is.
         sm = getSecurityManager()
         # We want to know which types use the workflows with worklists
         # This for example avoids displaying 'pending' of multiple workflows in
@@ -249,8 +247,7 @@ def getWorklistsResults(self):
     security.declareProtected(ManagePortal, 'getChainForPortalType')
 
     def getChainForPortalType(self, pt_name, managescreen=0):
-        """ Get a chain for a specific portal type.
-        """
+        # Get a chain for a specific portal type.
         if pt_name in self._chains_by_type:
             return self._chains_by_type[pt_name]
         else:
@@ -264,16 +261,14 @@ def getChainForPortalType(self, pt_name, managescreen=0):
     security.declareProtected(ManagePortal, 'listWorkflows')
 
     def listWorkflows(self):
-        """ Return the list of workflows
-        """
+        # Return the list of workflows.
         return self.keys()
 
     security.declarePublic('getTitleForStateOnType')
 
     def getTitleForStateOnType(self, state_name, p_type):
-        """Returns the workflow state title for a given state name,
-           uses a portal_type to determine which workflow to use
-        """
+        # Returns the workflow state title for a given state name,
+        # uses a portal_type to determine which workflow to use.
         if state_name and p_type is not None:
             chain = self.getChainForPortalType(p_type)
             for wf_id in chain:
@@ -289,9 +284,8 @@ def getTitleForStateOnType(self, state_name, p_type):
     security.declarePublic('getTitleForTransitionOnType')
 
     def getTitleForTransitionOnType(self, trans_name, p_type):
-        """Returns the workflow transition title for a given transition name,
-           uses a portal_type to determine which workflow to use
-        """
+        # Returns the workflow transition title for a given transition name,
+        # uses a portal_type to determine which workflow to use.
         if trans_name and p_type is not None:
             chain = self.getChainForPortalType(p_type)
             for wf_id in chain:
@@ -307,8 +301,8 @@ def getTitleForTransitionOnType(self, trans_name, p_type):
     security.declarePublic('listWFStatesByTitle')
 
     def listWFStatesByTitle(self, filter_similar=False):
-        """Returns the states of all available workflows, optionally filtering
-           out states with matching title and id"""
+        # Returns the states of all available workflows, optionally filtering
+        # out states with matching title and id.
         states = []
         dup_list = {}
         for wf in self.values():
@@ -326,11 +320,9 @@ def listWFStatesByTitle(self, filter_similar=False):
 
     # PLIP 217 Workflow by adaptation
     def getChainFor(self, ob):
-        """
-        Returns the chain that applies to the given object.
-        If we get a string as the ob parameter, use it as
-        the portal_type.
-        """
+        # Returns the chain that applies to the given object.
+        # If we get a string as the ob parameter, use it as
+        # the portal_type.
         return getMultiAdapter((ob, self), IWorkflowChain)
 
     security.declarePrivate('listActions')
diff --git a/Products/CMFPlone/tests/testSecurity.py b/Products/CMFPlone/tests/testSecurity.py
index 1e25d5e..e31e15c 100644
--- a/Products/CMFPlone/tests/testSecurity.py
+++ b/Products/CMFPlone/tests/testSecurity.py
@@ -78,8 +78,7 @@ def test_widget_traversal_2(self):
     def test_registerConfiglet_1(self):
         VECTOR = "/plone/portal_controlpanel/registerConfiglet?id=cake&name=Cakey&action=woo&permission=View&icon_expr="
         res = self.publish(VECTOR)
-        self.assertTrue(res.headers['location'].startswith(
-            'http://nohost/plone/acl_users/credentials_cookie_auth/require_login'))
+        self.assertEqual(404, res.status)
 
     def test_registerConfiglet_2(self):
         VECTOR = "/plone/portal_controlpanel/registerConfiglet?id=cake&name=Cakey&action=woo&permission=View&icon_expr="
diff --git a/Products/CMFPlone/utils.py b/Products/CMFPlone/utils.py
index 60c51ab..4ffbb75 100644
--- a/Products/CMFPlone/utils.py
+++ b/Products/CMFPlone/utils.py
@@ -266,7 +266,7 @@ def getIcon(self, context, path):
         return icon
 
     def initialize(self, context):
-        """ Wrap the CMFCore Tool Init method """
+        # Wrap the CMFCore Tool Init method.
         CMFCoreToolInit.initialize(self, context)
         for tool in self.tools:
             # Get the icon path from the tool


