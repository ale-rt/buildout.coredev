Repository: five.intid


Branch: refs/heads/master
Date: 2016-08-10T14:19:38+02:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/five.intid/commit/513ca3ca0c1581d334dca96395ecff36c5eb320a

Set the key to None when a NotYet error is raised

Files changed:
M CHANGES.rst
M five/intid/intid.py

diff --git a/CHANGES.rst b/CHANGES.rst
index f0db4d0..09f0f24 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -13,6 +13,10 @@ Fixes:
 - Acquisition-unwrap each item in the aq_iter chain, as ``getSite().__parent__`` might return an object aquired from the original context which breaks the parent loop detection.
   [thet]
 
+- Prevent errors on ``moveIntIdSubscriber`` when the ``IKeyReference`` adapter
+  raises a ``NotYet``, e.g. because the object does not have a proper path.
+  [ale-rt]
+
 
 1.1.0 (2016-02-14)
 ------------------
diff --git a/five/intid/intid.py b/five/intid/intid.py
index 407586d..074e08a 100644
--- a/five/intid/intid.py
+++ b/five/intid/intid.py
@@ -138,7 +138,10 @@ def moveIntIdSubscriber(ob, event):
     utilities = tuple(getAllUtilitiesRegisteredFor(IIntIds))
     if not utilities:
         return
-    key = IKeyReference(ob, None)
+    try:
+        key = IKeyReference(ob, None)
+    except NotYet:
+        key = None
 
     # Register only objects that adapt to key reference
     if key is None:


Repository: five.intid


Branch: refs/heads/master
Date: 2016-08-16T23:33:28-03:00
Author: Franco Pellegrini (frapell) <frapell@gmail.com>
Commit: https://github.com/plone/five.intid/commit/c701edace4cc05d531f9736d34ee4ab6b32b0b4a

Merge pull request #2 from plone/fix-not-yet

Set the key to None when a NotYet error is raised

Files changed:
M CHANGES.rst
M five/intid/intid.py

diff --git a/CHANGES.rst b/CHANGES.rst
index f0db4d0..09f0f24 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -13,6 +13,10 @@ Fixes:
 - Acquisition-unwrap each item in the aq_iter chain, as ``getSite().__parent__`` might return an object aquired from the original context which breaks the parent loop detection.
   [thet]
 
+- Prevent errors on ``moveIntIdSubscriber`` when the ``IKeyReference`` adapter
+  raises a ``NotYet``, e.g. because the object does not have a proper path.
+  [ale-rt]
+
 
 1.1.0 (2016-02-14)
 ------------------
diff --git a/five/intid/intid.py b/five/intid/intid.py
index 407586d..074e08a 100644
--- a/five/intid/intid.py
+++ b/five/intid/intid.py
@@ -138,7 +138,10 @@ def moveIntIdSubscriber(ob, event):
     utilities = tuple(getAllUtilitiesRegisteredFor(IIntIds))
     if not utilities:
         return
-    key = IKeyReference(ob, None)
+    try:
+        key = IKeyReference(ob, None)
+    except NotYet:
+        key = None
 
     # Register only objects that adapt to key reference
     if key is None:


