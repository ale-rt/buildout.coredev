Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2016-04-29T00:54:24+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.Archetypes/commit/b13275c0a854b574f2992425a75467705bdff39e

Removed ``error_log`` from ``toolset.xml``.

This is already in the toolset of ``Products.CMFPlone``.

Files changed:
M CHANGES.rst
M Products/Archetypes/profiles/default/toolset.xml

diff --git a/CHANGES.rst b/CHANGES.rst
index 2d16129..23ad954 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,8 @@ Incompatibilities:
 
 New:
 
-- *add item here*
+- Removed ``error_log`` from ``toolset.xml``, because this is already
+  in the toolset of ``Products.CMFPlone``.   [maurits]
 
 Fixes:
 
diff --git a/Products/Archetypes/profiles/default/toolset.xml b/Products/Archetypes/profiles/default/toolset.xml
index f266a00..31642b1 100644
--- a/Products/Archetypes/profiles/default/toolset.xml
+++ b/Products/Archetypes/profiles/default/toolset.xml
@@ -1,7 +1,5 @@
 <?xml version="1.0"?>
 <tool-setup>
-  <required tool_id="error_log"
-    class="Products.SiteErrorLog.SiteErrorLog.SiteErrorLog"/>
   <required tool_id="archetype_tool"
     class="Products.Archetypes.ArchetypeTool"/>
   <required tool_id="reference_catalog"


Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2016-04-29T00:57:15+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.Archetypes/commit/656544389e2f296290a7d75166909666bbd2be1c

Added uninstall profile.

Most importantly this removes the ``archetype_tool``,
``reference_catalog``, and ``uid_catalog``.
Needs GenericSetup 1.8.3.

Files changed:
A Products/Archetypes/profiles/uninstall/registry.xml
A Products/Archetypes/profiles/uninstall/skins.xml
A Products/Archetypes/profiles/uninstall/toolset.xml
M CHANGES.rst
M Products/Archetypes/profiles.zcml
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 23ad954..b5d35d8 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,6 +10,11 @@ Incompatibilities:
 
 New:
 
+- Added uninstall profile.  Most importantly this removes the
+  ``archetype_tool``, ``reference_catalog``, and ``uid_catalog``.
+  Needs Products.GenericSetup 1.8.3.
+  [maurits]
+
 - Removed ``error_log`` from ``toolset.xml``, because this is already
   in the toolset of ``Products.CMFPlone``.   [maurits]
 
diff --git a/Products/Archetypes/profiles.zcml b/Products/Archetypes/profiles.zcml
index 2ab36c7..866157f 100644
--- a/Products/Archetypes/profiles.zcml
+++ b/Products/Archetypes/profiles.zcml
@@ -11,4 +11,11 @@
       provides="Products.GenericSetup.interfaces.EXTENSION"
       />
 
+  <genericsetup:registerProfile
+      name="uninstall"
+      title="Archetypes uninstall"
+      directory="profiles/uninstall"
+      provides="Products.GenericSetup.interfaces.EXTENSION"
+      />
+
 </configure>
diff --git a/Products/Archetypes/profiles/uninstall/registry.xml b/Products/Archetypes/profiles/uninstall/registry.xml
new file mode 100644
index 0000000..0a8c512
--- /dev/null
+++ b/Products/Archetypes/profiles/uninstall/registry.xml
@@ -0,0 +1,6 @@
+<registry>
+
+  <record name="Products.Archetypes.calendar_starting_year" remove="true" />
+  <record name="Products.Archetypes.calendar_future_years_available" remove="true" />
+
+</registry>
diff --git a/Products/Archetypes/profiles/uninstall/skins.xml b/Products/Archetypes/profiles/uninstall/skins.xml
new file mode 100644
index 0000000..7dbe920
--- /dev/null
+++ b/Products/Archetypes/profiles/uninstall/skins.xml
@@ -0,0 +1,7 @@
+<?xml version="1.0"?>
+<object name="portal_skins">
+  <object name="archetypes" remove="true" />
+  <skin-path name="*">
+    <layer name="archetypes" remove="true" />
+  </skin-path>
+</object>
diff --git a/Products/Archetypes/profiles/uninstall/toolset.xml b/Products/Archetypes/profiles/uninstall/toolset.xml
new file mode 100644
index 0000000..d3d6ec2
--- /dev/null
+++ b/Products/Archetypes/profiles/uninstall/toolset.xml
@@ -0,0 +1,6 @@
+<?xml version="1.0"?>
+<tool-setup>
+  <forbidden tool_id="archetype_tool" />
+  <forbidden tool_id="reference_catalog" />
+  <forbidden tool_id="uid_catalog" />
+</tool-setup>
diff --git a/setup.py b/setup.py
index 2b1751e..9355845 100644
--- a/setup.py
+++ b/setup.py
@@ -52,7 +52,7 @@
           'Products.CMFFormController',
           'Products.CMFQuickInstallerTool',
           'Products.DCWorkflow',
-          'Products.GenericSetup',
+          'Products.GenericSetup>=1.8.3',
           'Products.MimetypesRegistry>=2.0.3',
           'Products.PlacelessTranslationService',
           'Products.PortalTransforms',


Repository: Products.Archetypes


Branch: refs/heads/master
Date: 2016-05-02T13:20:26+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.forcada@freitag.de>
Commit: https://github.com/plone/Products.Archetypes/commit/b55615384bf8c360e3dcdd2989442d301a2033f9

Merge pull request #54 from plone/uninstall-profile

Add uninstall profile

Files changed:
A Products/Archetypes/profiles/uninstall/registry.xml
A Products/Archetypes/profiles/uninstall/skins.xml
A Products/Archetypes/profiles/uninstall/toolset.xml
M CHANGES.rst
M Products/Archetypes/profiles.zcml
M Products/Archetypes/profiles/default/toolset.xml
M setup.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 2d16129..b5d35d8 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,13 @@ Incompatibilities:
 
 New:
 
-- *add item here*
+- Added uninstall profile.  Most importantly this removes the
+  ``archetype_tool``, ``reference_catalog``, and ``uid_catalog``.
+  Needs Products.GenericSetup 1.8.3.
+  [maurits]
+
+- Removed ``error_log`` from ``toolset.xml``, because this is already
+  in the toolset of ``Products.CMFPlone``.   [maurits]
 
 Fixes:
 
diff --git a/Products/Archetypes/profiles.zcml b/Products/Archetypes/profiles.zcml
index 2ab36c7..866157f 100644
--- a/Products/Archetypes/profiles.zcml
+++ b/Products/Archetypes/profiles.zcml
@@ -11,4 +11,11 @@
       provides="Products.GenericSetup.interfaces.EXTENSION"
       />
 
+  <genericsetup:registerProfile
+      name="uninstall"
+      title="Archetypes uninstall"
+      directory="profiles/uninstall"
+      provides="Products.GenericSetup.interfaces.EXTENSION"
+      />
+
 </configure>
diff --git a/Products/Archetypes/profiles/default/toolset.xml b/Products/Archetypes/profiles/default/toolset.xml
index f266a00..31642b1 100644
--- a/Products/Archetypes/profiles/default/toolset.xml
+++ b/Products/Archetypes/profiles/default/toolset.xml
@@ -1,7 +1,5 @@
 <?xml version="1.0"?>
 <tool-setup>
-  <required tool_id="error_log"
-    class="Products.SiteErrorLog.SiteErrorLog.SiteErrorLog"/>
   <required tool_id="archetype_tool"
     class="Products.Archetypes.ArchetypeTool"/>
   <required tool_id="reference_catalog"
diff --git a/Products/Archetypes/profiles/uninstall/registry.xml b/Products/Archetypes/profiles/uninstall/registry.xml
new file mode 100644
index 0000000..0a8c512
--- /dev/null
+++ b/Products/Archetypes/profiles/uninstall/registry.xml
@@ -0,0 +1,6 @@
+<registry>
+
+  <record name="Products.Archetypes.calendar_starting_year" remove="true" />
+  <record name="Products.Archetypes.calendar_future_years_available" remove="true" />
+
+</registry>
diff --git a/Products/Archetypes/profiles/uninstall/skins.xml b/Products/Archetypes/profiles/uninstall/skins.xml
new file mode 100644
index 0000000..7dbe920
--- /dev/null
+++ b/Products/Archetypes/profiles/uninstall/skins.xml
@@ -0,0 +1,7 @@
+<?xml version="1.0"?>
+<object name="portal_skins">
+  <object name="archetypes" remove="true" />
+  <skin-path name="*">
+    <layer name="archetypes" remove="true" />
+  </skin-path>
+</object>
diff --git a/Products/Archetypes/profiles/uninstall/toolset.xml b/Products/Archetypes/profiles/uninstall/toolset.xml
new file mode 100644
index 0000000..d3d6ec2
--- /dev/null
+++ b/Products/Archetypes/profiles/uninstall/toolset.xml
@@ -0,0 +1,6 @@
+<?xml version="1.0"?>
+<tool-setup>
+  <forbidden tool_id="archetype_tool" />
+  <forbidden tool_id="reference_catalog" />
+  <forbidden tool_id="uid_catalog" />
+</tool-setup>
diff --git a/setup.py b/setup.py
index 2b1751e..9355845 100644
--- a/setup.py
+++ b/setup.py
@@ -52,7 +52,7 @@
           'Products.CMFFormController',
           'Products.CMFQuickInstallerTool',
           'Products.DCWorkflow',
-          'Products.GenericSetup',
+          'Products.GenericSetup>=1.8.3',
           'Products.MimetypesRegistry>=2.0.3',
           'Products.PlacelessTranslationService',
           'Products.PortalTransforms',


