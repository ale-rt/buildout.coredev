Repository: plone.app.z3cform


Branch: refs/heads/1.x
Date: 2016-12-20T10:51:29-06:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.z3cform/commit/f30af2a3678d8e2c5c402cb38818f425d58297b0

RelatedItemsDataConverter fix
Fix RelatedItemsDataConverter with relation lists, where in an iteration a wrong value was checked to be existent.
Fixes failures in situations, where a ``None`` value was part of the relation list.

Files changed:
M CHANGES.rst
M plone/app/z3cform/converters.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 9e9c124..874e335 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,9 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Fix RelatedItemsDataConverter with relation lists, where in an iteration a wrong value was checked to be existent.
+  Fixes failures in situations, where a ``None`` value was part of the relation list.
+  [thet]
 
 
 1.2.2 (2016-10-25)
diff --git a/plone/app/z3cform/converters.py b/plone/app/z3cform/converters.py
index 9e43085..de4d0b7 100644
--- a/plone/app/z3cform/converters.py
+++ b/plone/app/z3cform/converters.py
@@ -230,7 +230,7 @@ def toWidgetValue(self, value):
             return self.field.missing_value
         separator = getattr(self.widget, 'separator', ';')
         if IRelationList.providedBy(self.field):
-            return separator.join([IUUID(o) for o in value if value])
+            return separator.join([IUUID(o) for o in value if o])
         else:
             return separator.join(v for v in value if v)
 


Repository: plone.app.z3cform


Branch: refs/heads/1.x
Date: 2016-12-20T15:37:52-06:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.z3cform/commit/aa688559ea292203e3093889cf16147dc902656a

Merge pull request #56 from plone/thet-relationlistfix-1.x

RelatedItemsDataConverter fix

Files changed:
M CHANGES.rst
M plone/app/z3cform/converters.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 9e9c124..874e335 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,9 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Fix RelatedItemsDataConverter with relation lists, where in an iteration a wrong value was checked to be existent.
+  Fixes failures in situations, where a ``None`` value was part of the relation list.
+  [thet]
 
 
 1.2.2 (2016-10-25)
diff --git a/plone/app/z3cform/converters.py b/plone/app/z3cform/converters.py
index 9e43085..de4d0b7 100644
--- a/plone/app/z3cform/converters.py
+++ b/plone/app/z3cform/converters.py
@@ -230,7 +230,7 @@ def toWidgetValue(self, value):
             return self.field.missing_value
         separator = getattr(self.widget, 'separator', ';')
         if IRelationList.providedBy(self.field):
-            return separator.join([IUUID(o) for o in value if value])
+            return separator.join([IUUID(o) for o in value if o])
         else:
             return separator.join(v for v in value if v)
 


