Repository: plone.app.dexterity


Branch: refs/heads/master
Date: 2016-05-18T00:07:01+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.dexterity/commit/fa6b6b62fc09956aca27ee5de8a8df3a0caefaf3

Linebreaks in description are replaced with a space instead of vanishing it.

Files changed:
M CHANGES.rst
M plone/app/dexterity/behaviors/metadata.py

diff --git a/CHANGES.rst b/CHANGES.rst
index abbc259..bc0c00e 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -18,7 +18,9 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Linebreaks in description are replaced with a space instead of vanishing it.
+  Thus an editor can use them w/o having word glued together afterwards.
+  [jensens]
 
 
 2.2.0 (2016-04-28)
diff --git a/plone/app/dexterity/behaviors/metadata.py b/plone/app/dexterity/behaviors/metadata.py
index 2a3b35b..35ecc4e 100644
--- a/plone/app/dexterity/behaviors/metadata.py
+++ b/plone/app/dexterity/behaviors/metadata.py
@@ -368,10 +368,11 @@ def _set_description(self, value):
         # See http://bo.geekworld.dk/diazo-bug-on-html5-validation-errors/
 
         if '\n' in value:
-            value = value.replace('\n', '')
-
-        if '\r' in value:
-            value = value.replace('\r', '')
+            value = value.replace('\n', ' ')
+            if '\r' in value:
+                value = value.replace('\r', '')
+        elif '\r' in value:
+            value = value.replace('\r', ' ')
 
         self.context.description = value
 


Repository: plone.app.dexterity


Branch: refs/heads/master
Date: 2016-05-18T04:53:56+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.dexterity/commit/80ea3cc316263935bfcdadda727345ef30561f04

Merge pull request #217 from plone/jensens-linebreakfix

Linebreaks in description are replaced with a space ...

Files changed:
M CHANGES.rst
M plone/app/dexterity/behaviors/metadata.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 5e9f8d3..7705e4f 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -21,7 +21,9 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Linebreaks in description are replaced with a space instead of vanishing it.
+  Thus an editor can use them w/o having word glued together afterwards.
+  [jensens]
 
 
 2.2.0 (2016-04-28)
diff --git a/plone/app/dexterity/behaviors/metadata.py b/plone/app/dexterity/behaviors/metadata.py
index 2a3b35b..35ecc4e 100644
--- a/plone/app/dexterity/behaviors/metadata.py
+++ b/plone/app/dexterity/behaviors/metadata.py
@@ -368,10 +368,11 @@ def _set_description(self, value):
         # See http://bo.geekworld.dk/diazo-bug-on-html5-validation-errors/
 
         if '\n' in value:
-            value = value.replace('\n', '')
-
-        if '\r' in value:
-            value = value.replace('\r', '')
+            value = value.replace('\n', ' ')
+            if '\r' in value:
+                value = value.replace('\r', '')
+        elif '\r' in value:
+            value = value.replace('\r', ' ')
 
         self.context.description = value
 


