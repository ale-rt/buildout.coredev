Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2016-01-08T17:31:39+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.TinyMCE/commit/0361279301ca0e812e8f28f44dfb21264ede9aa5

Fixed tests after change from SearchableText to Title.

Files changed:
M Products/TinyMCE/tests/test_adapters.py
M Products/TinyMCE/tests/test_browser.py

diff --git a/Products/TinyMCE/tests/test_adapters.py b/Products/TinyMCE/tests/test_adapters.py
index 274851e..ae9797e 100644
--- a/Products/TinyMCE/tests/test_adapters.py
+++ b/Products/TinyMCE/tests/test_adapters.py
@@ -28,7 +28,8 @@ def setUp(self):
         super(AdaptersTestCase, self).setUp()
 
         self.utility = getToolByName(self.portal, 'portal_tinymce')
-        self.document = self.portal.invokeFactory('Document', id='document')
+        self.document = self.portal.invokeFactory(
+            'Document', id='document', title='My Document')
         folder = self.portal.invokeFactory('Folder', id='folder')
         self.folder_object = self.portal[folder]
 
@@ -39,7 +40,12 @@ def test_json_details_document(self):
         # The basic details should return the following.
         obj = IJSONDetails(self.portal[self.document])
         details = json.loads(obj.getDetails())
-        should = {"url": "http://nohost/plone/document", "thumb": "", "description": "", "anchors": [], "title": "document"}
+        should = {
+            "url": "http://nohost/plone/document",
+            "thumb": "",
+            "description": "",
+            "anchors": [],
+            "title": "My Document"}
         for key, val in should.iteritems():
             self.assertEqual(details[key], val)
 
@@ -49,7 +55,12 @@ def test_json_details_document(self):
 
         # The details will now contain a bit more info.
         details = json.loads(obj.getDetails())
-        should = {"url": "http://nohost/plone/document", "thumb": "", "description": "Test", "anchors": ["anchor"], "title": "document"}
+        should = {
+            "url": "http://nohost/plone/document",
+            "thumb": "",
+            "description": "Test",
+            "anchors": ["anchor"],
+            "title": "My Document"}
         for key, val in should.iteritems():
             self.assertEqual(details[key], val)
 
@@ -151,25 +162,25 @@ def test_json_search(self):
         self.assertRegexpMatches(results, '"id": "events", "icon": null}')
 
     def test_json_search_icon(self):
-        self.portal.invokeFactory('File', id='somefile.bin')
+        self.portal.invokeFactory('File', id='somefile.bin', title='Some File')
         linkable_portal_types = self.utility.linkable.split('\n')
         linkable_portal_types.extend(self.utility.containsobjects.split('\n'))
 
         obj = IJSONSearch(self.portal)
         results = obj.getSearchResults(filter_portal_types=linkable_portal_types,
-                                         searchtext='somefile')
+                                         searchtext='some file')
         self.assertRegexpMatches(results,
             r'"id": "somefile.bin", "icon": "<img width=\\"16\\" height=\\"16\\" src=\\"http://nohost/plone/application.png\\" alt=\\"File.*?\\" />"')
 
     def test_json_search_wildcard_whitespace(self):
-        self.portal.invokeFactory('File', id='somefile bin')
+        self.portal.invokeFactory('File', id='somefile bin', title='Some File')
         linkable_portal_types = self.utility.linkable.split('\n')
         linkable_portal_types.extend(self.utility.containsobjects.split('\n'))
 
         obj = IJSONSearch(self.portal)
         results = obj.getSearchResults(
             filter_portal_types=linkable_portal_types,
-            searchtext='somefile bi'
+            searchtext='some fi'
         )
         self.assertRegexpMatches(results,
             r'"id": "somefile bin", "icon": "<img width=\\"16\\" height=\\"16\\" src=\\"http://nohost/plone/application.png\\" alt=\\"File.*?\\" />"')
diff --git a/Products/TinyMCE/tests/test_browser.py b/Products/TinyMCE/tests/test_browser.py
index dc2aca1..37b98b2 100644
--- a/Products/TinyMCE/tests/test_browser.py
+++ b/Products/TinyMCE/tests/test_browser.py
@@ -9,8 +9,10 @@ class BrowserTestCase(FunctionalTestCase):
 
     def setUp(self):
         super(BrowserTestCase, self).setUp()
-        self.image = self.portal.invokeFactory('Image', id='image')
-        self.document = self.portal.invokeFactory('Document', id='document')
+        self.image = self.portal.invokeFactory(
+            'Image', id='image', title='My Image')
+        self.document = self.portal.invokeFactory(
+            'Document', id='document', title='My Document')
 
     def test_url(self):
         # We get the url by specifying the uid of the document.


