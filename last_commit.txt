Repository: Products.CMFPlone


Branch: refs/heads/4.3.x
Date: 2017-01-14T20:39:24+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/18c61ea1df1de0189db1c52e35a2a74a41421870

Fixed tests with newer plone.app.discussion.

Files changed:
M Products/CMFPlone/tests/testPortalCreation.py
M Products/CMFPlone/tests/testWorkflowTool.py
M docs/CHANGES.rst

diff --git a/Products/CMFPlone/tests/testPortalCreation.py b/Products/CMFPlone/tests/testPortalCreation.py
index a6cc38d..f5b8172 100644
--- a/Products/CMFPlone/tests/testPortalCreation.py
+++ b/Products/CMFPlone/tests/testPortalCreation.py
@@ -631,10 +631,10 @@ def testMemberHasViewGroupsPermission(self):
         self.assertTrue(member_has_permission['selected'])
 
     def testDiscussionItemWorkflow(self):
-        # By default the discussion item has the one_state_workflow
+        # By default the discussion item has the comment_one_state_workflow
         self.assertEqual(
             self.workflow.getChainForPortalType('Discussion Item'),
-            ('one_state_workflow',))
+            ('comment_one_state_workflow',))
 
     def testFolderHasFolderListingView(self):
         # Folder type should allow 'folder_listing'
diff --git a/Products/CMFPlone/tests/testWorkflowTool.py b/Products/CMFPlone/tests/testWorkflowTool.py
index 203d2c0..6a73ced 100644
--- a/Products/CMFPlone/tests/testWorkflowTool.py
+++ b/Products/CMFPlone/tests/testWorkflowTool.py
@@ -20,6 +20,7 @@
     'one_state_workflow': ('published',),
     'plone_workflow': ('pending', 'private', 'published', 'visible',),
     'simple_publication_workflow': ('private', 'published', 'pending',),
+    'comment_one_state_workflow': ('published',),
     'comment_review_workflow': ('pending', 'published',)
 }
 # then we join all states into one master list
diff --git a/docs/CHANGES.rst b/docs/CHANGES.rst
index 385f77b..7878e8a 100644
--- a/docs/CHANGES.rst
+++ b/docs/CHANGES.rst
@@ -25,6 +25,8 @@ New features:
 
 Bug fixes:
 
+- Fixed workflow tests for new ``comment_one_state_workflow``.  [maurits]
+
 - Fix base tag differs from actual URL (fixes `#86`_).
   [rodfersou]
 


Repository: Products.CMFPlone


Branch: refs/heads/4.3.x
Date: 2017-01-16T16:43:33+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/067622eea697dc997011b6aecce36048b528d9d6

Merge pull request #1911 from plone/comment-one-state-workflow-43

Fixed tests with newer plone.app.discussion. [4.3]

Files changed:
M Products/CMFPlone/tests/testPortalCreation.py
M Products/CMFPlone/tests/testWorkflowTool.py
M docs/CHANGES.rst

diff --git a/Products/CMFPlone/tests/testPortalCreation.py b/Products/CMFPlone/tests/testPortalCreation.py
index a6cc38d..f5b8172 100644
--- a/Products/CMFPlone/tests/testPortalCreation.py
+++ b/Products/CMFPlone/tests/testPortalCreation.py
@@ -631,10 +631,10 @@ def testMemberHasViewGroupsPermission(self):
         self.assertTrue(member_has_permission['selected'])
 
     def testDiscussionItemWorkflow(self):
-        # By default the discussion item has the one_state_workflow
+        # By default the discussion item has the comment_one_state_workflow
         self.assertEqual(
             self.workflow.getChainForPortalType('Discussion Item'),
-            ('one_state_workflow',))
+            ('comment_one_state_workflow',))
 
     def testFolderHasFolderListingView(self):
         # Folder type should allow 'folder_listing'
diff --git a/Products/CMFPlone/tests/testWorkflowTool.py b/Products/CMFPlone/tests/testWorkflowTool.py
index 203d2c0..6a73ced 100644
--- a/Products/CMFPlone/tests/testWorkflowTool.py
+++ b/Products/CMFPlone/tests/testWorkflowTool.py
@@ -20,6 +20,7 @@
     'one_state_workflow': ('published',),
     'plone_workflow': ('pending', 'private', 'published', 'visible',),
     'simple_publication_workflow': ('private', 'published', 'pending',),
+    'comment_one_state_workflow': ('published',),
     'comment_review_workflow': ('pending', 'published',)
 }
 # then we join all states into one master list
diff --git a/docs/CHANGES.rst b/docs/CHANGES.rst
index 385f77b..7878e8a 100644
--- a/docs/CHANGES.rst
+++ b/docs/CHANGES.rst
@@ -25,6 +25,8 @@ New features:
 
 Bug fixes:
 
+- Fixed workflow tests for new ``comment_one_state_workflow``.  [maurits]
+
 - Fix base tag differs from actual URL (fixes `#86`_).
   [rodfersou]
 


