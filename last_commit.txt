Repository: plone.app.multilingual


Branch: refs/heads/master
Date: 2017-08-04T15:02:11+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.multilingual/commit/0be09c3897cfbb7b4d6c3fa57e5d3febbcbdb72e

Fixed failing tests after Spanish update.

There are some tests using the Spanish language.
Recently a translation for 'assets' was added: 'recursos'.
This means that a new Spanish site no longer has an 'assets' folder, but a 'recursos' folder.
So some tests failed. They now pass.

Files changed:
M src/plone/app/multilingual/tests/test_lrf.py
M src/plone/app/multilingual/tests/test_sitemap.py

diff --git a/src/plone/app/multilingual/tests/test_lrf.py b/src/plone/app/multilingual/tests/test_lrf.py
index af58962..db56e9b 100644
--- a/src/plone/app/multilingual/tests/test_lrf.py
+++ b/src/plone/app/multilingual/tests/test_lrf.py
@@ -30,7 +30,7 @@ def test_shared_content(self):
         self.assertEqual(self.portal.en.assets['test-document'],
                          self.portal.ca.assets['test-document'])
         self.assertEqual(self.portal.en.assets['test-document'],
-                         self.portal.es.assets['test-document'])
+                         self.portal.es.recursos['test-document'])
 
         # Delete shared document
         notify(ObjectWillBeRemovedEvent(self.portal.en.assets['test-document']))
@@ -38,7 +38,7 @@ def test_shared_content(self):
 
         # Check that it is not available in LRFs
         self.assertNotIn('test-document', self.portal.ca.assets.objectIds())
-        self.assertNotIn('test-document', self.portal.es.assets.objectIds())
+        self.assertNotIn('test-document', self.portal.es.recursos.objectIds())
 
     def test_shared_content_indexing(self):
         # Create shared document
@@ -94,7 +94,7 @@ def test_moving_shared_content_to_lrf(self):
         brains = self.portal.portal_catalog.searchResults(
             UID='{0:s}-es'.format(uuid))
         self.assertEqual(len(brains), 1)
-        self.assertEqual(brains[0].getPath(), '/plone/es/assets/test-document')
+        self.assertEqual(brains[0].getPath(), '/plone/es/recursos/test-document')
 
         # MOVE!
         moved = multilingualMoveObject(
diff --git a/src/plone/app/multilingual/tests/test_sitemap.py b/src/plone/app/multilingual/tests/test_sitemap.py
index e995617..7bb0fca 100644
--- a/src/plone/app/multilingual/tests/test_sitemap.py
+++ b/src/plone/app/multilingual/tests/test_sitemap.py
@@ -61,7 +61,7 @@ def test_portalroot_sitemap(self):
 
         self.assertIn('<loc>http://nohost/plone/ca/assets/test-document</loc>', xml)
         self.assertIn('<loc>http://nohost/plone/en/assets/test-document</loc>', xml)
-        self.assertIn('<loc>http://nohost/plone/es/assets/test-document</loc>', xml)
+        self.assertIn('<loc>http://nohost/plone/es/recursos/test-document</loc>', xml)
 
     def test_navroot_sitemap(self):
         '''
@@ -76,4 +76,4 @@ def test_navroot_sitemap(self):
 
         self.assertNotIn('<loc>http://nohost/plone/ca/assets/test-document</loc>', xml)
         self.assertNotIn('<loc>http://nohost/plone/en/assets/test-document</loc>', xml)
-        self.assertIn('<loc>http://nohost/plone/es/assets/test-document</loc>', xml)
+        self.assertIn('<loc>http://nohost/plone/es/recursos/test-document</loc>', xml)


