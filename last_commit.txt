Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2017-10-27T10:57:02+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.upgrade/commit/eb03bd905be52c3c7bcadc0d3388403fa96b1a35

fix test for 5.0 and 5.1

Files changed:
M plone/app/upgrade/v50/testing.py

diff --git a/plone/app/upgrade/v50/testing.py b/plone/app/upgrade/v50/testing.py
index aa0d9e2a..165f5a1e 100644
--- a/plone/app/upgrade/v50/testing.py
+++ b/plone/app/upgrade/v50/testing.py
@@ -40,10 +40,14 @@ def setUpPloneSite(self, portal):
             # run upgrades
             self['portal'] = portal = app.test
             setSite(portal)
-            loadMigrationProfile(
-                portal.portal_setup,
-                'profile-plone.app.upgrade.v52:to52alpha1',
-                steps=['componentregistry'])
+            try:
+                # for 5.2 we need tools as utilities
+                loadMigrationProfile(
+                    portal.portal_setup,
+                    'profile-plone.app.upgrade.v52:to52alpha1',
+                    steps=['componentregistry'])
+            except KeyError:
+                pass
             portal.portal_migration.upgrade(swallow_errors=False)
             setSite(None)
 


