Repository: Products.Archetypes


Branch: refs/heads/1.9.x
Date: 2016-08-04T21:37:35-06:00
Author: Sean Upton (seanupton) <sdupton@gmail.com>
Commit: https://github.com/plone/Products.Archetypes/commit/808bd801403cb54f52eca39f7ad626fb58203391

Fix edit forms to use autotoc pattern markup, fixing form tabs on sites
with plone.app.widgets 1.x installed.

Files changed:
M CHANGES.rst
M Products/Archetypes/skins/archetypes/edit_macros.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index 0facf62..bd6031b 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,11 @@ Breaking changes:
 
 New features:
 
-- *add item here*
+- Support Autotoc pattern, if plone.app.widgets 1.x is installed, such
+  that form tabbing is enabled using this pattern.  Markup change
+  is consistent with how plone.app.z3cform 1.0.x templates specify
+  pattern use and configuration in edit forms/fieldsets.
+  [seanupton]
 
 Bug fixes:
 
diff --git a/Products/Archetypes/skins/archetypes/edit_macros.pt b/Products/Archetypes/skins/archetypes/edit_macros.pt
index 659039f..369c5c6 100644
--- a/Products/Archetypes/skins/archetypes/edit_macros.pt
+++ b/Products/Archetypes/skins/archetypes/edit_macros.pt
@@ -80,11 +80,12 @@
             method="post"
             enctype="multipart/form-data"
             class="enableUnloadProtection enableAutoFocus atBaseEditForm"
+            data-pat-autotoc="levels: legend; section: fieldset; className: autotabs"
             action=""
             id=""
             tal:attributes="action python:context.absolute_url()+'/'+template.id;
                             id string:${portal_type}-base-edit;
-                            class python:test(path('allow_tabbing|nothing'), 'enableUnloadProtection enableAutoFocus enableFormTabbing enableUnlockProtection', 'enableUnloadProtection enableAutoFocus enableUnlockProtection');">
+                            class python:test(path('allow_tabbing|nothing'), 'enableUnloadProtection enableAutoFocus enableFormTabbing enableUnlockProtection pat-autotoc', 'enableUnloadProtection enableAutoFocus enableUnlockProtection');">
           <metal:block define-slot="extra_top" />
 
           <div tal:replace="structure provider:archetypes.edit.beforefieldsets" />


Repository: Products.Archetypes


Branch: refs/heads/1.9.x
Date: 2016-08-06T08:58:16-03:00
Author: Davi Lima (davilima6) <davilima6@gmail.com>
Commit: https://github.com/plone/Products.Archetypes/commit/154191271d5374faa2ccf8acd2d0edd549b1ad0f

Merge pull request #60 from seanupton/1.9.x

Fix Plone 4 Archetypes edit forms to use autotoc pattern markup

Files changed:
M CHANGES.rst
M Products/Archetypes/skins/archetypes/edit_macros.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index 0facf62..bd6031b 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,11 @@ Breaking changes:
 
 New features:
 
-- *add item here*
+- Support Autotoc pattern, if plone.app.widgets 1.x is installed, such
+  that form tabbing is enabled using this pattern.  Markup change
+  is consistent with how plone.app.z3cform 1.0.x templates specify
+  pattern use and configuration in edit forms/fieldsets.
+  [seanupton]
 
 Bug fixes:
 
diff --git a/Products/Archetypes/skins/archetypes/edit_macros.pt b/Products/Archetypes/skins/archetypes/edit_macros.pt
index 659039f..369c5c6 100644
--- a/Products/Archetypes/skins/archetypes/edit_macros.pt
+++ b/Products/Archetypes/skins/archetypes/edit_macros.pt
@@ -80,11 +80,12 @@
             method="post"
             enctype="multipart/form-data"
             class="enableUnloadProtection enableAutoFocus atBaseEditForm"
+            data-pat-autotoc="levels: legend; section: fieldset; className: autotabs"
             action=""
             id=""
             tal:attributes="action python:context.absolute_url()+'/'+template.id;
                             id string:${portal_type}-base-edit;
-                            class python:test(path('allow_tabbing|nothing'), 'enableUnloadProtection enableAutoFocus enableFormTabbing enableUnlockProtection', 'enableUnloadProtection enableAutoFocus enableUnlockProtection');">
+                            class python:test(path('allow_tabbing|nothing'), 'enableUnloadProtection enableAutoFocus enableFormTabbing enableUnlockProtection pat-autotoc', 'enableUnloadProtection enableAutoFocus enableUnlockProtection');">
           <metal:block define-slot="extra_top" />
 
           <div tal:replace="structure provider:archetypes.edit.beforefieldsets" />


