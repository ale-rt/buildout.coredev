Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2016-03-30T13:38:54+02:00
Author: Marc Sommerhalder (msom) <marc.sommerhalder@seantis.ch>
Commit: https://github.com/plone/Products.TinyMCE/commit/33e0042aa85b2fd5f2b6700120d2541c3433712f

Replace anchor items in dropdown for internal links instead of appending.

Files changed:
M HISTORY.rst
M Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js

diff --git a/HISTORY.rst b/HISTORY.rst
index a68c829..9dff698 100644
--- a/HISTORY.rst
+++ b/HISTORY.rst
@@ -5,13 +5,8 @@ HISTORY
 1.3.19 (unreleased)
 -------------------
 
-New:
-
-- *add item here*
-
-Fixes:
-
-- *add item here*
+- Replace anchor items in dropdown for internal links instead of appending.
+  [msom]
 
 
 1.3.18 (2016-02-15)
diff --git a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
index fdaf1ee..8147a55 100644
--- a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
+++ b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
@@ -795,11 +795,11 @@ BrowserDialog.prototype.setDetails = function (url) {
             }
 
             if (data.anchors.length > 0) {
-                html = "";
+                html = '<option value="">top of page (default)</option>';
                 for (i = 0; i < data.anchors.length; i++) {
                     html += '<option value="' + data.anchors[i] + '">' + data.anchors[i] + '</option>';
                 }
-                jq('#pageanchor', document).append(html);
+                jq('#pageanchor', document).html(html);
                 jq('#pageanchorcontainer', document).parents('.field').removeClass('hide');
             } else {
                 jq('#pageanchorcontainer', document).parents('.field').addClass('hide');


Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2016-03-31T11:50:17+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.TinyMCE/commit/c10a3a11a9c609957f700fa27c274de4852fe429

Merge pull request #135 from plone/1.3.x-fix-internal-anchor-dropdown

Replace anchor items in dropdown for internal links instead of appeding

Files changed:
M HISTORY.rst
M Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js

diff --git a/HISTORY.rst b/HISTORY.rst
index a68c829..9dff698 100644
--- a/HISTORY.rst
+++ b/HISTORY.rst
@@ -5,13 +5,8 @@ HISTORY
 1.3.19 (unreleased)
 -------------------
 
-New:
-
-- *add item here*
-
-Fixes:
-
-- *add item here*
+- Replace anchor items in dropdown for internal links instead of appending.
+  [msom]
 
 
 1.3.18 (2016-02-15)
diff --git a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
index fdaf1ee..8147a55 100644
--- a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
+++ b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
@@ -795,11 +795,11 @@ BrowserDialog.prototype.setDetails = function (url) {
             }
 
             if (data.anchors.length > 0) {
-                html = "";
+                html = '<option value="">top of page (default)</option>';
                 for (i = 0; i < data.anchors.length; i++) {
                     html += '<option value="' + data.anchors[i] + '">' + data.anchors[i] + '</option>';
                 }
-                jq('#pageanchor', document).append(html);
+                jq('#pageanchor', document).html(html);
                 jq('#pageanchorcontainer', document).parents('.field').removeClass('hide');
             } else {
                 jq('#pageanchorcontainer', document).parents('.field').addClass('hide');


