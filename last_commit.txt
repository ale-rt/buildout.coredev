Repository: five.intid


Branch: refs/heads/master
Date: 2016-08-26T08:44:35+02:00
Author: Alessandro Pisa (ale-rt) <alessandro.pisa@gmail.com>
Commit: https://github.com/plone/five.intid/commit/8e7f46eb6aaae78b22ac9e6957591bc6bd0c890c

Prevent errors on removeIntIdSubscriber

Files changed:
M CHANGES.rst
M five/intid/intid.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 93c7ae7..d4c0ace 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,9 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Prevent errors on ``removeIntIdSubscriber`` when the ``IKeyReference`` adapter
+  raises a ``NotYet``, e.g. because the object does not have a proper path.
+  [ale-rt]
 
 
 1.1.1 (2016-08-19)
diff --git a/five/intid/intid.py b/five/intid/intid.py
index 074e08a..768a364 100644
--- a/five/intid/intid.py
+++ b/five/intid/intid.py
@@ -114,7 +114,10 @@ def removeIntIdSubscriber(ob, event):
     utilities = tuple(getAllUtilitiesRegisteredFor(IIntIds))
     if not utilities:
         return
-    key = IKeyReference(ob, None)
+    try:
+        key = IKeyReference(ob, None)
+    except NotYet:
+        key = None
 
     # Register only objects that adapt to key reference
     if key is None:


Repository: five.intid


Branch: refs/heads/master
Date: 2016-08-26T16:38:29+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/five.intid/commit/0ab5a847dc6b7b4aedacc0997aed09774724037c

Merge pull request #4 from plone/fix-not-yet

Prevent raising NotYet in removeIntIdSubscriber

Files changed:
M CHANGES.rst
M five/intid/intid.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 93c7ae7..d4c0ace 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,9 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Prevent errors on ``removeIntIdSubscriber`` when the ``IKeyReference`` adapter
+  raises a ``NotYet``, e.g. because the object does not have a proper path.
+  [ale-rt]
 
 
 1.1.1 (2016-08-19)
diff --git a/five/intid/intid.py b/five/intid/intid.py
index 074e08a..768a364 100644
--- a/five/intid/intid.py
+++ b/five/intid/intid.py
@@ -114,7 +114,10 @@ def removeIntIdSubscriber(ob, event):
     utilities = tuple(getAllUtilitiesRegisteredFor(IIntIds))
     if not utilities:
         return
-    key = IKeyReference(ob, None)
+    try:
+        key = IKeyReference(ob, None)
+    except NotYet:
+        key = None
 
     # Register only objects that adapt to key reference
     if key is None:


