Repository: plone.app.collection


Branch: refs/heads/1.0.x
Date: 2016-08-31T17:44:30+03:00
Author: ichim-david (ichim-david) <ichim.david@gmail.com>
Commit: https://github.com/plone/plone.app.collection/commit/0ad8a7b88a247acfc20f0b20f94aab871fc8bc74

summary_view.pt failed on obj/@@images when a Comment was found

Files changed:
M plone/app/collection/browser/templates/summary_view.pt

diff --git a/plone/app/collection/browser/templates/summary_view.pt b/plone/app/collection/browser/templates/summary_view.pt
index 05cf2e5..babba8c 100644
--- a/plone/app/collection/browser/templates/summary_view.pt
+++ b/plone/app/collection/browser/templates/summary_view.pt
@@ -18,12 +18,12 @@
         <div class="tileItem visualIEFloatFix"
              tal:define="obj item/getObject">
             <a href="#"
-                  tal:condition="obj/image|nothing"
+                  tal:define="scales obj/@@images|nothing"
+                  tal:condition="scales"
                   tal:attributes="href item/getURL">
                   <div class="tileImage">
                       <img src="" alt=""
-                           tal:define="scales obj/@@images;
-                                       scale python:scales.scale('image', 'thumb')"
+                           tal:define="scale python:scales.scale('image', 'thumb') if scales else None"
                            tal:replace="structure python:scale and scale.tag(css_class='tileImage') or None" />
                   </div>
             </a>


Repository: plone.app.collection


Branch: refs/heads/1.0.x
Date: 2016-08-31T18:42:46+03:00
Author: ichim-david (ichim-david) <ichim.david@gmail.com>
Commit: https://github.com/plone/plone.app.collection/commit/ae5d6745551fff29884b2144672789e004764089

Added Changes.rst entry

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 207d527..0e0b67b 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,9 @@ New features:
 
 Bug fixes:
 
+- Fix summary view for results with Discussion Items
+  [ichim-david]
+
 - Check with getattr if item isPrincipiaFolderish as Comment does
   not have this attribute which would render an AttributeError
   [ichim-david]


Repository: plone.app.collection


Branch: refs/heads/1.0.x
Date: 2016-08-31T22:03:03+03:00
Author: ichim-david (ichim-david) <ichim.david@gmail.com>
Commit: https://github.com/plone/plone.app.collection/commit/33bd60c4f74153f93bd8a3f7f13764d800969b78

Merge pull request #39 from ichim-david/1.0.x

Summary view crashes when collection has Discussion Items

Files changed:
M CHANGES.rst
M plone/app/collection/browser/templates/summary_view.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index 207d527..0e0b67b 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,9 @@ New features:
 
 Bug fixes:
 
+- Fix summary view for results with Discussion Items
+  [ichim-david]
+
 - Check with getattr if item isPrincipiaFolderish as Comment does
   not have this attribute which would render an AttributeError
   [ichim-david]
diff --git a/plone/app/collection/browser/templates/summary_view.pt b/plone/app/collection/browser/templates/summary_view.pt
index 05cf2e5..babba8c 100644
--- a/plone/app/collection/browser/templates/summary_view.pt
+++ b/plone/app/collection/browser/templates/summary_view.pt
@@ -18,12 +18,12 @@
         <div class="tileItem visualIEFloatFix"
              tal:define="obj item/getObject">
             <a href="#"
-                  tal:condition="obj/image|nothing"
+                  tal:define="scales obj/@@images|nothing"
+                  tal:condition="scales"
                   tal:attributes="href item/getURL">
                   <div class="tileImage">
                       <img src="" alt=""
-                           tal:define="scales obj/@@images;
-                                       scale python:scales.scale('image', 'thumb')"
+                           tal:define="scale python:scales.scale('image', 'thumb') if scales else None"
                            tal:replace="structure python:scale and scale.tag(css_class='tileImage') or None" />
                   </div>
             </a>


