Repository: Products.CMFPlone


Branch: refs/heads/5.0.x
Date: 2016-10-22T11:59:20-04:00
Author: Matthew Wilkes (MatthewWilkes) <git@matthewwilkes.name>
Commit: https://github.com/plone/Products.CMFPlone/commit/0c2244e4dc8f45921e90226194325866cd7a1972

Add a class to explicitly target the toolbar in its collapsed state

Files changed:
M Products/CMFPlone/static/patterns/toolbar/src/css/toolbar.plone.less
M Products/CMFPlone/static/patterns/toolbar/src/toolbar.js
M Products/CMFPlone/static/plone-compiled.js

diff --git a/Products/CMFPlone/static/patterns/toolbar/src/css/toolbar.plone.less b/Products/CMFPlone/static/patterns/toolbar/src/css/toolbar.plone.less
index e557606..a17edeb 100644
--- a/Products/CMFPlone/static/patterns/toolbar/src/css/toolbar.plone.less
+++ b/Products/CMFPlone/static/patterns/toolbar/src/css/toolbar.plone.less
@@ -206,6 +206,12 @@ body.userrole-authenticated {
 }
 .plone-toolbar-top #edit-zone nav > ul ul {height: 0; max-height: 0; width: 180px}
 
+.plone-toolbar-default #edit-zone {
+    /* Short title support */
+    .plone-toolbar-title, .plone-toolbar-state-title {
+        display: none;
+    }
+}
 
 .plone-toolbar-expanded #edit-zone {
     width:@plone-left-toolbar-expanded;
@@ -229,6 +235,11 @@ body.userrole-authenticated {
     .plone-toolbar-caret {width: 0;}
     li:not(.active) a:hover > span {background: @plone-toolbar-link;}
 
+    /* Short title support */
+    .plone-toolbar-short-title {
+        display: none;
+    }
+
     /*states*/
     li a.label-state-published:hover > span, li a.label-state-external:hover > span  {
         background: @plone-toolbar-published-color;
diff --git a/Products/CMFPlone/static/patterns/toolbar/src/toolbar.js b/Products/CMFPlone/static/patterns/toolbar/src/toolbar.js
index dd745f1..0bdfd0c 100644
--- a/Products/CMFPlone/static/patterns/toolbar/src/toolbar.js
+++ b/Products/CMFPlone/static/patterns/toolbar/src/toolbar.js
@@ -21,6 +21,7 @@ define([
         top: 'plone-toolbar-top',
         topDefault: 'plone-toolbar-top-default',
         topExpanded: 'plone-toolbar-top-expanded',
+        default: 'plone-toolbar-default',
         expanded: 'plone-toolbar-expanded',
         active: 'active'
       },
@@ -36,6 +37,7 @@ define([
       $('body').removeClass(that.options.classNames.topExpanded);
       $('body').removeClass(that.options.classNames.top);
       $('body').removeClass(that.options.classNames.topDefault);
+      $('body').removeClass(that.options.classNames.default);
       $('.' + that.options.classNames.logo, that.$container).off('click').on('click', function() {
         var $el = $(this);
         if ($el.hasClass('open')){
@@ -73,7 +75,9 @@ define([
       var that = this;
       if(that.state.expanded){
         $('body').addClass(that.options.classNames.expanded);
+        $('body').removeClass(that.options.classNames.default);
       }else{
+        $('body').addClass(that.options.classNames.default);
         $('body').removeClass(that.options.classNames.expanded);
       }
 
@@ -84,6 +88,7 @@ define([
             expanded: false
           });
           $('body').removeClass(that.options.classNames.expanded);
+          $('body').addClass(that.options.classNames.default);
           $('nav li', that.$container).removeClass(that.options.classNames.active);
           if (that.state.left) {
             $('body').addClass(that.options.classNames.leftDefault);
@@ -98,6 +103,7 @@ define([
           });
           // Switch to expanded
           $('body').addClass(that.options.classNames.expanded);
+          $('body').removeClass(that.options.classNames.default);
           $('nav li', that.$container).removeClass(that.options.classNames.active);
           if (that.state.left) {
             $('body').addClass(that.options.classNames.leftExpanded);
diff --git a/Products/CMFPlone/static/plone-compiled.js b/Products/CMFPlone/static/plone-compiled.js
index 254e3e9..77c65c4 100644
--- a/Products/CMFPlone/static/plone-compiled.js
+++ b/Products/CMFPlone/static/plone-compiled.js
@@ -12283,6 +12283,7 @@ define('plone-patterns-toolbar',[
         top: 'plone-toolbar-top',
         topDefault: 'plone-toolbar-top-default',
         topExpanded: 'plone-toolbar-top-expanded',
+        default: 'plone-toolbar-default',
         expanded: 'plone-toolbar-expanded',
         active: 'active'
       },


