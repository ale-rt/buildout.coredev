Repository: Products.CMFPlone


Branch: refs/heads/5.0.x
Date: 2016-12-28T17:46:32+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.CMFPlone/commit/d74a7c12f9dcfd544497be4a314bc5c92d22168f

TestAttackVectorsFunctional test_widget_traversal_2 assumed a 302 http return code when accessing some private API. Meanwhile it changed to return a 404 on the URL.

Files changed:
M CHANGES.rst
M Products/CMFPlone/tests/testSecurity.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 6a5e916..75a63a5 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -68,6 +68,12 @@ Bug fixes:
 - Don't fail, if ``timestamp.txt`` was deleted from the resource registries production folder.
   [thet]
 
+- Fix security test assertion: 
+  TestAttackVectorsFunctional test_widget_traversal_2 assumed a 302 http return code when accessing some private API.
+  Meanwhile it changed to return a 404 on the URL. 
+  Reflect this in the test and expect a 404.
+  [jensens]
+
 
 5.0.6 (2016-09-23)
 ------------------
diff --git a/Products/CMFPlone/tests/testSecurity.py b/Products/CMFPlone/tests/testSecurity.py
index 853a548..ac7f7dc 100644
--- a/Products/CMFPlone/tests/testSecurity.py
+++ b/Products/CMFPlone/tests/testSecurity.py
@@ -71,9 +71,7 @@ def test_widget_traversal_1(self):
     def test_widget_traversal_2(self):
         res = self.publish(
             '/plone/@@discussion-settings/++widget++captcha/terms/field/interface/setTaggedValue?tag=cake&value=lovely')
-        self.assertEqual(302, res.status)
-        self.assertTrue(res.headers['location'].startswith(
-            'http://nohost/plone/acl_users/credentials_cookie_auth/require_login'))
+        self.assertEqual(404, res.status)
 
     def test_registerConfiglet_1(self):
         VECTOR = "/plone/portal_controlpanel/registerConfiglet?id=cake&name=Cakey&action=woo&permission=View&icon_expr="


