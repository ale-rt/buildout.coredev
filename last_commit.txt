Repository: Products.CMFPlone


Branch: refs/heads/4.3.x
Date: 2016-12-30T16:46:25+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/Products.CMFPlone/commit/d6274cca1b5f15b982f3711288f71757a02a3f77

Fixed test_widget_traversal_2.

Zope 2 has a change that makes this a 404 instead of a 302 redirecting to the require_login form.
Both would be fine actually.

Files changed:
M Products/CMFPlone/tests/testSecurity.py

diff --git a/Products/CMFPlone/tests/testSecurity.py b/Products/CMFPlone/tests/testSecurity.py
index 51f4d62..b7aa74a 100644
--- a/Products/CMFPlone/tests/testSecurity.py
+++ b/Products/CMFPlone/tests/testSecurity.py
@@ -69,8 +69,7 @@ def test_widget_traversal_1(self):
 
     def test_widget_traversal_2(self):
         res = self.publish('/plone/@@discussion-settings/++widget++captcha/terms/field/interface/setTaggedValue?tag=cake&value=lovely')
-        self.assertEqual(302, res.status)
-        self.assertTrue(res.headers['location'].startswith('http://nohost/plone/acl_users/credentials_cookie_auth/require_login'))
+        self.assertEqual(404, res.status)
 
     def test_registerConfiglet_1(self):
         VECTOR = "/plone/portal_controlpanel/registerConfiglet?id=cake&name=Cakey&action=woo&permission=View&icon_expr="


