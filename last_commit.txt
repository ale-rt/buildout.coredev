Repository: plone.resource


Branch: refs/heads/master
Date: 2016-08-09T19:16:21+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.resource/commit/d404b728f0688d88e3092e7d2005ff5db2ba8bf9

Do not leave an .svn file behind when running the tests.

Do create a file, but call it `.dummy` for good measure, and remove it
afterwards.

The `.svn` was presumably from the days when plone.resource was still
in subversion, which for older versions of subversion meant that there
was a `.svn` directory already there, and should definitely not be
removed.

Files changed:
M CHANGES.rst
M plone/resource/tests/test_directory.py

diff --git a/CHANGES.rst b/CHANGES.rst
index b314789..f6a81a6 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,8 @@ New:
 
 Fixes:
 
+- Do not leave an ``.svn`` file behind when running the tests.  [maurits]
+
 - Use zope.interface decorator.
   [gforcada]
 
diff --git a/plone/resource/tests/test_directory.py b/plone/resource/tests/test_directory.py
index 6f6b99d..dbfda1e 100644
--- a/plone/resource/tests/test_directory.py
+++ b/plone/resource/tests/test_directory.py
@@ -225,7 +225,7 @@ def test_getitem(self):
     def test_contains(self):
         dir = self._makeOne()
         self.assertTrue('demo' in dir)
-        
+
     def test_openFile(self):
         dir = self._makeOne()
         file = dir.openFile('demo/foo/test.html')
@@ -245,10 +245,13 @@ def test_listDirectory(self):
 
     def test_listDirectory_filters_by_name(self):
         dir = self._makeOne()
-        name = '.svn'
-        if name not in os.listdir(dir.directory): # pragma: no cover
-            f = open(os.path.join(dir.directory, name), 'w')
+        name = '.dummy'
+        file_path = os.path.join(dir.directory, name)
+        if name not in os.listdir(dir.directory):
+            f = open(file_path, 'w')
             f.write("")
             f.close()
         self.assertTrue(name in os.listdir(dir.directory))
         self.assertEqual(['demo'], dir.listDirectory())
+        # Cleanup created file.
+        os.remove(file_path)


Repository: plone.resource


Branch: refs/heads/master
Date: 2016-08-09T23:58:54+02:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.resource/commit/0d7d0453551afc471859777388ebe10d6623f0e9

Merge pull request #13 from plone/maurits-remove-dot-svn-from-test

Do not leave an .svn file behind when running the tests.

Files changed:
M CHANGES.rst
M plone/resource/tests/test_directory.py

diff --git a/CHANGES.rst b/CHANGES.rst
index b314789..f6a81a6 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,8 @@ New:
 
 Fixes:
 
+- Do not leave an ``.svn`` file behind when running the tests.  [maurits]
+
 - Use zope.interface decorator.
   [gforcada]
 
diff --git a/plone/resource/tests/test_directory.py b/plone/resource/tests/test_directory.py
index 6f6b99d..dbfda1e 100644
--- a/plone/resource/tests/test_directory.py
+++ b/plone/resource/tests/test_directory.py
@@ -225,7 +225,7 @@ def test_getitem(self):
     def test_contains(self):
         dir = self._makeOne()
         self.assertTrue('demo' in dir)
-        
+
     def test_openFile(self):
         dir = self._makeOne()
         file = dir.openFile('demo/foo/test.html')
@@ -245,10 +245,13 @@ def test_listDirectory(self):
 
     def test_listDirectory_filters_by_name(self):
         dir = self._makeOne()
-        name = '.svn'
-        if name not in os.listdir(dir.directory): # pragma: no cover
-            f = open(os.path.join(dir.directory, name), 'w')
+        name = '.dummy'
+        file_path = os.path.join(dir.directory, name)
+        if name not in os.listdir(dir.directory):
+            f = open(file_path, 'w')
             f.write("")
             f.close()
         self.assertTrue(name in os.listdir(dir.directory))
         self.assertEqual(['demo'], dir.listDirectory())
+        # Cleanup created file.
+        os.remove(file_path)


