Repository: plone.app.collection


Branch: refs/heads/1.1.x
Date: 2016-08-31T19:03:27+03:00
Author: ichim-david (ichim-david) <ichim.david@gmail.com>
Commit: https://github.com/plone/plone.app.collection/commit/d13834dbc1d17fb6816363e2f321803088089377

summary_view.pt failed on obj/@@images when a Comment was found

Files changed:
M plone/app/collection/browser/templates/summary_view.pt

diff --git a/plone/app/collection/browser/templates/summary_view.pt b/plone/app/collection/browser/templates/summary_view.pt
index 05cf2e5..babba8c 100644
--- a/plone/app/collection/browser/templates/summary_view.pt
+++ b/plone/app/collection/browser/templates/summary_view.pt
@@ -18,12 +18,12 @@
         <div class="tileItem visualIEFloatFix"
              tal:define="obj item/getObject">
             <a href="#"
-                  tal:condition="obj/image|nothing"
+                  tal:define="scales obj/@@images|nothing"
+                  tal:condition="scales"
                   tal:attributes="href item/getURL">
                   <div class="tileImage">
                       <img src="" alt=""
-                           tal:define="scales obj/@@images;
-                                       scale python:scales.scale('image', 'thumb')"
+                           tal:define="scale python:scales.scale('image', 'thumb') if scales else None"
                            tal:replace="structure python:scale and scale.tag(css_class='tileImage') or None" />
                   </div>
             </a>


Repository: plone.app.collection


Branch: refs/heads/1.1.x
Date: 2016-08-31T19:04:49+03:00
Author: ichim-david (ichim-david) <ichim.david@gmail.com>
Commit: https://github.com/plone/plone.app.collection/commit/02f530e238af8704c1df9d41998c6cf66782f7f5

Added Changes.rst entry for summary.pt Discussion Item fix

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 9e918bf..2ee1a91 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,9 @@ New:
 
 Fixes:
 
+- Fix summary view for results with Discussion Items
+  [ichim-david]
+
 - Check with getattr if item isPrincipiaFolderish as Comment does
   not have this attribute which would render an AttributeError
   [ichim-david]


Repository: plone.app.collection


Branch: refs/heads/1.1.x
Date: 2016-08-31T22:02:51+03:00
Author: ichim-david (ichim-david) <ichim.david@gmail.com>
Commit: https://github.com/plone/plone.app.collection/commit/959ba8a777978fd7caaf60b40f7a06b5e94f4236

Merge pull request #40 from ichim-david/1.1.x

Port summary_view fix to 1.1.x branch

Files changed:
M CHANGES.rst
M plone/app/collection/browser/templates/summary_view.pt

diff --git a/CHANGES.rst b/CHANGES.rst
index 9e918bf..2ee1a91 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,9 @@ New:
 
 Fixes:
 
+- Fix summary view for results with Discussion Items
+  [ichim-david]
+
 - Check with getattr if item isPrincipiaFolderish as Comment does
   not have this attribute which would render an AttributeError
   [ichim-david]
diff --git a/plone/app/collection/browser/templates/summary_view.pt b/plone/app/collection/browser/templates/summary_view.pt
index 05cf2e5..babba8c 100644
--- a/plone/app/collection/browser/templates/summary_view.pt
+++ b/plone/app/collection/browser/templates/summary_view.pt
@@ -18,12 +18,12 @@
         <div class="tileItem visualIEFloatFix"
              tal:define="obj item/getObject">
             <a href="#"
-                  tal:condition="obj/image|nothing"
+                  tal:define="scales obj/@@images|nothing"
+                  tal:condition="scales"
                   tal:attributes="href item/getURL">
                   <div class="tileImage">
                       <img src="" alt=""
-                           tal:define="scales obj/@@images;
-                                       scale python:scales.scale('image', 'thumb')"
+                           tal:define="scale python:scales.scale('image', 'thumb') if scales else None"
                            tal:replace="structure python:scale and scale.tag(css_class='tileImage') or None" />
                   </div>
             </a>


