Repository: Products.CMFPlone


Branch: refs/heads/5.0.x
Date: 2016-10-06T23:09:12-05:00
Author: nathan.vangheem () <nathan.vangheem@wildcardcorp.com>
Commit: https://github.com/plone/Products.CMFPlone/commit/8bad9efddd268fd429d2b41892e4395f97725308

fix tinymce table styles

Files changed:
M CHANGES.rst
M Products/CMFPlone/patterns/__init__.py

diff --git a/CHANGES.rst b/CHANGES.rst
index f79f547..fa67a01 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -19,6 +19,8 @@ New features:
 
 Bug fixes:
 
+- Fix TinyMCE table styles [vangheem]
+
 - Apply security hotfix 20160830 for ``z3c.form`` widgets.  [maurits]
 
 - Fixed tests in combination with newer CMFFormController which has the hotfix.  [maurits]
@@ -1248,4 +1250,4 @@ Fixes:
 .. _`#1041`: https://github.com/plone/Products.CMFPlone/issues/1041
 .. _`#1053`: https://github.com/plone/Products.CMFPlone/issues/1053
 .. _`#1232`: https://github.com/plone/Products.CMFPlone/issues/1232
-.. _`#1255`: https://github.com/plone/Products.CMFPlone/issues/1255
\ No newline at end of file
+.. _`#1255`: https://github.com/plone/Products.CMFPlone/issues/1255
diff --git a/Products/CMFPlone/patterns/__init__.py b/Products/CMFPlone/patterns/__init__.py
index ab2e299..4a5cbc8 100644
--- a/Products/CMFPlone/patterns/__init__.py
+++ b/Products/CMFPlone/patterns/__init__.py
@@ -55,7 +55,7 @@ def get_style_format(self, txt, _type='format', base=None):
         if base is None:
             val = {}
         else:
-            val = base
+            val = base.copy()
         val.update({
             'title': parts[0],
             _type: parts[1]
@@ -93,7 +93,8 @@ def get_all_style_formats(self):
             'items': self.get_styles(alignment_styles)
         }, {
             'title': 'Tables',
-            'items': self.get_styles(table_styles)
+            'items': self.get_styles(
+                table_styles, 'classes', {'selector': 'table'})
         }]
 
     def get_tiny_config(self):


