Repository: plone.app.contentmenu


Branch: refs/heads/master
Date: 2016-04-01T02:16:48+02:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.contentmenu/commit/b8982aaee9536e1dd73075910e74575465158ab5

Fixes Case, where FactoriesMenu broke, because a len conversion from a None value.

Files changed:
M CHANGES.rst
M plone/app/contentmenu/menu.py

diff --git a/CHANGES.rst b/CHANGES.rst
index a8201ee..ebe49bf 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -10,7 +10,8 @@ New:
 
 Fixes:
 
-- *add item here*
+- Fixes Case, where ``FactoriesMenu`` broke, because a ``len`` conversion from a ``None`` value.
+  [thet]
 
 
 2.1.7 (2016-02-19)
diff --git a/plone/app/contentmenu/menu.py b/plone/app/contentmenu/menu.py
index 3976d72..4d84818 100644
--- a/plone/app/contentmenu/menu.py
+++ b/plone/app/contentmenu/menu.py
@@ -556,7 +556,7 @@ def getMenuItems(self, context, request):
         constraints = IConstrainTypes(addContext, None)
         if constraints is not None:
             include = constraints.getImmediatelyAddableTypes()
-            if len(include) < len(allowedTypes):
+            if include and allowedTypes and len(include) < len(allowedTypes):
                 haveMore = True
 
         results = factories_view.addable_types(include=include)


