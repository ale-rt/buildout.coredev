Repository: plone.api


Branch: refs/heads/master
Date: 2017-10-22T13:20:37+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.api/commit/02f1f97cab80d37b14d685dc6539699a7292fd89

Fix test in Zope4

Files changed:
M CHANGES.rst
M src/plone/api/tests/test_user.py

diff --git a/CHANGES.rst b/CHANGES.rst
index b610da7..93a98dd 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,11 @@ New features:
 
 Bug fixes:
 
+- Fix test in Zope4,
+  where ``Products.PlonePAS.tools.memberdata.MemberData`` is an adapter now.
+  It can't be proofed to be equal when fetched twice.
+  [jensens]
+
 - Change api.group.get_groups to work with CMF master.
   [jaroel]
 
diff --git a/src/plone/api/tests/test_user.py b/src/plone/api/tests/test_user.py
index 6a48762..4c88bba 100644
--- a/src/plone/api/tests/test_user.py
+++ b/src/plone/api/tests/test_user.py
@@ -182,8 +182,7 @@ def test_get(self):
             email='chuck@norris.org',
             password='secret',
         )
-
-        self.assertEqual(api.user.get('chuck'), user)
+        self.assertEqual(api.user.get('chuck').id, user.id)
 
     def test_get_current(self):
         """Test getting the currently logged-in user."""


Repository: plone.api


Branch: refs/heads/master
Date: 2017-10-22T13:22:34+02:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.api/commit/6788be58d34ff2f3a65d169478169d03d7412611

Merge pull request #393 from plone/fix-test-in-zope4

Fix test in Zope4

Files changed:
M CHANGES.rst
M src/plone/api/tests/test_user.py

diff --git a/CHANGES.rst b/CHANGES.rst
index b610da7..93a98dd 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,6 +14,11 @@ New features:
 
 Bug fixes:
 
+- Fix test in Zope4,
+  where ``Products.PlonePAS.tools.memberdata.MemberData`` is an adapter now.
+  It can't be proofed to be equal when fetched twice.
+  [jensens]
+
 - Change api.group.get_groups to work with CMF master.
   [jaroel]
 
diff --git a/src/plone/api/tests/test_user.py b/src/plone/api/tests/test_user.py
index 6a48762..4c88bba 100644
--- a/src/plone/api/tests/test_user.py
+++ b/src/plone/api/tests/test_user.py
@@ -182,8 +182,7 @@ def test_get(self):
             email='chuck@norris.org',
             password='secret',
         )
-
-        self.assertEqual(api.user.get('chuck'), user)
+        self.assertEqual(api.user.get('chuck').id, user.id)
 
     def test_get_current(self):
         """Test getting the currently logged-in user."""


