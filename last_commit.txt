Repository: Products.MimetypesRegistry


Branch: refs/heads/master
Date: 2016-07-05T23:19:43+02:00
Author: Gil Forcada (gforcada) <gforcada@gnome.org>
Commit: https://github.com/plone/Products.MimetypesRegistry/commit/3b1c7a60fd4b04eb4b7dad166a5f9c6e9c98c723

Use zope.interface decorator

This not only makes code more pleasent to read,
but also makes the code python 3 compatible
(while maintaining python 2 compatibility).

Files changed:
M CHANGES.rst
M Products/MimetypesRegistry/MimeTypeItem.py
M Products/MimetypesRegistry/MimeTypesRegistry.py
M Products/MimetypesRegistry/mime_types/mtr_mimetypes.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 1092ba0..10e6200 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Use zope.interface decorator.
+  [gforcada]
 
 
 2.0.9 (2016-05-26)
diff --git a/Products/MimetypesRegistry/MimeTypeItem.py b/Products/MimetypesRegistry/MimeTypeItem.py
index 76bed1d..2ee08f1 100644
--- a/Products/MimetypesRegistry/MimeTypeItem.py
+++ b/Products/MimetypesRegistry/MimeTypeItem.py
@@ -5,14 +5,14 @@
 from Persistence import Persistent
 from Products.CMFCore.permissions import ManagePortal
 from Products.MimetypesRegistry.interfaces import IMimetype
-from zope.interface import implements
+from zope.interface import implementer
 import os
 import urllib
 
 
+@implementer(IMimetype)
 class MimeTypeItem(Persistent, Explicit, Item):
     security = ClassSecurityInfo()
-    implements(IMimetype)
 
     extensions = ()
     globs = ()
diff --git a/Products/MimetypesRegistry/MimeTypesRegistry.py b/Products/MimetypesRegistry/MimeTypesRegistry.py
index ce82971..e84c579 100644
--- a/Products/MimetypesRegistry/MimeTypesRegistry.py
+++ b/Products/MimetypesRegistry/MimeTypesRegistry.py
@@ -23,7 +23,7 @@
 from Products.PageTemplates.PageTemplateFile import PageTemplateFile
 from types import UnicodeType
 from zope.contenttype import guess_content_type
-from zope.interface import implements
+from zope.interface import implementer
 import fnmatch
 import os
 import re
@@ -41,6 +41,7 @@
 }
 
 
+@implementer(IMimetypesRegistry, ISourceAdapter)
 class MimeTypesRegistry(UniqueObject, ActionProviderBase, Folder):
     """Mimetype registry that deals with
     a) registering types
@@ -48,8 +49,6 @@ class MimeTypesRegistry(UniqueObject, ActionProviderBase, Folder):
     c) classifying data into a given type
     """
 
-    implements(IMimetypesRegistry, ISourceAdapter)
-
     id = 'mimetypes_registry'
     meta_type = 'MimeTypes Registry'
     isPrincipiaFolderish = 1  # Show up in the ZMI
diff --git a/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py b/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
index ee5b412..d98f774 100644
--- a/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
+++ b/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
@@ -1,7 +1,7 @@
 from Products.MimetypesRegistry.MimeTypeItem import MimeTypeItem
 from Products.MimetypesRegistry.interfaces import IClassifier
 from types import InstanceType
-from zope.interface import implements
+from zope.interface import implementer
 import re
 
 
@@ -69,8 +69,8 @@ class application_msword(MimeTypeItem):
     binary = 1
 
 
+@implementer(IClassifier)
 class text_xml(MimeTypeItem):
-    implements(IClassifier)
 
     __name__ = "Extensible Markup Language (XML)"
     mimetypes = ('text/xml',)


Repository: Products.MimetypesRegistry


Branch: refs/heads/master
Date: 2016-07-07T01:00:03+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/Products.MimetypesRegistry/commit/90558142f046d26e3eddb4ea84320b4bc69fbc7c

Merge pull request #5 from plone/gforcada-use-zope-decorators

Use zope.interface decorator

Files changed:
M CHANGES.rst
M Products/MimetypesRegistry/MimeTypeItem.py
M Products/MimetypesRegistry/MimeTypesRegistry.py
M Products/MimetypesRegistry/mime_types/mtr_mimetypes.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 1092ba0..10e6200 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Use zope.interface decorator.
+  [gforcada]
 
 
 2.0.9 (2016-05-26)
diff --git a/Products/MimetypesRegistry/MimeTypeItem.py b/Products/MimetypesRegistry/MimeTypeItem.py
index 76bed1d..2ee08f1 100644
--- a/Products/MimetypesRegistry/MimeTypeItem.py
+++ b/Products/MimetypesRegistry/MimeTypeItem.py
@@ -5,14 +5,14 @@
 from Persistence import Persistent
 from Products.CMFCore.permissions import ManagePortal
 from Products.MimetypesRegistry.interfaces import IMimetype
-from zope.interface import implements
+from zope.interface import implementer
 import os
 import urllib
 
 
+@implementer(IMimetype)
 class MimeTypeItem(Persistent, Explicit, Item):
     security = ClassSecurityInfo()
-    implements(IMimetype)
 
     extensions = ()
     globs = ()
diff --git a/Products/MimetypesRegistry/MimeTypesRegistry.py b/Products/MimetypesRegistry/MimeTypesRegistry.py
index ce82971..e84c579 100644
--- a/Products/MimetypesRegistry/MimeTypesRegistry.py
+++ b/Products/MimetypesRegistry/MimeTypesRegistry.py
@@ -23,7 +23,7 @@
 from Products.PageTemplates.PageTemplateFile import PageTemplateFile
 from types import UnicodeType
 from zope.contenttype import guess_content_type
-from zope.interface import implements
+from zope.interface import implementer
 import fnmatch
 import os
 import re
@@ -41,6 +41,7 @@
 }
 
 
+@implementer(IMimetypesRegistry, ISourceAdapter)
 class MimeTypesRegistry(UniqueObject, ActionProviderBase, Folder):
     """Mimetype registry that deals with
     a) registering types
@@ -48,8 +49,6 @@ class MimeTypesRegistry(UniqueObject, ActionProviderBase, Folder):
     c) classifying data into a given type
     """
 
-    implements(IMimetypesRegistry, ISourceAdapter)
-
     id = 'mimetypes_registry'
     meta_type = 'MimeTypes Registry'
     isPrincipiaFolderish = 1  # Show up in the ZMI
diff --git a/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py b/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
index ee5b412..d98f774 100644
--- a/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
+++ b/Products/MimetypesRegistry/mime_types/mtr_mimetypes.py
@@ -1,7 +1,7 @@
 from Products.MimetypesRegistry.MimeTypeItem import MimeTypeItem
 from Products.MimetypesRegistry.interfaces import IClassifier
 from types import InstanceType
-from zope.interface import implements
+from zope.interface import implementer
 import re
 
 
@@ -69,8 +69,8 @@ class application_msword(MimeTypeItem):
     binary = 1
 
 
+@implementer(IClassifier)
 class text_xml(MimeTypeItem):
-    implements(IClassifier)
 
     __name__ = "Extensible Markup Language (XML)"
     mimetypes = ('text/xml',)


