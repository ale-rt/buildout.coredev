Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2017-09-11T21:12:26+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.upgrade/commit/9354a25e3897855cead4b92844beeda2ef4c3611

Use str() when migrating checkout_workflow_policy since the field is ASCII

Files changed:
M CHANGES.rst
M plone/app/upgrade/v50/betas.py

diff --git a/CHANGES.rst b/CHANGES.rst
index bdc8e5d..97bf926 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -17,6 +17,9 @@ Bug fixes:
 - Register settings for safe_html-Transform when migrating from 5107 to 5108
   [pbauer]
 
+- Use str() when migrating checkout_workflow_policy since the field is ASCII.
+  See discussion at https://github.com/plone/plone.app.iterate/pull/53
+  [pbauer]
 
 2.0.7 (2017-09-10)
 ------------------
diff --git a/plone/app/upgrade/v50/betas.py b/plone/app/upgrade/v50/betas.py
index d246b8c..59412f4 100644
--- a/plone/app/upgrade/v50/betas.py
+++ b/plone/app/upgrade/v50/betas.py
@@ -570,7 +570,7 @@ def to50rc3(context):
         value = site_properties.getProperty('checkout_workflow_policy')
         from plone.app.iterate.interfaces import IIterateSettings
         settings = registry.forInterface(IIterateSettings)
-        settings.checkout_workflow_policy = safe_unicode(value)
+        settings.checkout_workflow_policy = str(value)
         site_properties._delProperty('checkout_workflow_policy')
 
     if site_properties.hasProperty('default_page_types'):


Repository: plone.app.upgrade


Branch: refs/heads/master
Date: 2017-09-16T12:30:57+02:00
Author: Philip Bauer (pbauer) <bauer@starzel.de>
Commit: https://github.com/plone/plone.app.upgrade/commit/973855ea500f7371a12079b3d247b960049be8e7

Merge pull request #136 from plone/workon_checkout_workflow_policy_issues

Use str() when migrating checkout_workflow_policy

Files changed:
M CHANGES.rst
M plone/app/upgrade/v50/betas.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 19251d8..fc3663c 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -24,6 +24,9 @@ Bug fixes:
 - Register settings for safe_html-Transform when migrating from 5107 to 5108
   [pbauer]
 
+- Use str() when migrating checkout_workflow_policy since the field is ASCII.
+  See discussion at https://github.com/plone/plone.app.iterate/pull/53
+  [pbauer]
 
 2.0.7 (2017-09-10)
 ------------------
diff --git a/plone/app/upgrade/v50/betas.py b/plone/app/upgrade/v50/betas.py
index d246b8c..59412f4 100644
--- a/plone/app/upgrade/v50/betas.py
+++ b/plone/app/upgrade/v50/betas.py
@@ -570,7 +570,7 @@ def to50rc3(context):
         value = site_properties.getProperty('checkout_workflow_policy')
         from plone.app.iterate.interfaces import IIterateSettings
         settings = registry.forInterface(IIterateSettings)
-        settings.checkout_workflow_policy = safe_unicode(value)
+        settings.checkout_workflow_policy = str(value)
         site_properties._delProperty('checkout_workflow_policy')
 
     if site_properties.hasProperty('default_page_types'):


