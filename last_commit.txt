Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2015-12-15T16:52:52+01:00
Author: Marc Sommerhalder (msom) <marc.sommerhalder@seantis.ch>
Commit: https://github.com/plone/Products.TinyMCE/commit/e023f2ea68f420de8ff0da5fe191153970ea303c

Fixed bug where the plonebrowser dialog wouldn't properly populate the anchors if the HTML5 schema was used.

Files changed:
M HISTORY.rst
M Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js

diff --git a/HISTORY.rst b/HISTORY.rst
index 3db7ad5..7186acb 100644
--- a/HISTORY.rst
+++ b/HISTORY.rst
@@ -5,7 +5,11 @@ HISTORY
 1.3.17 (unreleased)
 -------------------
 
-- Nothing changed yet.
+Fixes:
+
+- Fixed bug where the plonebrowser dialog wouldn't properly populate the
+  anchors if the HTML5 schema was used.
+  [msom]
 
 
 1.3.16 (2015-11-20)
diff --git a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
index b47ec6d..a36c8b8 100644
--- a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
+++ b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
@@ -1214,6 +1214,10 @@ BrowserDialog.prototype.populateAnchorList = function () {
             html += '<div class="' + divclass + '"><input type="radio" class="noborder" name="anchorlink" id="#' + name + '" value="#' + name + '"/> <label for="#' + name + '">' + name + '</label></div>';
             divclass = divclass === "even" ? "odd" : "even";
         }
+        if ((name = nodes[i].id) !== "" && !nodes[i].href) {
+            html += '<div class="' + divclass + '"><input type="radio" class="noborder" name="anchorlink" id="#' + name + '" value="#' + name + '"/> <label for="#' + name + '">' + name + '</label></div>';
+            divclass = divclass === "even" ? "odd" : "even";
+        }
     }
 
     nodes = this.editor.dom.select(this.editor.settings.anchor_selector);


Repository: Products.TinyMCE


Branch: refs/heads/1.3.x
Date: 2015-12-30T13:15:35+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/Products.TinyMCE/commit/7f4454c389a111717f2f264444a22e6f364741f9

Merge pull request #130 from plone/1.3.x-fix-plonebrowser-anchors

Fixed bug where the plonebrowser dialog wouldn't properly populate thâ€¦

Files changed:
M HISTORY.rst
M Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js

diff --git a/HISTORY.rst b/HISTORY.rst
index 3db7ad5..7186acb 100644
--- a/HISTORY.rst
+++ b/HISTORY.rst
@@ -5,7 +5,11 @@ HISTORY
 1.3.17 (unreleased)
 -------------------
 
-- Nothing changed yet.
+Fixes:
+
+- Fixed bug where the plonebrowser dialog wouldn't properly populate the
+  anchors if the HTML5 schema was used.
+  [msom]
 
 
 1.3.16 (2015-11-20)
diff --git a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
index b47ec6d..a36c8b8 100644
--- a/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
+++ b/Products/TinyMCE/skins/tinymce/plugins/plonebrowser/js/plonebrowser.js
@@ -1214,6 +1214,10 @@ BrowserDialog.prototype.populateAnchorList = function () {
             html += '<div class="' + divclass + '"><input type="radio" class="noborder" name="anchorlink" id="#' + name + '" value="#' + name + '"/> <label for="#' + name + '">' + name + '</label></div>';
             divclass = divclass === "even" ? "odd" : "even";
         }
+        if ((name = nodes[i].id) !== "" && !nodes[i].href) {
+            html += '<div class="' + divclass + '"><input type="radio" class="noborder" name="anchorlink" id="#' + name + '" value="#' + name + '"/> <label for="#' + name + '">' + name + '</label></div>';
+            divclass = divclass === "even" ? "odd" : "even";
+        }
     }
 
     nodes = this.editor.dom.select(this.editor.settings.anchor_selector);


