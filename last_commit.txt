Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2017-01-05T12:30:43Z
Author: Franco Pellegrini (frapell) <frapell@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/8f6cd9a167d6cad38e5ea1c7fc2c6fbf60a254de

String needs to be unicode when format parameter is unicode

Files changed:
M plone/app/contenttypes/migration/field_migrators.py

diff --git a/plone/app/contenttypes/migration/field_migrators.py b/plone/app/contenttypes/migration/field_migrators.py
index 269b5d0..fad4c1d 100644
--- a/plone/app/contenttypes/migration/field_migrators.py
+++ b/plone/app/contenttypes/migration/field_migrators.py
@@ -92,7 +92,7 @@ def migrate_imagefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
                 ('{0}_caption'.format(dst_fieldname)),
                 safe_unicode(caption_field.get(src_obj)))
 
-    logger.info('Migrating image {0}'.format(filename))
+    logger.info(u'Migrating image {0}'.format(filename))
 
 
 def migrate_blobimagefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
@@ -122,7 +122,7 @@ def migrate_blobimagefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
                 ('{0}_caption'.format(dst_fieldname)),
                 safe_unicode(old_image_caption))
 
-    logger.info('Migrating image {0}'.format(filename))
+    logger.info(u'Migrating image {0}'.format(filename))
 
 
 def migrate_filefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
@@ -142,7 +142,7 @@ def migrate_filefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
         data=old_file_data,
         filename=filename)
     setattr(dst_obj, dst_fieldname, namedblobfile)
-    logger.info('Migrating file {0}'.format(filename))
+    logger.info(u'Migrating file {0}'.format(filename))
 
 
 def migrate_datetimefield(src_obj, dst_obj, src_fieldname, dst_fieldname):


Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2017-01-05T12:36:27Z
Author: Franco Pellegrini (frapell) <frapell@gmail.com>
Commit: https://github.com/plone/plone.app.contenttypes/commit/e8cb96a93a47e22bcc55fbb9f28173e9b67adee0

Update changelog

Files changed:
M CHANGES.rst

diff --git a/CHANGES.rst b/CHANGES.rst
index 281988e..ed53d7a 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Use unicode string when .format() parameter is unicode for the field migrator
+  [frapell]
 
 
 1.2.19 (2016-12-02)


Repository: plone.app.contenttypes


Branch: refs/heads/master
Date: 2017-01-13T01:55:51+01:00
Author: Maurits van Rees (mauritsvanrees) <maurits@vanrees.org>
Commit: https://github.com/plone/plone.app.contenttypes/commit/d4b23454ccdfd25ac593bf758f8b17aaa16ffd97

Merge pull request #382 from plone/unicode_format

String needs to be unicode when format parameter is unicode

Files changed:
M CHANGES.rst
M plone/app/contenttypes/migration/field_migrators.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 281988e..ed53d7a 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Use unicode string when .format() parameter is unicode for the field migrator
+  [frapell]
 
 
 1.2.19 (2016-12-02)
diff --git a/plone/app/contenttypes/migration/field_migrators.py b/plone/app/contenttypes/migration/field_migrators.py
index 269b5d0..fad4c1d 100644
--- a/plone/app/contenttypes/migration/field_migrators.py
+++ b/plone/app/contenttypes/migration/field_migrators.py
@@ -92,7 +92,7 @@ def migrate_imagefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
                 ('{0}_caption'.format(dst_fieldname)),
                 safe_unicode(caption_field.get(src_obj)))
 
-    logger.info('Migrating image {0}'.format(filename))
+    logger.info(u'Migrating image {0}'.format(filename))
 
 
 def migrate_blobimagefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
@@ -122,7 +122,7 @@ def migrate_blobimagefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
                 ('{0}_caption'.format(dst_fieldname)),
                 safe_unicode(old_image_caption))
 
-    logger.info('Migrating image {0}'.format(filename))
+    logger.info(u'Migrating image {0}'.format(filename))
 
 
 def migrate_filefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
@@ -142,7 +142,7 @@ def migrate_filefield(src_obj, dst_obj, src_fieldname, dst_fieldname):
         data=old_file_data,
         filename=filename)
     setattr(dst_obj, dst_fieldname, namedblobfile)
-    logger.info('Migrating file {0}'.format(filename))
+    logger.info(u'Migrating file {0}'.format(filename))
 
 
 def migrate_datetimefield(src_obj, dst_obj, src_fieldname, dst_fieldname):


