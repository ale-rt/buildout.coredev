Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2018-01-10T15:29:33+01:00
Author: Johannes Raggam (thet) <thetetet@gmail.com>
Commit: https://github.com/plone/plone.app.z3cform/commit/9f7c237cce35b3f8f4acf0ebf21c9a56e72201d3

Fix test failures from https://github.com/plone/plone.app.widgets/pull/177

Files changed:
M CHANGES.rst
M plone/app/z3cform/tests/test_widgets.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 9a6832e..7b03697 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Fix test failures from https://github.com/plone/plone.app.widgets/pull/177
+  [thet]
 
 
 3.0.3 (2017-11-24)
diff --git a/plone/app/z3cform/tests/test_widgets.py b/plone/app/z3cform/tests/test_widgets.py
index e518eeb..d166af9 100644
--- a/plone/app/z3cform/tests/test_widgets.py
+++ b/plone/app/z3cform/tests/test_widgets.py
@@ -1127,6 +1127,10 @@ class RelatedItemsWidgetTests(unittest.TestCase):
     def setUp(self):
         self.request = TestRequest(environ={'HTTP_ACCEPT_LANGUAGE': 'en'})
 
+    @mock.patch(
+        'plone.app.widgets.utils.getToolByName',
+        new=Mock(return_value=Mock(return_value='testuser'))
+    )
     def test_single_selection(self):
         """The pattern_options value for maximumSelectionSize should
         be 1 when the field only allows a single selection."""
@@ -1144,6 +1148,10 @@ def test_single_selection(self):
         pattern_options = base_args['pattern_options']
         self.assertEqual(pattern_options.get('maximumSelectionSize', 0), 1)
 
+    @mock.patch(
+        'plone.app.widgets.utils.getToolByName',
+        new=Mock(return_value=Mock(return_value='testuser'))
+    )
     def test_multiple_selection(self):
         """The pattern_options key maximumSelectionSize shouldn't be
         set when the field allows multiple selections"""


Repository: plone.app.z3cform


Branch: refs/heads/master
Date: 2018-01-12T02:18:41+01:00
Author: Jens W. Klein (jensens) <jk@kleinundpartner.at>
Commit: https://github.com/plone/plone.app.z3cform/commit/41d374f9e0facedf50f3f77c0d14e23d4351e226

Merge pull request #84 from plone/thet-recentlyused

Fix test failures from https://github.com/plone/plone.app.widgets/pull/177

Files changed:
M CHANGES.rst
M plone/app/z3cform/tests/test_widgets.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 9a6832e..7b03697 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Fix test failures from https://github.com/plone/plone.app.widgets/pull/177
+  [thet]
 
 
 3.0.3 (2017-11-24)
diff --git a/plone/app/z3cform/tests/test_widgets.py b/plone/app/z3cform/tests/test_widgets.py
index e518eeb..d166af9 100644
--- a/plone/app/z3cform/tests/test_widgets.py
+++ b/plone/app/z3cform/tests/test_widgets.py
@@ -1127,6 +1127,10 @@ class RelatedItemsWidgetTests(unittest.TestCase):
     def setUp(self):
         self.request = TestRequest(environ={'HTTP_ACCEPT_LANGUAGE': 'en'})
 
+    @mock.patch(
+        'plone.app.widgets.utils.getToolByName',
+        new=Mock(return_value=Mock(return_value='testuser'))
+    )
     def test_single_selection(self):
         """The pattern_options value for maximumSelectionSize should
         be 1 when the field only allows a single selection."""
@@ -1144,6 +1148,10 @@ def test_single_selection(self):
         pattern_options = base_args['pattern_options']
         self.assertEqual(pattern_options.get('maximumSelectionSize', 0), 1)
 
+    @mock.patch(
+        'plone.app.widgets.utils.getToolByName',
+        new=Mock(return_value=Mock(return_value='testuser'))
+    )
     def test_multiple_selection(self):
         """The pattern_options key maximumSelectionSize shouldn't be
         set when the field allows multiple selections"""


