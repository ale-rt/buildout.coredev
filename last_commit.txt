Repository: plone.formwidget.recurrence


Branch: refs/heads/master
Date: 2016-07-05T23:16:29+02:00
Author: Gil Forcada (gforcada) <gforcada@gnome.org>
Commit: https://github.com/plone/plone.formwidget.recurrence/commit/b5892789d973e367142c3857f4728e55b4446b8d

Use zope.interface decorator

This not only makes code more pleasent to read,
but also makes the code python 3 compatible
(while maintaining python 2 compatibility).

Files changed:
M CHANGES.rst
M plone/formwidget/recurrence/at/widget.py
M plone/formwidget/recurrence/tests/test_z3cwidget.py
M plone/formwidget/recurrence/z3cform/field.py
M plone/formwidget/recurrence/z3cform/widget.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 93058b6..6e6d33f 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Use zope.interface decorator.
+  [gforcada]
 
 
 2.1.0 (2016-05-09)
diff --git a/plone/formwidget/recurrence/at/widget.py b/plone/formwidget/recurrence/at/widget.py
index 69afc9f..cbd902c 100644
--- a/plone/formwidget/recurrence/at/widget.py
+++ b/plone/formwidget/recurrence/at/widget.py
@@ -7,7 +7,7 @@
 from Products.validation.interfaces.IValidator import IValidator
 from dateutil import rrule
 from zope.component.hooks import getSite
-from zope.interface import implements
+from zope.interface import implementer
 from plone.formwidget.recurrence.browser.i18n import translations
 
 import json
@@ -62,9 +62,8 @@ def get_pattern_options(self):
                used_for=('plone.app.event.recurrence.RecurrenceField',))
 
 
+@implementer(IValidator)
 class RecurrenceValidator(object):
-    # TODO: tests
-    implements(IValidator)
 
     def __init__(self, name):
         self.name = name
diff --git a/plone/formwidget/recurrence/tests/test_z3cwidget.py b/plone/formwidget/recurrence/tests/test_z3cwidget.py
index f2fe28a..36d7b7c 100644
--- a/plone/formwidget/recurrence/tests/test_z3cwidget.py
+++ b/plone/formwidget/recurrence/tests/test_z3cwidget.py
@@ -15,8 +15,8 @@ class ITestForm(zope.interface.Interface):
     day = zope.schema.Date(title=u'Day', required=True)
 
 
+@zope.interface.implementer(ITestForm)
 class TestForm(SimpleItem):
-    zope.interface.implements(ITestForm)
     recurrence = FieldProperty(ITestForm['recurrence'])
     day = FieldProperty(ITestForm['day'])
 
diff --git a/plone/formwidget/recurrence/z3cform/field.py b/plone/formwidget/recurrence/z3cform/field.py
index 743204e..93529b0 100644
--- a/plone/formwidget/recurrence/z3cform/field.py
+++ b/plone/formwidget/recurrence/z3cform/field.py
@@ -1,7 +1,8 @@
 from zope import schema
-from zope.interface import implements
+from zope.interface import implementer
 from plone.formwidget.recurrence.z3cform.interfaces import IRecurrenceField
 
 
+@implementer(IRecurrenceField)
 class RecurrenceField(schema.Text):
-    implements(IRecurrenceField)
+    pass
diff --git a/plone/formwidget/recurrence/z3cform/widget.py b/plone/formwidget/recurrence/z3cform/widget.py
index 85b46d5..13957a1 100644
--- a/plone/formwidget/recurrence/z3cform/widget.py
+++ b/plone/formwidget/recurrence/z3cform/widget.py
@@ -8,15 +8,15 @@
 from z3c.form.widget import FieldWidget
 from zope.component import adapter
 from zope.component.hooks import getSite
-from zope.interface import implementsOnly, implementer
+from zope.interface import implementer_only, implementer
 from zope.traversing.browser import absoluteURL
 
 import json
 
 
+@implementer_only(IRecurrenceWidget)
 class RecurrenceWidget(TextAreaWidget):
     """Recurrence widget implementation."""
-    implementsOnly(IRecurrenceWidget)
 
     klass = u'recurrence-widget'
     value = u''


Repository: plone.formwidget.recurrence


Branch: refs/heads/master
Date: 2016-07-07T00:58:17+02:00
Author: Gil Forcada Codinachs (gforcada) <gil.gnome@gmail.com>
Commit: https://github.com/plone/plone.formwidget.recurrence/commit/93a5f1c83eae2c7d394640c56517752aa8a833db

Merge pull request #20 from plone/gforcada-use-zope-decorators

Use zope.interface decorator

Files changed:
M CHANGES.rst
M plone/formwidget/recurrence/at/widget.py
M plone/formwidget/recurrence/tests/test_z3cwidget.py
M plone/formwidget/recurrence/z3cform/field.py
M plone/formwidget/recurrence/z3cform/widget.py

diff --git a/CHANGES.rst b/CHANGES.rst
index 93058b6..6e6d33f 100644
--- a/CHANGES.rst
+++ b/CHANGES.rst
@@ -14,7 +14,8 @@ New features:
 
 Bug fixes:
 
-- *add item here*
+- Use zope.interface decorator.
+  [gforcada]
 
 
 2.1.0 (2016-05-09)
diff --git a/plone/formwidget/recurrence/at/widget.py b/plone/formwidget/recurrence/at/widget.py
index 69afc9f..cbd902c 100644
--- a/plone/formwidget/recurrence/at/widget.py
+++ b/plone/formwidget/recurrence/at/widget.py
@@ -7,7 +7,7 @@
 from Products.validation.interfaces.IValidator import IValidator
 from dateutil import rrule
 from zope.component.hooks import getSite
-from zope.interface import implements
+from zope.interface import implementer
 from plone.formwidget.recurrence.browser.i18n import translations
 
 import json
@@ -62,9 +62,8 @@ def get_pattern_options(self):
                used_for=('plone.app.event.recurrence.RecurrenceField',))
 
 
+@implementer(IValidator)
 class RecurrenceValidator(object):
-    # TODO: tests
-    implements(IValidator)
 
     def __init__(self, name):
         self.name = name
diff --git a/plone/formwidget/recurrence/tests/test_z3cwidget.py b/plone/formwidget/recurrence/tests/test_z3cwidget.py
index f2fe28a..36d7b7c 100644
--- a/plone/formwidget/recurrence/tests/test_z3cwidget.py
+++ b/plone/formwidget/recurrence/tests/test_z3cwidget.py
@@ -15,8 +15,8 @@ class ITestForm(zope.interface.Interface):
     day = zope.schema.Date(title=u'Day', required=True)
 
 
+@zope.interface.implementer(ITestForm)
 class TestForm(SimpleItem):
-    zope.interface.implements(ITestForm)
     recurrence = FieldProperty(ITestForm['recurrence'])
     day = FieldProperty(ITestForm['day'])
 
diff --git a/plone/formwidget/recurrence/z3cform/field.py b/plone/formwidget/recurrence/z3cform/field.py
index 743204e..93529b0 100644
--- a/plone/formwidget/recurrence/z3cform/field.py
+++ b/plone/formwidget/recurrence/z3cform/field.py
@@ -1,7 +1,8 @@
 from zope import schema
-from zope.interface import implements
+from zope.interface import implementer
 from plone.formwidget.recurrence.z3cform.interfaces import IRecurrenceField
 
 
+@implementer(IRecurrenceField)
 class RecurrenceField(schema.Text):
-    implements(IRecurrenceField)
+    pass
diff --git a/plone/formwidget/recurrence/z3cform/widget.py b/plone/formwidget/recurrence/z3cform/widget.py
index 85b46d5..13957a1 100644
--- a/plone/formwidget/recurrence/z3cform/widget.py
+++ b/plone/formwidget/recurrence/z3cform/widget.py
@@ -8,15 +8,15 @@
 from z3c.form.widget import FieldWidget
 from zope.component import adapter
 from zope.component.hooks import getSite
-from zope.interface import implementsOnly, implementer
+from zope.interface import implementer_only, implementer
 from zope.traversing.browser import absoluteURL
 
 import json
 
 
+@implementer_only(IRecurrenceWidget)
 class RecurrenceWidget(TextAreaWidget):
     """Recurrence widget implementation."""
-    implementsOnly(IRecurrenceWidget)
 
     klass = u'recurrence-widget'
     value = u''


